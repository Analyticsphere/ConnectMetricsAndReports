
/* --------------------------------------------------------------------
   Code generated by a SAS task
   
   Generated on Monday, September 19, 2022 at 1:06:37 PM
   By task:     Import Data Wizard
   
   Source file: C:\Users
   atarajanm2\OneDrive - National Institutes of Health\desktop\BQ
   Testing\recruitment_prod_091922_JW.xlsx
   Server:      Local File System
   
   Output data: WORK.recruitment_prod_091922_JW
   Server:      Local
   -------------------------------------------------------------------- */

/* --------------------------------------------------------------------
   This DATA step reads the data values from a temporary text file
   created by the Import Data wizard. The values within the temporary
   text file were extracted from the Excel source file.
   -------------------------------------------------------------------- */

DATA WORK.recruitment_prod_091922_JW;
    LENGTH
        token            $ 36
        Connect_ID         8
        d_104278817      $ 1
        d_113579866      $ 1
        d_117249500        8
        d_119449326      $ 1
        d_119643471        8
        d_121430614        8
        d_123868967      $ 1
        d_130371375_d_266600170_d_222373   8
        d_130371375_d_266600170_d_297462   8
        d_130371375_d_266600170_d_320023 $ 9
        d_130371375_d_266600170_d_438636   8
        d_130371375_d_266600170_d_648228   8
        d_130371375_d_266600170_d_648936   8
        d_130371375_d_266600170_d_731498   8
        d_130371375_d_266600170_d_787567   8
        d_130371375_d_266600170_d_945795 $ 20
        d_130371375_d_303552867_d_222373   8
        d_130371375_d_303552867_d_297462 $ 1
        d_130371375_d_303552867_d_320023 $ 1
        d_130371375_d_303552867_d_438636 $ 1
        d_130371375_d_303552867_d_648228   8
        d_130371375_d_303552867_d_648936   8
        d_130371375_d_303552867_d_731498   8
        d_130371375_d_496823485_d_222373   8
        d_130371375_d_496823485_d_297462 $ 1
        d_130371375_d_496823485_d_320023 $ 1
        d_130371375_d_496823485_d_438636 $ 1
        d_130371375_d_496823485_d_648228   8
        d_130371375_d_496823485_d_648936   8
        d_130371375_d_496823485_d_731498   8
        d_130371375_d_650465111_d_222373   8
        d_130371375_d_650465111_d_297462 $ 1
        d_130371375_d_650465111_d_320023 $ 1
        d_130371375_d_650465111_d_438636 $ 1
        d_130371375_d_650465111_d_648228   8
        d_130371375_d_650465111_d_648936   8
        d_130371375_d_650465111_d_731498   8
        d_131458944        8
        d_141450621        8
        d_142654897_d_177402915   8
        d_142654897_d_196856782   8
        d_142654897_d_206879104   8
        d_142654897_d_241590841   8
        d_142654897_d_285130077   8
        d_142654897_d_326825649   8
        d_142654897_d_461488577   8
        d_142654897_d_462314689   8
        d_142654897_d_520301146   8
        d_142654897_d_549687190   8
        d_142654897_d_607081902   8
        d_142654897_d_639721694   8
        d_142654897_d_642287621   8
        d_142654897_d_684726272   8
        d_142654897_d_791389099   8
        d_142654897_d_819377306   8
        d_142654897_d_829269606   8
        d_142654897_d_942255248   8
        d_142654897_d_967372009   8
        d_147176963        8
        d_148197146        8
        d_150818546        8
        d_153211406      $ 25
        d_153713899        8
        d_158291096        8
        d_161366008      $ 1
        d_167958071        8
        d_173836415      $ 312
        d_173836415_d_266600170_d_448660   8
        d_173836415_d_266600170_d_561681   8
        d_173836415_d_266600170_d_592099   8
        d_173836415_d_266600170_d_718172   8
        d_173836415_d_266600170_d_847159   8
        d_173836415_d_266600170_d_915179   8
        d_175506524      $ 1
        d_175506524_d_175506524 $ 1
        d_175506524_d_905787778 $ 1
        d_175732191        8
        d_187894482        8
        d_188797763        8
        d_205553981        8
        d_222161762        8
        d_230663853        8
        d_231676651      $ 16
        d_262357957      $ 1
        d_262613359        8
        d_264644252        8
        d_265193023        8
        d_266600170      $ 1
        d_266952173      $ 49
        d_268665918      $ 1
        d_269050420        8
        d_271757434        8
        d_285488731        8
        d_297147359      $ 1
        d_297147359_d_297147359 $ 1
        d_297147359_d_366295286 $ 1
        d_299274441      $ 83
        d_299274441_d_299274441   8
        d_299274441_d_457532784 $ 1
        d_303552867      $ 1
        d_304438543      $ 1
        d_311580100        8
        d_331584571      $ 231
        d_331584571_d_266600170_d_135591   8
        d_331584571_d_266600170_d_343048   8
        d_331584571_d_266600170_d_840048   8
        d_335767902        8
        d_352891568        8
        d_359404406        8
        d_366295286      $ 1
        d_367051943      $ 1
        d_372303208        8
        d_379080287      $ 9
        d_386488297        8
        d_390198398      $ 1
        d_399159511      $ 20
        d_404289911        8
        d_407743866      $ 21
        d_412000022      $ 21
        d_430551721        8
        d_431428747        8
        d_435027713        8
        d_436680969      $ 20
        d_438643922      $ 12
        d_444699761        8
        d_452166062        8
        d_452942800        8
        d_454205108      $ 23
        d_454445267        8
        d_471593703        8
        d_477091792        8
        d_480305327      $ 1
        d_481139103        8
        d_494982282      $ 278
        d_496823485      $ 1
        d_497530905      $ 1
        d_506826178        8
        d_512820379        8
        d_517311251        8
        d_521025370        8
        d_521824358      $ 50
        d_523768810        8
        d_524352591_d_524352591   8
        d_524352591_d_902332801 $ 1
        d_524461170      $ 1
        d_536735468        8
        d_538553381        8
        d_538619788        8
        d_541836531        8
        d_547895941        8
        d_557461333        8
        d_558435199        8
        d_566047367      $ 1
        d_570452130        8
        d_576083042        8
        d_577794331        8
        d_592227431      $ 1
        d_596510649        8
        d_603278289      $ 1
        d_603278289_d_603278289 $ 1
        d_603278289_d_821930940 $ 1
        d_613641698        8
        d_614264509      $ 1
        d_620696506        8
        d_624030581        8
        d_629484663        8
        d_634434746      $ 14
        d_639172801        8
        d_646873644        8
        d_650465111      $ 1
        d_650597106        8
        d_657475009      $ 1
        d_659990606        8
        d_663265240        8
        d_664453818      $ 1
        d_667474224        8
        d_672401635      $ 1
        d_679832994        8
        d_684635302        8
        d_684926335        8
        d_685002411_d_194410742   8
        d_685002411_d_217367618   8
        d_685002411_d_277479354   8
        d_685002411_d_352996056   8
        d_685002411_d_867203506   8
        d_685002411_d_949501163   8
        d_685002411_d_994064239   8
        d_693626233      $ 1
        d_699625233        8
        d_703385619        8
        d_706256705        8
        d_706283025_d_163284008 $ 1
        d_706283025_d_163534562   8
        d_706283025_d_196038514   8
        d_706283025_d_208102461   8
        d_706283025_d_209509101   8
        d_706283025_d_211023960   8
        d_706283025_d_260703126   8
        d_706283025_d_331787113   8
        d_706283025_d_347614743   8
        d_706283025_d_363026564   8
        d_706283025_d_377633816   8
        d_706283025_d_381509125   8
        d_706283025_d_387198193 $ 1
        d_706283025_d_400259098   8
        d_706283025_d_405352246   8
        d_706283025_d_415693436 $ 180
        d_706283025_d_491099823 $ 1
        d_706283025_d_496935183   8
        d_706283025_d_497530905 $ 1
        d_706283025_d_517101990   8
        d_706283025_d_535928798   8
        d_706283025_d_566047367 $ 1
        d_706283025_d_579618065   8
        d_706283025_d_627995442   8
        d_706283025_d_702433259   8
        d_706283025_d_705732561   8
        d_706283025_d_719451909   8
        d_706283025_d_744197145   8
        d_706283025_d_755545718   8
        d_706283025_d_771146804 $ 1
        d_706283025_d_831137710   8
        d_706283025_d_836460125   8
        d_706283025_d_873405723 $ 1
        d_706283025_d_897366187   8
        d_706283025_d_950040334   8
        d_711256590      $ 1
        d_711794630        8
        d_714419972      $ 21
        d_715390138      $ 59
        d_719222792      $ 1
        d_719222792_d_719222792 $ 1
        d_719222792_d_993855378 $ 1
        d_725929722        8
        d_726389747      $ 1
        d_734828170        8
        d_744604255      $ 1
        d_747006172        8
        d_749475364      $ 13
        d_756862764      $ 1
        d_764403541      $ 1
        d_770257102        8
        d_773707518        8
        d_777719027        8
        d_793822265        8
        d_808663245      $ 1
        d_821247024        8
        d_822499427        8
        d_827220437        8
        d_828729648        8
        d_831041022        8
        d_832139544        8
        d_849518448        8
        d_866089092        8
        d_873405723      $ 1
        d_875010152        8
        d_875549268        8
        d_878865966        8
        d_883668444      $ 1
        d_906417725        8
        d_914594314        8
        d_914639140        8
        d_919254129        8
        d_919699172        8
        d_934298480        8
        d_948195369        8
        d_949302066        8
        d_953614051        8
        d_958588520        8
        d_974100830      $ 1
        d_976570371        8
        d_982105411        8
        d_982402227        8
        d_983278853        8
        d_987563196        8
        d_990579614        8
        d_995036844      $ 8
        d_996038075      $ 19
        pin              $ 9
        studyId          $ 16
        token_1          $ 36
        date               8 
		d_388711124 8 d_471168198 8 d_736251808 8 d_793072415 8
       d_869588347 8;
    LABEL
        d_130371375_d_266600170_d_222373 = "d_130371375_d_266600170_d_222373868"
        d_130371375_d_266600170_d_297462 = "d_130371375_d_266600170_d_297462035"
        d_130371375_d_266600170_d_320023 = "d_130371375_d_266600170_d_320023644"
        d_130371375_d_266600170_d_438636 = "d_130371375_d_266600170_d_438636757"
        d_130371375_d_266600170_d_648228 = "d_130371375_d_266600170_d_648228701"
        d_130371375_d_266600170_d_648936 = "d_130371375_d_266600170_d_648936790"
        d_130371375_d_266600170_d_731498 = "d_130371375_d_266600170_d_731498909"
        d_130371375_d_266600170_d_787567 = "d_130371375_d_266600170_d_787567527"
        d_130371375_d_266600170_d_945795 = "d_130371375_d_266600170_d_945795905"
        d_130371375_d_303552867_d_222373 = "d_130371375_d_303552867_d_222373868"
        d_130371375_d_303552867_d_297462 = "d_130371375_d_303552867_d_297462035"
        d_130371375_d_303552867_d_320023 = "d_130371375_d_303552867_d_320023644"
        d_130371375_d_303552867_d_438636 = "d_130371375_d_303552867_d_438636757"
        d_130371375_d_303552867_d_648228 = "d_130371375_d_303552867_d_648228701"
        d_130371375_d_303552867_d_648936 = "d_130371375_d_303552867_d_648936790"
        d_130371375_d_303552867_d_731498 = "d_130371375_d_303552867_d_731498909"
        d_130371375_d_496823485_d_222373 = "d_130371375_d_496823485_d_222373868"
        d_130371375_d_496823485_d_297462 = "d_130371375_d_496823485_d_297462035"
        d_130371375_d_496823485_d_320023 = "d_130371375_d_496823485_d_320023644"
        d_130371375_d_496823485_d_438636 = "d_130371375_d_496823485_d_438636757"
        d_130371375_d_496823485_d_648228 = "d_130371375_d_496823485_d_648228701"
        d_130371375_d_496823485_d_648936 = "d_130371375_d_496823485_d_648936790"
        d_130371375_d_496823485_d_731498 = "d_130371375_d_496823485_d_731498909"
        d_130371375_d_650465111_d_222373 = "d_130371375_d_650465111_d_222373868"
        d_130371375_d_650465111_d_297462 = "d_130371375_d_650465111_d_297462035"
        d_130371375_d_650465111_d_320023 = "d_130371375_d_650465111_d_320023644"
        d_130371375_d_650465111_d_438636 = "d_130371375_d_650465111_d_438636757"
        d_130371375_d_650465111_d_648228 = "d_130371375_d_650465111_d_648228701"
        d_130371375_d_650465111_d_648936 = "d_130371375_d_650465111_d_648936790"
        d_130371375_d_650465111_d_731498 = "d_130371375_d_650465111_d_731498909"
        d_173836415_d_266600170_d_448660 = "d_173836415_d_266600170_d_448660695"
        d_173836415_d_266600170_d_561681 = "d_173836415_d_266600170_d_561681068"
        d_173836415_d_266600170_d_592099 = "d_173836415_d_266600170_d_592099155"
        d_173836415_d_266600170_d_718172 = "d_173836415_d_266600170_d_718172863"
        d_173836415_d_266600170_d_847159 = "d_173836415_d_266600170_d_847159717"
        d_173836415_d_266600170_d_915179 = "d_173836415_d_266600170_d_915179629"
        d_331584571_d_266600170_d_135591 = "d_331584571_d_266600170_d_135591601"
        d_331584571_d_266600170_d_343048 = "d_331584571_d_266600170_d_343048998"
        d_331584571_d_266600170_d_840048 = "d_331584571_d_266600170_d_840048338" ;
    FORMAT
        token            $CHAR36.
        Connect_ID       BEST12.
        d_104278817      $CHAR1.
        d_113579866      $CHAR1.
        d_117249500      BEST12.
        d_119449326      $CHAR1.
        d_119643471      BEST12.
        d_121430614      BEST12.
        d_123868967      $CHAR1.
        d_130371375_d_266600170_d_222373 BEST12.
        d_130371375_d_266600170_d_297462 DATETIME21.2
        d_130371375_d_266600170_d_320023 $CHAR9.
        d_130371375_d_266600170_d_438636 DATETIME21.2
        d_130371375_d_266600170_d_648228 BEST12.
        d_130371375_d_266600170_d_648936 BEST12.
        d_130371375_d_266600170_d_731498 BEST12.
        d_130371375_d_266600170_d_787567 DATETIME21.2
        d_130371375_d_266600170_d_945795 $CHAR20.
        d_130371375_d_303552867_d_222373 BEST12.
        d_130371375_d_303552867_d_297462 $CHAR1.
        d_130371375_d_303552867_d_320023 $CHAR1.
        d_130371375_d_303552867_d_438636 $CHAR1.
        d_130371375_d_303552867_d_648228 BEST12.
        d_130371375_d_303552867_d_648936 BEST12.
        d_130371375_d_303552867_d_731498 BEST12.
        d_130371375_d_496823485_d_222373 BEST12.
        d_130371375_d_496823485_d_297462 $CHAR1.
        d_130371375_d_496823485_d_320023 $CHAR1.
        d_130371375_d_496823485_d_438636 $CHAR1.
        d_130371375_d_496823485_d_648228 BEST12.
        d_130371375_d_496823485_d_648936 BEST12.
        d_130371375_d_496823485_d_731498 BEST12.
        d_130371375_d_650465111_d_222373 BEST12.
        d_130371375_d_650465111_d_297462 $CHAR1.
        d_130371375_d_650465111_d_320023 $CHAR1.
        d_130371375_d_650465111_d_438636 $CHAR1.
        d_130371375_d_650465111_d_648228 BEST12.
        d_130371375_d_650465111_d_648936 BEST12.
        d_130371375_d_650465111_d_731498 BEST12.
        d_131458944      BEST12.
        d_141450621      BEST12.
        d_142654897_d_177402915 BEST12.
        d_142654897_d_196856782 BEST12.
        d_142654897_d_206879104 BEST12.
        d_142654897_d_241590841 BEST12.
        d_142654897_d_285130077 BEST12.
        d_142654897_d_326825649 BEST12.
        d_142654897_d_461488577 BEST12.
        d_142654897_d_462314689 BEST12.
        d_142654897_d_520301146 BEST12.
        d_142654897_d_549687190 BEST12.
        d_142654897_d_607081902 BEST12.
        d_142654897_d_639721694 BEST12.
        d_142654897_d_642287621 BEST12.
        d_142654897_d_684726272 BEST12.
        d_142654897_d_791389099 BEST12.
        d_142654897_d_819377306 BEST12.
        d_142654897_d_829269606 BEST12.
        d_142654897_d_942255248 BEST12.
        d_142654897_d_967372009 BEST12.
        d_147176963      BEST12.
        d_148197146      BEST12.
        d_150818546      BEST12.
        d_153211406      $CHAR25.
        d_153713899      BEST12.
        d_158291096      BEST12.
        d_161366008      $CHAR1.
        d_167958071      BEST12.
        d_173836415      $CHAR312.
        d_173836415_d_266600170_d_448660 DATETIME21.2
        d_173836415_d_266600170_d_561681 DATETIME21.2
        d_173836415_d_266600170_d_592099 BEST12.
        d_173836415_d_266600170_d_718172 BEST12.
        d_173836415_d_266600170_d_847159 DATETIME21.2
        d_173836415_d_266600170_d_915179 BEST12.
        d_175506524      $CHAR1.
        d_175506524_d_175506524 $CHAR1.
        d_175506524_d_905787778 $CHAR1.
        d_175732191      BEST12.
        d_187894482      BEST12.
        d_188797763      BEST12.
        d_205553981      DATETIME21.2
        d_222161762      DATETIME21.2
        d_230663853      BEST12.
        d_231676651      $CHAR16.
        d_262357957      $CHAR1.
        d_262613359      DATETIME21.2
        d_264644252      DATETIME21.2
        d_265193023      BEST12.
        d_266600170      $CHAR1.
        d_266952173      $CHAR49.
        d_268665918      $CHAR1.
        d_269050420      DATETIME21.2
        d_271757434      BEST12.
        d_285488731      BEST12.
        d_297147359      $CHAR1.
        d_297147359_d_297147359 $CHAR1.
        d_297147359_d_366295286 $CHAR1.
        d_299274441      $CHAR83.
        d_299274441_d_299274441 BEST12.
        d_299274441_d_457532784 $CHAR1.
        d_303552867      $CHAR1.
        d_304438543      $CHAR1.
        d_311580100      BEST12.
        d_331584571      $CHAR231.
        d_331584571_d_266600170_d_135591 BEST12.
        d_331584571_d_266600170_d_343048 DATETIME21.2
        d_331584571_d_266600170_d_840048 DATETIME21.2
        d_335767902      DATETIME21.2
        d_352891568      BEST12.
        d_359404406      BEST12.
        d_366295286      $CHAR1.
        d_367051943      $CHAR1.
        d_372303208      BEST12.
        d_379080287      $CHAR9.
        d_386488297      DATETIME21.2
        d_390198398      $CHAR1.
        d_399159511      $CHAR20.
        d_404289911      BEST12.
        d_407743866      $CHAR21.
        d_412000022      $CHAR21.
        d_430551721      DATETIME21.2
        d_431428747      BEST12.
        d_435027713      BEST12.
        d_436680969      $CHAR20.
        d_438643922      $CHAR12.
        d_444699761      BEST12.
        d_452166062      BEST12.
        d_452942800      DATETIME21.2
        d_454205108      $CHAR23.
        d_454445267      DATETIME21.2
        d_471593703      DATETIME21.2
        d_477091792      BEST12.
        d_480305327      $CHAR1.
        d_481139103      BEST12.
        d_494982282      $CHAR278.
        d_496823485      $CHAR1.
        d_497530905      $CHAR1.
        d_506826178      BEST12.
        d_512820379      BEST12.
        d_517311251      DATETIME21.2
        d_521025370      DATETIME21.2
        d_521824358      $CHAR50.
        d_523768810      BEST12.
        d_524352591_d_524352591 BEST12.
        d_524352591_d_902332801 $CHAR1.
        d_524461170      $CHAR1.
        d_536735468      BEST12.
        d_538553381      BEST12.
        d_538619788      BEST12.
        d_541836531      DATETIME21.2
        d_547895941      BEST12.
        d_557461333      BEST12.
        d_558435199      BEST12.
        d_566047367      $CHAR1.
        d_570452130      BEST12.
        d_576083042      BEST12.
        d_577794331      BEST12.
        d_592227431      $CHAR1.
        d_596510649      BEST12.
        d_603278289      $CHAR1.
        d_603278289_d_603278289 $CHAR1.
        d_603278289_d_821930940 $CHAR1.
        d_613641698      DATETIME21.2
        d_614264509      $CHAR1.
        d_620696506      BEST12.
        d_624030581      BEST12.
        d_629484663      BEST12.
        d_634434746      $CHAR14.
        d_639172801      BEST12.
        d_646873644      BEST12.
        d_650465111      $CHAR1.
        d_650597106      BEST12.
        d_657475009      $CHAR1.
        d_659990606      DATETIME21.2
        d_663265240      BEST12.
        d_664453818      $CHAR1.
        d_667474224      BEST12.
        d_672401635      $CHAR1.
        d_679832994      BEST12.
        d_684635302      BEST12.
        d_684926335      BEST12.
        d_685002411_d_194410742 BEST12.
        d_685002411_d_217367618 BEST12.
        d_685002411_d_277479354 BEST12.
        d_685002411_d_352996056 BEST12.
        d_685002411_d_867203506 BEST12.
        d_685002411_d_949501163 BEST12.
        d_685002411_d_994064239 BEST12.
        d_693626233      $CHAR1.
        d_699625233      BEST12.
        d_703385619      DATETIME21.2
        d_706256705      BEST12.
        d_706283025_d_163284008 $CHAR1.
        d_706283025_d_163534562 BEST12.
        d_706283025_d_196038514 BEST12.
        d_706283025_d_208102461 BEST12.
        d_706283025_d_209509101 BEST12.
        d_706283025_d_211023960 BEST12.
        d_706283025_d_260703126 BEST12.
        d_706283025_d_331787113 BEST12.
        d_706283025_d_347614743 BEST12.
        d_706283025_d_363026564 BEST12.
        d_706283025_d_377633816 BEST12.
        d_706283025_d_381509125 BEST12.
        d_706283025_d_387198193 $CHAR1.
        d_706283025_d_400259098 BEST12.
        d_706283025_d_405352246 BEST12.
        d_706283025_d_415693436 $CHAR180.
        d_706283025_d_491099823 $CHAR1.
        d_706283025_d_496935183 BEST12.
        d_706283025_d_497530905 $CHAR1.
        d_706283025_d_517101990 BEST12.
        d_706283025_d_535928798 BEST12.
        d_706283025_d_566047367 $CHAR1.
        d_706283025_d_579618065 BEST12.
        d_706283025_d_627995442 BEST12.
        d_706283025_d_702433259 BEST12.
        d_706283025_d_705732561 BEST12.
        d_706283025_d_719451909 BEST12.
        d_706283025_d_744197145 BEST12.
        d_706283025_d_755545718 BEST12.
        d_706283025_d_771146804 $CHAR1.
        d_706283025_d_831137710 BEST12.
        d_706283025_d_836460125 BEST12.
        d_706283025_d_873405723 $CHAR1.
        d_706283025_d_897366187 BEST12.
        d_706283025_d_950040334 BEST12.
        d_711256590      $CHAR1.
        d_711794630      BEST12.
        d_714419972      $CHAR21.
        d_715390138      $CHAR59.
        d_719222792      $CHAR1.
        d_719222792_d_719222792 $CHAR1.
        d_719222792_d_993855378 $CHAR1.
        d_725929722      BEST12.
        d_726389747      $CHAR1.
        d_734828170      BEST12.
        d_744604255      $CHAR1.
        d_747006172      BEST12.
        d_749475364      $CHAR13.
        d_756862764      $CHAR1.
        d_764403541      $CHAR1.
        d_770257102      DATETIME21.2
        d_773707518      BEST12.
        d_777719027      BEST12.
        d_793822265      BEST12.
        d_808663245      $CHAR1.
        d_821247024      BEST12.
        d_822499427      DATETIME21.2
        d_827220437      BEST12.
        d_828729648      BEST12.
        d_831041022      BEST12.
        d_832139544      DATETIME21.2
        d_849518448      BEST12.
        d_866089092      BEST12.
        d_873405723      $CHAR1.
        d_875010152      BEST12.
        d_875549268      BEST12.
        d_878865966      BEST12.
        d_883668444      $CHAR1.
        d_906417725      BEST12.
        d_914594314      DATETIME21.2
        d_914639140      BEST12.
        d_919254129      BEST12.
        d_919699172      BEST12.
        d_934298480      BEST12.
        d_948195369      BEST12.
        d_949302066      BEST12.
        d_953614051      BEST12.
        d_958588520      BEST12.
        d_974100830      $CHAR1.
        d_976570371      BEST12.
        d_982105411      DATETIME21.2
        d_982402227      BEST12.
        d_983278853      BEST12.
        d_987563196      BEST12.
        d_990579614      BEST12.
        d_995036844      $CHAR8.
        d_996038075      $CHAR19.
        pin              $CHAR9.
        studyId          $CHAR16.
        token_1          $CHAR36.
        date             BEST12. ;
    INFORMAT
        token            $CHAR36.
        Connect_ID       BEST12.
        d_104278817      $CHAR1.
        d_113579866      $CHAR1.
        d_117249500      BEST12.
        d_119449326      $CHAR1.
        d_119643471      BEST12.
        d_121430614      BEST12.
        d_123868967      $CHAR1.
        d_130371375_d_266600170_d_222373 BEST12.
        d_130371375_d_266600170_d_297462 DATETIME21.
        d_130371375_d_266600170_d_320023 $CHAR9.
        d_130371375_d_266600170_d_438636 DATETIME21.
        d_130371375_d_266600170_d_648228 BEST12.
        d_130371375_d_266600170_d_648936 BEST12.
        d_130371375_d_266600170_d_731498 BEST12.
        d_130371375_d_266600170_d_787567 DATETIME21.
        d_130371375_d_266600170_d_945795 $CHAR20.
        d_130371375_d_303552867_d_222373 BEST12.
        d_130371375_d_303552867_d_297462 $CHAR1.
        d_130371375_d_303552867_d_320023 $CHAR1.
        d_130371375_d_303552867_d_438636 $CHAR1.
        d_130371375_d_303552867_d_648228 BEST12.
        d_130371375_d_303552867_d_648936 BEST12.
        d_130371375_d_303552867_d_731498 BEST12.
        d_130371375_d_496823485_d_222373 BEST12.
        d_130371375_d_496823485_d_297462 $CHAR1.
        d_130371375_d_496823485_d_320023 $CHAR1.
        d_130371375_d_496823485_d_438636 $CHAR1.
        d_130371375_d_496823485_d_648228 BEST12.
        d_130371375_d_496823485_d_648936 BEST12.
        d_130371375_d_496823485_d_731498 BEST12.
        d_130371375_d_650465111_d_222373 BEST12.
        d_130371375_d_650465111_d_297462 $CHAR1.
        d_130371375_d_650465111_d_320023 $CHAR1.
        d_130371375_d_650465111_d_438636 $CHAR1.
        d_130371375_d_650465111_d_648228 BEST12.
        d_130371375_d_650465111_d_648936 BEST12.
        d_130371375_d_650465111_d_731498 BEST12.
        d_131458944      BEST12.
        d_141450621      BEST12.
        d_142654897_d_177402915 BEST12.
        d_142654897_d_196856782 BEST12.
        d_142654897_d_206879104 BEST12.
        d_142654897_d_241590841 BEST12.
        d_142654897_d_285130077 BEST12.
        d_142654897_d_326825649 BEST12.
        d_142654897_d_461488577 BEST12.
        d_142654897_d_462314689 BEST12.
        d_142654897_d_520301146 BEST12.
        d_142654897_d_549687190 BEST12.
        d_142654897_d_607081902 BEST12.
        d_142654897_d_639721694 BEST12.
        d_142654897_d_642287621 BEST12.
        d_142654897_d_684726272 BEST12.
        d_142654897_d_791389099 BEST12.
        d_142654897_d_819377306 BEST12.
        d_142654897_d_829269606 BEST12.
        d_142654897_d_942255248 BEST12.
        d_142654897_d_967372009 BEST12.
        d_147176963      BEST12.
        d_148197146      BEST12.
        d_150818546      BEST12.
        d_153211406      $CHAR25.
        d_153713899      BEST12.
        d_158291096      BEST12.
        d_161366008      $CHAR1.
        d_167958071      BEST12.
        d_173836415      $CHAR312.
        d_173836415_d_266600170_d_448660 DATETIME21.
        d_173836415_d_266600170_d_561681 DATETIME21.
        d_173836415_d_266600170_d_592099 BEST12.
        d_173836415_d_266600170_d_718172 BEST12.
        d_173836415_d_266600170_d_847159 DATETIME21.
        d_173836415_d_266600170_d_915179 BEST12.
        d_175506524      $CHAR1.
        d_175506524_d_175506524 $CHAR1.
        d_175506524_d_905787778 $CHAR1.
        d_175732191      BEST12.
        d_187894482      BEST12.
        d_188797763      BEST12.
        d_205553981      DATETIME21.
        d_222161762      DATETIME21.
        d_230663853      BEST12.
        d_231676651      $CHAR16.
        d_262357957      $CHAR1.
        d_262613359      DATETIME21.
        d_264644252      DATETIME21.
        d_265193023      BEST12.
        d_266600170      $CHAR1.
        d_266952173      $CHAR49.
        d_268665918      $CHAR1.
        d_269050420      DATETIME21.
        d_271757434      BEST12.
        d_285488731      BEST12.
        d_297147359      $CHAR1.
        d_297147359_d_297147359 $CHAR1.
        d_297147359_d_366295286 $CHAR1.
        d_299274441      $CHAR83.
        d_299274441_d_299274441 BEST12.
        d_299274441_d_457532784 $CHAR1.
        d_303552867      $CHAR1.
        d_304438543      $CHAR1.
        d_311580100      BEST12.
        d_331584571      $CHAR231.
        d_331584571_d_266600170_d_135591 BEST12.
        d_331584571_d_266600170_d_343048 DATETIME21.
        d_331584571_d_266600170_d_840048 DATETIME21.
        d_335767902      DATETIME21.
        d_352891568      BEST12.
        d_359404406      BEST12.
        d_366295286      $CHAR1.
        d_367051943      $CHAR1.
        d_372303208      BEST12.
        d_379080287      $CHAR9.
        d_386488297      DATETIME21.
        d_390198398      $CHAR1.
        d_399159511      $CHAR20.
        d_404289911      BEST12.
        d_407743866      $CHAR21.
        d_412000022      $CHAR21.
        d_430551721      DATETIME21.
        d_431428747      BEST12.
        d_435027713      BEST12.
        d_436680969      $CHAR20.
        d_438643922      $CHAR12.
        d_444699761      BEST12.
        d_452166062      BEST12.
        d_452942800      DATETIME21.
        d_454205108      $CHAR23.
        d_454445267      DATETIME21.
        d_471593703      DATETIME21.
        d_477091792      BEST12.
        d_480305327      $CHAR1.
        d_481139103      BEST12.
        d_494982282      $CHAR278.
        d_496823485      $CHAR1.
        d_497530905      $CHAR1.
        d_506826178      BEST12.
        d_512820379      BEST12.
        d_517311251      DATETIME21.
        d_521025370      DATETIME21.
        d_521824358      $CHAR50.
        d_523768810      BEST12.
        d_524352591_d_524352591 BEST12.
        d_524352591_d_902332801 $CHAR1.
        d_524461170      $CHAR1.
        d_536735468      BEST12.
        d_538553381      BEST12.
        d_538619788      BEST12.
        d_541836531      DATETIME21.
        d_547895941      BEST12.
        d_557461333      BEST12.
        d_558435199      BEST12.
        d_566047367      $CHAR1.
        d_570452130      BEST12.
        d_576083042      BEST12.
        d_577794331      BEST12.
        d_592227431      $CHAR1.
        d_596510649      BEST12.
        d_603278289      $CHAR1.
        d_603278289_d_603278289 $CHAR1.
        d_603278289_d_821930940 $CHAR1.
        d_613641698      DATETIME21.
        d_614264509      $CHAR1.
        d_620696506      BEST12.
        d_624030581      BEST12.
        d_629484663      BEST12.
        d_634434746      $CHAR14.
        d_639172801      BEST12.
        d_646873644      BEST12.
        d_650465111      $CHAR1.
        d_650597106      BEST12.
        d_657475009      $CHAR1.
        d_659990606      DATETIME21.
        d_663265240      BEST12.
        d_664453818      $CHAR1.
        d_667474224      BEST12.
        d_672401635      $CHAR1.
        d_679832994      BEST12.
        d_684635302      BEST12.
        d_684926335      BEST12.
        d_685002411_d_194410742 BEST12.
        d_685002411_d_217367618 BEST12.
        d_685002411_d_277479354 BEST12.
        d_685002411_d_352996056 BEST12.
        d_685002411_d_867203506 BEST12.
        d_685002411_d_949501163 BEST12.
        d_685002411_d_994064239 BEST12.
        d_693626233      $CHAR1.
        d_699625233      BEST12.
        d_703385619      DATETIME21.
        d_706256705      BEST12.
        d_706283025_d_163284008 $CHAR1.
        d_706283025_d_163534562 BEST12.
        d_706283025_d_196038514 BEST12.
        d_706283025_d_208102461 BEST12.
        d_706283025_d_209509101 BEST12.
        d_706283025_d_211023960 BEST12.
        d_706283025_d_260703126 BEST12.
        d_706283025_d_331787113 BEST12.
        d_706283025_d_347614743 BEST12.
        d_706283025_d_363026564 BEST12.
        d_706283025_d_377633816 BEST12.
        d_706283025_d_381509125 BEST12.
        d_706283025_d_387198193 $CHAR1.
        d_706283025_d_400259098 BEST12.
        d_706283025_d_405352246 BEST12.
        d_706283025_d_415693436 $CHAR180.
        d_706283025_d_491099823 $CHAR1.
        d_706283025_d_496935183 BEST12.
        d_706283025_d_497530905 $CHAR1.
        d_706283025_d_517101990 BEST12.
        d_706283025_d_535928798 BEST12.
        d_706283025_d_566047367 $CHAR1.
        d_706283025_d_579618065 BEST12.
        d_706283025_d_627995442 BEST12.
        d_706283025_d_702433259 BEST12.
        d_706283025_d_705732561 BEST12.
        d_706283025_d_719451909 BEST12.
        d_706283025_d_744197145 BEST12.
        d_706283025_d_755545718 BEST12.
        d_706283025_d_771146804 $CHAR1.
        d_706283025_d_831137710 BEST12.
        d_706283025_d_836460125 BEST12.
        d_706283025_d_873405723 $CHAR1.
        d_706283025_d_897366187 BEST12.
        d_706283025_d_950040334 BEST12.
        d_711256590      $CHAR1.
        d_711794630      BEST12.
        d_714419972      $CHAR21.
        d_715390138      $CHAR59.
        d_719222792      $CHAR1.
        d_719222792_d_719222792 $CHAR1.
        d_719222792_d_993855378 $CHAR1.
        d_725929722      BEST12.
        d_726389747      $CHAR1.
        d_734828170      BEST12.
        d_744604255      $CHAR1.
        d_747006172      BEST12.
        d_749475364      $CHAR13.
        d_756862764      $CHAR1.
        d_764403541      $CHAR1.
        d_770257102      DATETIME21.
        d_773707518      BEST12.
        d_777719027      BEST12.
        d_793822265      BEST12.
        d_808663245      $CHAR1.
        d_821247024      BEST12.
        d_822499427      DATETIME21.
        d_827220437      BEST12.
        d_828729648      BEST12.
        d_831041022      BEST12.
        d_832139544      DATETIME21.
        d_849518448      BEST12.
        d_866089092      BEST12.
        d_873405723      $CHAR1.
        d_875010152      BEST12.
        d_875549268      BEST12.
        d_878865966      BEST12.
        d_883668444      $CHAR1.
        d_906417725      BEST12.
        d_914594314      DATETIME21.
        d_914639140      BEST12.
        d_919254129      BEST12.
        d_919699172      BEST12.
        d_934298480      BEST12.
        d_948195369      BEST12.
        d_949302066      BEST12.
        d_953614051      BEST12.
        d_958588520      BEST12.
        d_974100830      $CHAR1.
        d_976570371      BEST12.
        d_982105411      DATETIME21.
        d_982402227      BEST12.
        d_983278853      BEST12.
        d_987563196      BEST12.
        d_990579614      BEST12.
        d_995036844      $CHAR8.
        d_996038075      $CHAR19.
        pin              $CHAR9.
        studyId          $CHAR16.
        token_1          $CHAR36.
        date             BEST12. ;
    INFILE 'C:\Users\natarajanm2\AppData\Local\Temp\1\SEG9084\recruitment_prod_091922_JW-47ce7826204547c684a975f7f557e95a.txt'
        LRECL=3146
        ENCODING="WLATIN1"
        TERMSTR=CRLF
        DLM='7F'x
        MISSOVER
        DSD ;
    INPUT
        token            : $CHAR36.
        Connect_ID       : BEST32.
        d_104278817      : $CHAR1.
        d_113579866      : $CHAR1.
        d_117249500      : BEST32.
        d_119449326      : $CHAR1.
        d_119643471      : BEST32.
        d_121430614      : BEST32.
        d_123868967      : $CHAR1.
        d_130371375_d_266600170_d_222373 : BEST32.
        d_130371375_d_266600170_d_297462 : ANYDTDTM24.
        d_130371375_d_266600170_d_320023 : $CHAR9.
        d_130371375_d_266600170_d_438636 : ANYDTDTM24.
        d_130371375_d_266600170_d_648228 : BEST32.
        d_130371375_d_266600170_d_648936 : BEST32.
        d_130371375_d_266600170_d_731498 : BEST32.
        d_130371375_d_266600170_d_787567 : ANYDTDTM24.
        d_130371375_d_266600170_d_945795 : $CHAR20.
        d_130371375_d_303552867_d_222373 : BEST32.
        d_130371375_d_303552867_d_297462 : $CHAR1.
        d_130371375_d_303552867_d_320023 : $CHAR1.
        d_130371375_d_303552867_d_438636 : $CHAR1.
        d_130371375_d_303552867_d_648228 : BEST32.
        d_130371375_d_303552867_d_648936 : BEST32.
        d_130371375_d_303552867_d_731498 : BEST32.
        d_130371375_d_496823485_d_222373 : BEST32.
        d_130371375_d_496823485_d_297462 : $CHAR1.
        d_130371375_d_496823485_d_320023 : $CHAR1.
        d_130371375_d_496823485_d_438636 : $CHAR1.
        d_130371375_d_496823485_d_648228 : BEST32.
        d_130371375_d_496823485_d_648936 : BEST32.
        d_130371375_d_496823485_d_731498 : BEST32.
        d_130371375_d_650465111_d_222373 : BEST32.
        d_130371375_d_650465111_d_297462 : $CHAR1.
        d_130371375_d_650465111_d_320023 : $CHAR1.
        d_130371375_d_650465111_d_438636 : $CHAR1.
        d_130371375_d_650465111_d_648228 : BEST32.
        d_130371375_d_650465111_d_648936 : BEST32.
        d_130371375_d_650465111_d_731498 : BEST32.
        d_131458944      : BEST32.
        d_141450621      : BEST32.
        d_142654897_d_177402915 : BEST32.
        d_142654897_d_196856782 : BEST32.
        d_142654897_d_206879104 : BEST32.
        d_142654897_d_241590841 : BEST32.
        d_142654897_d_285130077 : BEST32.
        d_142654897_d_326825649 : BEST32.
        d_142654897_d_461488577 : BEST32.
        d_142654897_d_462314689 : BEST32.
        d_142654897_d_520301146 : BEST32.
        d_142654897_d_549687190 : BEST32.
        d_142654897_d_607081902 : BEST32.
        d_142654897_d_639721694 : BEST32.
        d_142654897_d_642287621 : BEST32.
        d_142654897_d_684726272 : BEST32.
        d_142654897_d_791389099 : BEST32.
        d_142654897_d_819377306 : BEST32.
        d_142654897_d_829269606 : BEST32.
        d_142654897_d_942255248 : BEST32.
        d_142654897_d_967372009 : BEST32.
        d_147176963      : BEST32.
        d_148197146      : BEST32.
        d_150818546      : BEST32.
        d_153211406      : $CHAR25.
        d_153713899      : BEST32.
        d_158291096      : BEST32.
        d_161366008      : $CHAR1.
        d_167958071      : BEST32.
        d_173836415      : $CHAR312.
        d_173836415_d_266600170_d_448660 : ANYDTDTM24.
        d_173836415_d_266600170_d_561681 : ANYDTDTM24.
        d_173836415_d_266600170_d_592099 : BEST32.
        d_173836415_d_266600170_d_718172 : BEST32.
        d_173836415_d_266600170_d_847159 : ANYDTDTM24.
        d_173836415_d_266600170_d_915179 : BEST32.
        d_175506524      : $CHAR1.
        d_175506524_d_175506524 : $CHAR1.
        d_175506524_d_905787778 : $CHAR1.
        d_175732191      : BEST32.
        d_187894482      : BEST32.
        d_188797763      : BEST32.
        d_205553981      : ANYDTDTM24.
        d_222161762      : ANYDTDTM24.
        d_230663853      : BEST32.
        d_231676651      : $CHAR16.
        d_262357957      : $CHAR1.
        d_262613359      : ANYDTDTM24.
        d_264644252      : ANYDTDTM24.
        d_265193023      : BEST32.
        d_266600170      : $CHAR1.
        d_266952173      : $CHAR49.
        d_268665918      : $CHAR1.
        d_269050420      : ANYDTDTM24.
        d_271757434      : BEST32.
        d_285488731      : BEST32.
        d_297147359      : $CHAR1.
        d_297147359_d_297147359 : $CHAR1.
        d_297147359_d_366295286 : $CHAR1.
        d_299274441      : $CHAR83.
        d_299274441_d_299274441 : BEST32.
        d_299274441_d_457532784 : $CHAR1.
        d_303552867      : $CHAR1.
        d_304438543      : $CHAR1.
        d_311580100      : BEST32.
        d_331584571      : $CHAR231.
        d_331584571_d_266600170_d_135591 : BEST32.
        d_331584571_d_266600170_d_343048 : ANYDTDTM24.
        d_331584571_d_266600170_d_840048 : ANYDTDTM24.
        d_335767902      : ANYDTDTM24.
        d_352891568      : BEST32.
        d_359404406      : BEST32.
        d_366295286      : $CHAR1.
        d_367051943      : $CHAR1.
        d_372303208      : BEST32.
        d_379080287      : $CHAR9.
        d_386488297      : ANYDTDTM24.
        d_390198398      : $CHAR1.
        d_399159511      : $CHAR20.
        d_404289911      : BEST32.
        d_407743866      : $CHAR21.
        d_412000022      : $CHAR21.
        d_430551721      : ANYDTDTM24.
        d_431428747      : BEST32.
        d_435027713      : BEST32.
        d_436680969      : $CHAR20.
        d_438643922      : $CHAR12.
        d_444699761      : BEST32.
        d_452166062      : BEST32.
        d_452942800      : ANYDTDTM24.
        d_454205108      : $CHAR23.
        d_454445267      : ANYDTDTM24.
        d_471593703      : ANYDTDTM24.
        d_477091792      : BEST32.
        d_480305327      : $CHAR1.
        d_481139103      : BEST32.
        d_494982282      : $CHAR278.
        d_496823485      : $CHAR1.
        d_497530905      : $CHAR1.
        d_506826178      : BEST32.
        d_512820379      : BEST32.
        d_517311251      : ANYDTDTM24.
        d_521025370      : ANYDTDTM24.
        d_521824358      : $CHAR50.
        d_523768810      : BEST32.
        d_524352591_d_524352591 : BEST32.
        d_524352591_d_902332801 : $CHAR1.
        d_524461170      : $CHAR1.
        d_536735468      : BEST32.
        d_538553381      : BEST32.
        d_538619788      : BEST32.
        d_541836531      : ANYDTDTM24.
        d_547895941      : BEST32.
        d_557461333      : BEST32.
        d_558435199      : BEST32.
        d_566047367      : $CHAR1.
        d_570452130      : BEST32.
        d_576083042      : BEST32.
        d_577794331      : BEST32.
        d_592227431      : $CHAR1.
        d_596510649      : BEST32.
        d_603278289      : $CHAR1.
        d_603278289_d_603278289 : $CHAR1.
        d_603278289_d_821930940 : $CHAR1.
        d_613641698      : ANYDTDTM24.
        d_614264509      : $CHAR1.
        d_620696506      : BEST32.
        d_624030581      : BEST32.
        d_629484663      : BEST32.
        d_634434746      : $CHAR14.
        d_639172801      : BEST32.
        d_646873644      : BEST32.
        d_650465111      : $CHAR1.
        d_650597106      : BEST32.
        d_657475009      : $CHAR1.
        d_659990606      : ANYDTDTM24.
        d_663265240      : BEST32.
        d_664453818      : $CHAR1.
        d_667474224      : BEST32.
        d_672401635      : $CHAR1.
        d_679832994      : BEST32.
        d_684635302      : BEST32.
        d_684926335      : BEST32.
        d_685002411_d_194410742 : BEST32.
        d_685002411_d_217367618 : BEST32.
        d_685002411_d_277479354 : BEST32.
        d_685002411_d_352996056 : BEST32.
        d_685002411_d_867203506 : BEST32.
        d_685002411_d_949501163 : BEST32.
        d_685002411_d_994064239 : BEST32.
        d_693626233      : $CHAR1.
        d_699625233      : BEST32.
        d_703385619      : ANYDTDTM24.
        d_706256705      : BEST32.
        d_706283025_d_163284008 : $CHAR1.
        d_706283025_d_163534562 : BEST32.
        d_706283025_d_196038514 : BEST32.
        d_706283025_d_208102461 : BEST32.
        d_706283025_d_209509101 : BEST32.
        d_706283025_d_211023960 : BEST32.
        d_706283025_d_260703126 : BEST32.
        d_706283025_d_331787113 : BEST32.
        d_706283025_d_347614743 : BEST32.
        d_706283025_d_363026564 : BEST32.
        d_706283025_d_377633816 : BEST32.
        d_706283025_d_381509125 : BEST32.
        d_706283025_d_387198193 : $CHAR1.
        d_706283025_d_400259098 : BEST32.
        d_706283025_d_405352246 : BEST32.
        d_706283025_d_415693436 : $CHAR180.
        d_706283025_d_491099823 : $CHAR1.
        d_706283025_d_496935183 : BEST32.
        d_706283025_d_497530905 : $CHAR1.
        d_706283025_d_517101990 : BEST32.
        d_706283025_d_535928798 : BEST32.
        d_706283025_d_566047367 : $CHAR1.
        d_706283025_d_579618065 : BEST32.
        d_706283025_d_627995442 : BEST32.
        d_706283025_d_702433259 : BEST32.
        d_706283025_d_705732561 : BEST32.
        d_706283025_d_719451909 : BEST32.
        d_706283025_d_744197145 : BEST32.
        d_706283025_d_755545718 : BEST32.
        d_706283025_d_771146804 : $CHAR1.
        d_706283025_d_831137710 : BEST32.
        d_706283025_d_836460125 : BEST32.
        d_706283025_d_873405723 : $CHAR1.
        d_706283025_d_897366187 : BEST32.
        d_706283025_d_950040334 : BEST32.
        d_711256590      : $CHAR1.
        d_711794630      : BEST32.
        d_714419972      : $CHAR21.
        d_715390138      : $CHAR59.
        d_719222792      : $CHAR1.
        d_719222792_d_719222792 : $CHAR1.
        d_719222792_d_993855378 : $CHAR1.
        d_725929722      : BEST32.
        d_726389747      : $CHAR1.
        d_734828170      : BEST32.
        d_744604255      : $CHAR1.
        d_747006172      : BEST32.
        d_749475364      : $CHAR13.
        d_756862764      : $CHAR1.
        d_764403541      : $CHAR1.
        d_770257102      : ANYDTDTM24.
        d_773707518      : BEST32.
        d_777719027      : BEST32.
        d_793822265      : BEST32.
        d_808663245      : $CHAR1.
        d_821247024      : BEST32.
        d_822499427      : ANYDTDTM24.
        d_827220437      : BEST32.
        d_828729648      : BEST32.
        d_831041022      : BEST32.
        d_832139544      : ANYDTDTM24.
        d_849518448      : BEST32.
        d_866089092      : BEST32.
        d_873405723      : $CHAR1.
        d_875010152      : BEST32.
        d_875549268      : BEST32.
        d_878865966      : BEST32.
        d_883668444      : $CHAR1.
        d_906417725      : BEST32.
        d_914594314      : ANYDTDTM24.
        d_914639140      : BEST32.
        d_919254129      : BEST32.
        d_919699172      : BEST32.
        d_934298480      : BEST32.
        d_948195369      : BEST32.
        d_949302066      : BEST32.
        d_953614051      : BEST32.
        d_958588520      : BEST32.
        d_974100830      : $CHAR1.
        d_976570371      : BEST32.
        d_982105411      : ANYDTDTM24.
        d_982402227      : BEST32.
        d_983278853      : BEST32.
        d_987563196      : BEST32.
        d_990579614      : BEST32.
        d_995036844      : $CHAR8.
        d_996038075      : $CHAR19.
        pin              : $CHAR9.
        studyId          : $CHAR16.
        token_1          : $CHAR36.
        date             : BEST32. ;
RUN;

*Labeling Concept IDs;
PROC SQL;
CREATE TABLE Concept_IDs as
SELECT 
d_512820379 as 	RcrtSI_RecruitType_v1r0,
d_471593703 as 	RcrtSI_TypeTime_v1r0,
d_934298480	as 	RcrtSI_Age_v1r0,
d_119643471	as 	RcrtSI_SHRace_v1r0,	
d_538553381	as	RcrtSI_SHEthnicity_v1r0,
d_706256705	as	RcrtSI_Sex_v1r0,
d_749475364	as	RcrtSI_EligibilityVer_v1r0,
d_477091792	as	RcrtSI_MemberStat_v1r0,
d_667474224	as	RcrtSI_CampaignType_v1r0,
d_158291096	as	RcrtSI_OptOut_v1r0,
d_875549268	as	RcrtSI_MaxContcts_v1r0,
d_230663853	as	RcrtSI_SignedIn_v1r0,
d_828729648	as	RcrtES_noPIN_v1r0,
d_948195369	as	RcrtES_PINmatch_v1r0,
d_821247024 as  RcrtV_Verification_v1r0, 
d_827220437	as	RcrtES_Site_v1r0,
d_311580100 as SrvSS_SSN_Given_v1r0,
d_914639140 as SrvSS_SSN4d_Given_v1r0,
d_919254129	as	RcrtCS_Consented_v1r0,
d_995036844	as	RcrtPC_Acnt_SignIn_v1r0,
d_699625233	as	RcrtUP_Submitted_v1r0,	
d_914594314	as	RcrtV_VerificationTm_V1R0,
d_444699761	as	RcrtV_Automated_v1r0,
d_953614051	as	RcrtV_Mannual_v1r0,	
d_188797763 as  RcrtV_Outreach_v1r0,
d_147176963	as	RcrtV_FNameMatch_v1r0,	
d_557461333	as	RcrtV_LNameMatch_v1r0,	
d_725929722	as	RcrtV_DOBMatch_v1r0,
d_711794630	as	RcrtV_PINMatch_v1r0,			
d_570452130	as	RcrtV_SiteMatch_v1r0,	
d_629484663	as	RcrtV_AgeMatch_v1r0,
d_679832994 as  RcrtV_TokenMatch_v1r0,	
d_547895941	as	RcrtV_CStatusMatch_v1r0,
d_949302066 as 	SrvBOH_BaseStatus_v1r0,  
d_536735468 as  SrvMRE_BaseStatus_v1r0, 
d_976570371 as  SrvSAS_BaseStatus_v1r0, 
d_663265240 as  SrvLAW_BaseStatus_v1r0, 
/*d_130371375_d_266600170_d_731498	as	SMPaym_PaymElig_v1r0,*/
/*d_130371375_d_266600170_d_222373	as	SMPaym_NORCPaymElig_v1r0,*/
/*d_130371375_d_266600170_d_787567  as  SMPaym_TmPaymElig_v1r0,*/
/*d_130371375_d_266600170_d_648936	as	HDPaym_PaymIssued_v1r0,*/
/*d_130371375_d_266600170_d_648228	as	HDPaym_PaymRefused_v1r0,*/																						
d_521025370	as 	RcrtSI_TimeStamp_v1r0, 
/*d_685002411_d_994064239 as HdRef_Basesrv_v1r0,*/
/*d_685002411_d_194410742 as HdRef_Baseblood_v1r0,*/
/*d_685002411_d_949501163 as HdRef_Baseurine_v1r0,*/ 
/*d_685002411_d_277479354 as HdRef_Basesaliva_v1r0,*/ 
/*d_685002411_d_867203506 as HdRef_Allsrv_v1r0,*/ 
/*d_685002411_d_352996056 as HdRef_Allsample_v1r0,*/
/*d_685002411_d_217367618 as HdRef_BlSpecSrv_v1r0,*/
d_987563196 as HdWd_Deceased_v1r0, /* Participant Deceased*/
d_123868967 as HdWd_DeceasedDt_v1r0, /* Date Participant Deceased*/
/*d_764403541 as HdWd_SourceofReport_v1r0, /* Source of Deceased Report*/
d_747006172 as HdWd_WdConsent_v1r0, /* Withdraw consent*/
d_113579866 as HdWd_Suspend_v1r0, /* Suspend all contact on case until DATE: MM/DD/YYYY*/
d_153713899 as HdWd_HIPAArevokesign_v1r0, /* HIPAA revocation signed*/
d_359404406 as HdWd_Datadestroysign_v1r0, /* Data destruction request signed*/
/*d_851245875 as HdRef_Busy_v1r0, /* I am too busy/stressed to participate*/
d_919699172 as HdRef_NotInterested_v1r0, /* I am no longer interested in the study*/
d_141450621 as HdRef_TooMuchTime_v1r0, /* I am too busy/the study takes too much time*/
d_576083042 as HdRef_Payment_v1r0, /* I think the payment or benefit to participant is not great enough*/
d_431428747 as HdRef_Sick_v1r0, /* I am too sick/my health is too poor""to participate*/
d_121430614 as HdRef_NoInternet_v1r0, /* I do not have reliable access to the internet/a""device*/
d_523768810 as HdRef_WorriedResults_v1r0, /* I am worried about receiving results from the study*/
d_639172801 as HdRef_Worried_v1r0, /* I am worried the study might find something concerning about me*/
d_175732191 as HdRef_Privacy_v1r0, /* I am concerned about my privacy*/
/*d_637147033 as HdRef_PrivacyA_v1r0, /* I am concerned about providing information online*/
d_150818546 as HdRef_PrivacyB_v1r0, /* I do not trust the government*/
d_624030581 as HdRef_PrivacyC_v1r0, /* I do not trust research/researchers*/
d_285488731 as HdRef_PrivacyD_v1r0, /* I""do not""want my""information shared with other researchers*/
d_596510649 as HdRef_PrivacyE_v1r0, /* I am worried""my""information isn""t secure or there will be a data breach*/
d_866089092 as HdRef_PrivacyF_v1r0, /* I am worried about data being given to"my insurance company/effects on insurance (health, life, other)*/
d_990579614 as HdRef_PrivacyG_v1r0, /* I am worried about data being given to""my""employer/potential employer*/
d_131458944 as HdRef_PrivacyH_v1r0, /* I am worried that my""information could be used to discriminate against me/my""family*/
d_372303208 as HdRef_PrivacyI_v1r0, /* I am worried that my""information will be used by others to make a profit*/
d_777719027 as HdRef_PrivacyJ_v1r0, /* I have other privacy concerns*/
d_620696506 as HdRef_Online_v1r0, /* I am not able to complete the study activities online*/
d_352891568 as HdRef_DislikeOnline_v1r0, /* I do not like to do things online*/
d_958588520 as HdRef_COVID_v1r0, /* I am concerned about COVID-19*/
d_875010152 as HdRef_Unable_v1r0, /* Participant is now unable to participate*/
d_404289911 as HdRef_Incarcerated_v1r0, /* Participant is incarcerated*/
d_538619788 as HdRef_NotGiven_v1r0,  /* Reason not given*/
studyid as studyid, 
token as token,
Connect_ID as Connect_ID,
pin as pin, 
/*Variables I uncommented out on 8/26/21 in case errors come up*/
d_659990606 as HdWd_WdConsentDt_v1r0,/* Autoset when HdWd_WdConsent_v1r0 selected*/
d_664453818 as HdRef_DateHIPAArevoked_v1r0, /* Autoset when HdWd_HIPAA revoked_v1r0 selected*/
d_906417725 as HdWd_Activepart_v1r0, /* Refusing all future activities*/
d_831041022 as HdWd_Destroydata_v1r0, /* Destroy data*/
d_773707518 as HdWd_HIPAArevoked_v1r0, /* Revoke HIPAA*/
d_269050420 as HdRef_DateDatadestroy_v1r0, /* Autoset when  HdWd_Destroydata_v1r0 selected*/
d_335767902	as	RcrtSI_SignTime_v1r0,
d_454445267	as	RcrtCS_ConsentSumit_v1r0,
d_430551721	as	RcrtUP_SubmitTime_v1r0,
d_849518448	as 	RcrtSI_Race_v1r0, 
d_793822265 as RcrtV_UpdateRecType_v1r0,
/*d_148197146 as RcrtV_DuplicateType_v1r0*/	
d_684926335	as	RcrtSI_HFHSRace_v1r0,
/*d_527823810	as	RcrtSI_HFHSEthnicity_v1r0,*/
d_435027713	as	RcrtSI_SH_HFHS_Sex_v1r0,
/*d_507120821 as  SMMet_EnrollStatus_v1r0,*/
/*d_424306855 as  SMMet_FullyEnrolled_v1r0,*/
/*d_481139103 as  RcrtSI_WorkflowType_v1r0,*/
/*d_697256759   as RcrtSI_OptOutTm_v1r0,*/	
d_706283025_d_873405723 as RcrtSI_OptOut_v1r0_busy,
d_706283025_d_196038514 as RcrtSI_OptOut_v1r0_inter,
d_706283025_d_517101990 as RcrtSI_OptOut_v1r0_priv,
d_706283025_d_347614743 as RcrtSI_OptOut_v1r0_contacts,
d_706283025_d_535928798 as RcrtSI_OptOut_v1r0_able,
d_706283025_d_897366187 as RcrtSI_OptOut_v1r0_other,
d_706283025_d_415693436 as RcrtSI_OptOut_v1r0_specify,
d_706283025_d_719451909 as RcrtSI_OptOut_v1r0_impt,
d_706283025_d_377633816 as RcrtSI_OptOut_v1r0_partic,
d_706283025_d_211023960 as RcrtSI_OptOut_v1r0_term,
d_706283025_d_209509101 as RcrtSI_OptOut_v1r0_time,
d_706283025_d_363026564 as RcrtSI_OptOut_v1r0_samples,
d_706283025_d_405352246 as RcrtSI_OptOut_v1r0_comp,
d_706283025_d_755545718 as RcrtSI_OptOut_v1r0_eligible,
d_706283025_d_831137710 as RcrtSI_OptOut_v1r0_GenTest,
d_706283025_d_496935183 as RcrtSI_OptOut_v1r0_health,
d_706283025_d_491099823 as RcrtSI_OptOut_v1r0_access,
d_706283025_d_836460125 as RcrtSI_OptOut_v1r0_online,
d_706283025_d_163534562 as RcrtSI_OptOut_v1r0_concern,
d_706283025_d_331787113 as RcrtSI_OptOut_v1r0_PrivacyA,
d_706283025_d_705732561 as RcrtSI_OptOut_v1r0_PrivacyB,
d_706283025_d_381509125 as RcrtSI_OptOut_v1r0_PrivacyC,
d_706283025_d_497530905 as RcrtSI_OptOut_v1r0_PrivacyD,
d_706283025_d_627995442 as RcrtSI_OptOut_v1r0_PrivacyE,
d_706283025_d_208102461 as RcrtSI_OptOut_v1r0_PrivacyF,
d_706283025_d_579618065 as RcrtSI_OptOut_v1r0_PrivacyG,
d_706283025_d_702433259 as RcrtSI_OptOut_v1r0_PrivacyH,
d_706283025_d_771146804 as RcrtSI_OptOut_v1r0_PrivacyI,
d_706283025_d_163284008 as RcrtSI_OptOut_v1r0_PrivacyJ,
d_706283025_d_387198193 as RcrtSI_OptOut_v1r0_PrivacyK,							
d_706283025_d_566047367 as RcrtSI_OptOut_v1r0_PrivacyL,
d_706283025_d_400259098 as RcrtSI_OptOut_v1r0_Covid,
d_706283025_d_260703126 as RcrtSI_OptOut_v1r0_MyChart,
d_706283025_d_744197145 as RcrtSI_OptOut_v1r0_unable,
d_706283025_d_950040334 as RcrtSI_OptOut_v1r0_none,	
d_142654897_d_461488577	as	RcrtES_Aware_v1r0_Email,
d_142654897_d_942255248	as	RcrtES_Aware_v1r0_Mail,	
d_142654897_d_607081902	as	RcrtES_Aware_v1r0_Invite,
d_142654897_d_639721694 as 	RcrtES_Aware_v1r0_Phone,
d_142654897_d_196856782 as  RcrtES_Aware_v1r0_Phys,
d_142654897_d_177402915 as  RcrtES_Aware_v1r0_Staff,
d_142654897_d_791389099	as	RcrtES_Aware_v1r0_News,
d_142654897_d_684726272 as 	RcrtES_Aware_v1r0_HCNews,
d_142654897_d_241590841 as  RcrtES_Aware_v1r0_HCSite,
d_142654897_d_206879104 as  RcrtES_Aware_v1r0_Web,
d_142654897_d_642287621	as	RcrtES_Aware_v1r0_Social,
d_142654897_d_520301146 as 	RcrtES_Aware_v1r0_TV,
d_142654897_d_285130077 as  RcrtES_Aware_v1r0_Video,
d_142654897_d_549687190	as	RcrtES_Aware_v1r0_Family,
d_142654897_d_326825649	as	RcrtES_Aware_v1r0_Member,
d_142654897_d_819377306	as	RcrtES_Aware_v1r0_Poster,
d_142654897_d_829269606	as	RcrtES_Aware_v1r0_Table,
d_142654897_d_967372009 as  RcrtES_Aware_v1r0_Hold,
d_142654897_d_462314689	as	RcrtES_Aware_v1r0_Other,	
/*d_412000022	as	RcrtCS_HIPAAVer_v1r0,*/
/*d_558435199	as	RcrtCS_HIPAAAuth_v1r0,*/
/*d_262613359	as	RcrtCS_HIPAAAuthDt_v1r0,*/
/*d_379080287	as	RcrtES_PIN_v1r0,*/
/*d_454205108	as	RcrtCS_Version_v1r0,*/
d_471168198	as	RcrtCS_Fname_v1r0,
d_736251808	as	RcrtCS_Lname_v1r0,
d_436680969	as	RcrtCS_Mname_v1r0,
/*d_480305327	as	RcrtCS_Suffix_v1r0,*/
/*d_982402227	as	RcrtCS_Pdate_v1r0,*/
/*d_421823980	as	email,*/
/*d_348474836	as	phoneNumber,*/
/*d_756862764	as	displayName,*/
d_399159511	as	RcrtUP_Fname_v1r0,
d_231676651	as	RcrtUP_Mname_v1r0,
d_996038075	as	RcrtUP_Lname_v1r0,
/*d_506826178	as	RcrtUP_Suffix_v1r0,*/
d_153211406	as	RcrtUP_PrefName_v1r0,
/*d_564964481	as	RcrtUP_MOB_v1r0,*/
/*d_795827569	as	RcrtUP_BD_v1r0,*/
/*d_544150384	as	RcrtUP_YOB_v1r0,*/
/*d_371067537	as	RcrtUP_DOB_v1r0,*/
d_388711124	as	RcrtUP_Mobile_v1r0,
/*d_271757434	as	RcrtUP_MobileVM_V1R0,*/	
/*d_646873644	as	RcrtUP_MobileTxt_V1R0,*/
d_438643922	as	RcrtUP_Home_v1r0,
/*d_187894482	as	RcrtUP_HomeVM_v1r0,*/
d_793072415	as	RcrtUP_OtherPhone_v1r0,
/*d_983278853	as	RcrtUP_OtherVM_v1r0,*/
d_869588347	as	RcrtUP_PreEmail_v1r0,
/*d_849786503	as	RcrtUP_Email1_v1r0,*/
/*d_635101039	as	RcrtUP_Email2_v1r0,*/
/*d_714419972	as	RcrtUP_Email3_v1r0,*/
/*d_524461170	as	RcrtUP_PrefMethod_v1r0,*/	
d_521824358	as	RcrtUP_AddressLn1_v1r0,
/*d_442166669	as	RcrtUP_AddressLn2_v1r0,*/
d_703385619	as	RcrtUP_City_v1r0,
d_634434746	as	RcrtUP_State_v1r0,
/*d_892050548	as	RcrtUP_Zip_v1r0,*/
/*d_452166062	as	RcrtUP_Cancer_v1r0,*/	
/*d_650597106	as	RcrtUP_CancerYr_v1r0,*/
d_266952173	as	RcrtUP_CancerType_v1r0,
d_878865966 as BioFin_BaseBloodCol_v1r0,
d_167958071 as BioFin_BaseUrineCol_v1r0, 
d_684635302 as BioFin_BaseMouthCol_v1r0,
/*d_494982282	as	RcrtUP_CancerComts_v1r0,*/	
/*d_517311251 as  SrvBOH_TmComplete_v1r0,*/ 
/*d_205553981 as  SrvBOH_TmStart_v1r0,*/
/*d_913974510 as  SrvBOH_DtAvail_v1r0,*/
/*d_832139544 as  SrvMRE_TmComplete_v1r0,*/ 
/*d_541836531 as  SrvMRE_TmStart_v1r0,*/
/*d_770257102 as  SrvSAS_TmComplete_v1r0,*/
/*d_386488297 as  SrvSAS_TmStart_v1r0,*/ 
/*d_264644252 as  SrvLAW_TmComplete_v1r0,*/
/*d_452942800 as  SrvLAW_TmStart_v1r0,*/
/*d_651014336 as  SrvMsg_AnyLeft_v1r0,*/
/*d_100767870 as  SMMet_BaseSrvCompl_v1r0,*/
/*d_266600170_d_297462035	as	HDPaym_TmPaym_v1r0,*/
/*d_266600170_d_945795905	as	HDPaym_PaymChosen_v1r0,*/
/*d_266600170_d_320023644	as	HDPaym_CaseNumber_v1r0,*/
/*d_657475009 as HdRef_BlSpecSrvDt_v1r0,*/ /* Autogenerated date/time for refused baseline specimen surveys*/
/*d_982105411 as HdRef_DateBasesrv_v1r0,*/ /* Autoset when  HdRef_Basesrv_v1r0 selected*/
/*d_390198398 as HdRef_DateBaseblood_v1r0,*/ /* Autoset when  HdRef_Baseblood_v1r0 selected*/
/*d_808663245 as HdRef_DateBaseurine_v1r0,*/ /* Autoset when  HdRef_Baseurine_v1r0 selected*/
/*d_262357957 as HdRef_DateBasesaliva_v1r0,*/ /* Autoset when  HdRef_Basesaliva_v1r0 selected*/
/*d_974100830 as HdRef_DateAllsrv_v1r0,*/ /* Autoset when  HdRef_Allsrv_v1r0 selected*/
/*d_711256590 as HdRef_DateAllsample_v1r0,*/ /* Autoset when  HdRef_Allsample_v1r0 selected*/
/*d_577794331 as HdWd_HIPAARevokedCat_v1r0,*/ /* HIPAA Revocation Categorical*/
/*d_407743866 as HdWd_HIPAArevokedver_v1r0,*/ /* HIPAA Revocation Version*/
/*d_765336427 as HdWd_Fname_v1r0,*/ /* First Name extracted from HIPAA revocation form*/
/*d_479278368 as HdWd_Lname_v1r0,*/ /* Last Name extracted from HIPAA revocation form*/
/*d_826240317 as HdWd_Mname_v1r0,*/ /* Middle Name extracted from HIPAA revocation form*/
/*d_693626233 as HdWd_Suffix_v1r0,*/ /* Suffix*/
d_297147359_d_366295286 as HdWd_WhoRequestedRefWd_v1r0, /* Who Requested the Refusal/Withdrawal*/
d_297147359_d_366295286 as HdWd_RequestedRefWdOth_v1r0, /* Who Requested the Refusal/Withdrawal- Other (specify):*/
d_603278289_d_603278289 as HdWd_WhoAllActivity_v1r0, /*Who requested refusal of all future activities*/
d_603278289_d_821930940 as HdWd_ReqOtherAllActivity_v1r0, /*Who requested refusal of all future activities- Other (specify):*/
d_175506524_d_175506524 as HdWd_WhoHIPAARevoke_v1r0, /*Who requested HIPAA revocation*/
d_175506524_d_905787778 as HdWd_ReqHIPAArevoke_v1r0, /*Who requested HIPAA revocation- Other (specify):*/
d_299274441_d_299274441 as HdWd_WhoWdrewConsent_v1r0, /*Who withdrew consent*/
d_299274441_d_457532784 as HdWd_ReqWdrewConsent_v1r0, /*Who withdrew consent- Other (specify):*/
d_524352591_d_524352591 as HdWd_WhoDataDestruct_v1r0, /*Who requested data destruction*/
d_524352591_d_902332801 as HdWd_RequDataDestruct_v1r0, /*Who requested data destruction- Other (specify):*/
d_883668444 as HdWd_DestroyDataCat_v1r0, /* Destroy Data Categorical*/
/*d_304438543 as HdWd_DestroyDataVer_v1r0,*/ /* Data Destruction Form Version*/
/*d_104278817 as HdWd_FnameDD_v1r0,*/ /* First Name extracted from Data Destruction form*/
/*d_744604255 as HdWd_LnameDD_v1r0,*/ /* Last Name extracted from Data Destruction form*/
/*d_268665918 as HdWd_MnameDD_v1r0,*/ /* Middle Name extracted from Data Destruction form*/
/*d_592227431 as HdWd_SuffixDD_v1r0,*/ /* Suffix*/
d_726389747 as HdWd_SuspendContact_v1r0, /* Contact has been suspended*/
/*d_161366008 as HdWd_SuspendDt_v1r0,*/ /* Date of the start of suspend all contact*/
/*d_614264509 as HdWd_DateActivepart_v1r0,*/ /* Autoset when  HdWd_Activeparticipation_v1 selected*/
d_119449326 as HdWd_DateDatadestsign_v1r0, /* Autoset when HdWd_Datadestructionsigned_v1r0 selected*/
d_613641698 as HdWd_DateHIPAArevsign_v1r0, /* Autoset when HdWd_HIPAArevocationsigned_v1r0 selected*/
d_734828170 as HdRef_OthRsn_v1r0, /* Other reasons*/
d_715390138 as HdRef_Other_v1r0, /* Other reasons (specify)*/
d_130371375_d_266600170_d_222373	as	BL_SMPaym_NORCPaymElig_v1r0,
d_130371375_d_303552867_d_222373	as	F3_SMPaym_NORCPaymElig_v1r0,
d_130371375_d_496823485_d_222373	as	F1_SMPaym_NORCPaymElig_v1r0,
d_130371375_d_650465111_d_222373	as	F2_SMPaym_NORCPaymElig_v1r0,
d_130371375_d_266600170_d_297462	as	BL_HDPaym_TmPaym_v1r0,
d_130371375_d_303552867_d_297462	as	F3_HDPaym_TmPaym_v1r0,
d_130371375_d_496823485_d_297462	as	F1_HDPaym_TmPaym_v1r0,
d_130371375_d_650465111_d_297462	as	F2_HDPaym_TmPaym_v1r0,
d_130371375_d_266600170_d_320023	as	BL_HDPaym_CaseNumber_v1r0,
d_130371375_d_303552867_d_320023	as	F3_HDPaym_CaseNumber_v1r0,
d_130371375_d_496823485_d_320023	as	F1_HDPaym_CaseNumber_v1r0,
d_130371375_d_650465111_d_320023	as	F2_HDPaym_CaseNumber_v1r0,
d_130371375_d_266600170_d_438636	as	BL_HDPaym_TmRefused_v1r0,
d_130371375_d_303552867_d_438636	as	F3_HDPaym_TmRefused_v1r0,
d_130371375_d_496823485_d_438636	as	F1_HDPaym_TmRefused_v1r0,
d_130371375_d_650465111_d_438636	as	F2_HDPaym_TmRefused_v1r0,
d_130371375_d_266600170_d_648228	as	BL_HDPaym_PaymRefused_v1r0,
d_130371375_d_303552867_d_648228	as	F3_HDPaym_PaymRefused_v1r0,
d_130371375_d_496823485_d_648228	as	F1_HDPaym_PaymRefused_v1r0,
d_130371375_d_650465111_d_648228	as	F2_HDPaym_PaymRefused_v1r0,
d_130371375_d_266600170_d_648936	as	BL_HDPaym_PaymIssued_v1r0,
d_130371375_d_303552867_d_648936	as	F3_HDPaym_PaymIssued_v1r0,
d_130371375_d_496823485_d_648936	as	F1_HDPaym_PaymIssued_v1r0,
d_130371375_d_650465111_d_648936	as	F2_HDPaym_PaymIssued_v1r0,
d_130371375_d_266600170_d_731498	as	BL_SMPaym_PaymElig_v1r0,
d_130371375_d_303552867_d_731498	as	F3_SMPaym_PaymElig_v1r0,
d_130371375_d_496823485_d_731498	as	F1_SMPaym_PaymElig_v1r0,
d_130371375_d_650465111_d_731498	as	F2_SMPaym_PaymElig_v1r0,
d_130371375_d_266600170_d_787567	as	BL_SMPaym_TmPaymElig_v1r0,
d_130371375_d_266600170_d_945795	as	BL_HDPaym_PaymChosen_v1r0
FROM WORK.recruitment_prod_091922_JW;
RUN;
QUIT;

*Filtering out Study IDs that Marshfield generated records for and will never be used;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF studyid = "MC000003A78985" THEN DELETE;
ELSE IF studyid = "MC000003A78986" THEN DELETE;
ELSE IF studyid = "MC000003A78987" THEN DELETE;
ELSE IF studyid = "MC000003A78988" THEN DELETE;
ELSE IF studyid = "MC000003A78989" THEN DELETE;
ELSE IF studyid = "MC000003A78990" THEN DELETE;
ELSE IF studyid = "MC000003A78991" THEN DELETE;
ELSE IF studyid = "MC000003A78992" THEN DELETE;
ELSE IF studyid = "MC000003A78993" THEN DELETE;
ELSE IF studyid = "MC000003A78994" THEN DELETE;
ELSE IF studyid = "MC000003A78995" THEN DELETE;
ELSE IF studyid = "MC000003A78996" THEN DELETE;
ELSE IF studyid = "MC000003A78997" THEN DELETE;
ELSE IF studyid = "MC000003A78998" THEN DELETE;
ELSE IF studyid = "MC000003A78999" THEN DELETE;
ELSE IF studyid = "MC000003A79000" THEN DELETE;
ELSE IF studyid = "MC000003A79001" THEN DELETE;
ELSE IF studyid = "MC000003A79002" THEN DELETE;
ELSE IF studyid = "MC000003A79003" THEN DELETE;
ELSE IF studyid = "MC000003A79004" THEN DELETE;
RUN;

*For Sanford and HFHS because there's too many not active participants so SAS is breaking;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 180583933 THEN DELETE; 
RUN;

*Keeping X Site Only;
*DATA Work.CONCEPT_IDS;
*SET Work.CONCEPT_IDS;
*IF RcrtES_Site_v1r0 = 531629870 THEN OUTPUT; /*HP*/
*IF RcrtES_Site_v1r0 = 657167265 THEN OUTPUT; /*Sanford*/
*IF RcrtES_Site_v1r0 = 303349821 THEN OUTPUT; /*Marshfield*/
*IF RcrtES_Site_v1r0 = 125001209 THEN OUTPUT; /*KP Colorado*/
*IF RcrtES_Site_v1r0 = 327912200 THEN OUTPUT; /*KP Georgia*/
*IF RcrtES_Site_v1r0 = 300267574 THEN OUTPUT; /*KP Hawaii*/
*IF RcrtES_Site_v1r0 = 452412599 THEN OUTPUT; /*KP NW*/
*IF RcrtES_Site_v1r0 = 548392715 THEN OUTPUT; /*Henry Ford*/
*IF RcrtES_Site_v1r0 = 809703864 THEN OUTPUT; /*UC*/
*IF RcrtES_Site_v1r0 = 517700004 THEN OUTPUT; /*NCI*/
*IF RcrtES_Site_v1r0 = 13 THEN OUTPUT; /*NCI*/
*IF RcrtES_Site_v1r0 = 181769837 THEN OUTPUT; /*Other*/
*RUN;

*Keeping a dataset with all duplicates;
DATA DataWithAllDups;
SET Work.Concept_IDS;
RUN;

*Filtering Out Active Duplicates;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtV_Verification_v1r0 = 922622075 THEN DELETE;
RUN;

*Formatting Variables;

*Recruitment Variables;
PROC FORMAT;
	VALUE RecruitTypeFmt 
			180583933 = "Not active"
            486306141 = "Active"
		    854703046 = "Passive" ;

	VALUE RecruitAgeFmt
	  		124276120 = "40-45"
			450985724 = "46-50"
			363147933 = "51-55"
			636706443 = "56-60"
			771230670 = "61-65";

	VALUE SiteRaceEthnFmt
			768826601 = "White, Non-Hispanic"
			181769837 = "Other"
			178420302 = "Unavailable/Unknown"
			438483626 = "Other";

	VALUE SHRaceFmt
			232334767 = "African American/Black"
			211228524 = "American Indian or Alaskan Native"
			308427446 = "Asian"
			635279662 = "Caucasian/White"
			432722256 = "Hispanic/Latino/Black"
			232663805 = "Hispanic/Latino/Declined"
			785578696 = "Hispanic/Latino/White"
			200929978 = "Native Hawaiian"
			490725843 = "Native Hawaiian/Pacific Islander"
			965998904 = "Pacific Islander" 
			986445321 = "Blank"
			746038746 = "Declined"
			178420302 = "Unavailable/Unknown";

	VALUE HFHSRaceFmt
			232334767 = "African American/Black"
			635279662 = "Caucasian/White"
			401335456 = "Other (Hispanic, Asian, American Indian/Alaskan Native, Native Hawaiian or Pacific Islander)"
			178420302 = "Unavailable/Unknown"; 

	VALUE HFHSEthnFmt
			628733063 = "Hispanic or Latino"
			319570637 = "Not Hispanic or Latino"
			178420302 = "Unavailable/Unknown";

	VALUE SHEthnFmt
			628733063 = "Hispanic or Latino"
			319570637 = "Not Hispanic or Latino"
			986445321 = "Blank"
			746038746 = "Declined"
			178420302 = "Unavailable/Unknown";

	VALUE SiteSexFmt
			536341288 = "Female"
			654207589 = "Male"
			830573274 = "Intersex or other"
			178420302 = "Unavailable/Unknown"; 

	VALUE SHandHFHSSexFmt
			536341288 = "Female"
			654207589 = "Male"
			178420302 = "Unavailable/Unknown"; 

	VALUE IHCSMembershipStatusFmt
			939572698 = "Member of IHCS Health Plan"
			512786135 = "Non-Member IHCS Patient"
			582670006 = "Member and Patient of IHCS Health Plan";
	
	VALUE CampaignTypeFmt
			926338735 = "Random"
			348281054 = "Screening appointment"
			324692899 = "Non-screening appointment"
			351257378 = "Demographic Group"
			647148178 = "Aging out of study"
			834544960 = "Geographic group"
			682916147 = "Post-screening appointment"
			153365143 = "Technology adapters"
			663706936 = "Low-income/health professional shortage areas"
			438483626 = "Other"
			181769837 = "Other"
			398561594 = "None of the above";

	VALUE WorkflowTypeFmt
			910533468 = "Letter without PIN"
			456806539 = "Letter with PIN";

	VALUE PreConsentOptOutFmt
			104430631 = "No, Did not Opt Out"
			353358909 = "Yes, Opted Out";

	VALUE OptOutBusyFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutNotInterFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutImptFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutParticFmt
			104430631 = "No"
			353358909 = "Yes";
		
	VALUE OptOutLongtermFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutContactsFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutTimeFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutSamplesFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutCompensationFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutEligibleFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutGenTestFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutHealthFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutAccessFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutAbleFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutConcernFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyAFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyBFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyCFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyDFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyEFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyFFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyGFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyHFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyIFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE OptOutCovidFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutOnlineFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyJFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyKFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutPrivacyLFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutUnableFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutOtherFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutMyChartFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OptOutNoneFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE MaxContactsFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE SignedInFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE NoPinFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PinMatchFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE SiteFmt
			531629870 = "HealthPartners"
			548392715 = "Henry Ford Health System"
			125001209 = "Kaiser Permanente Colorado"
			327912200 = "Kaiser Permanente Georgia"
			300267574 = "Kaiser Permanente Hawaii"
			452412599 = "Kaiser Permanente Northwest"
			303349821 = "Marshfield Clinic Health System"
			657167265 = "Sanford Health"
			809703864 = "Unviersity of Chicago Medicine"
			517700004 = "National Cancer Institute"
			13 = "National Cancer Institute"
			181769837 = "Other";

	VALUE AwarePhysicianFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareEmailFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE AwareMailFmt
			104430631 = "No"
			353358909 = "Yes";
		
	VALUE AwareNewsFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareHCNewsFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareHCSiteFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareWebFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareSocialFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwarePhoneCFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareTVFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareInvitationFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareVideoFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareFamilyFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareMemberFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwarePosterFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareStaffFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareTableFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareHoldFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareOtherFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AwareHIPAAAuthFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE CSSuffixFmt
			612166858 = "Jr."
			255907182 = "Sr."
			226924545 = "I"
			270793412 = "II"
			959021713 = "III"
			643664527 = "2nd"
			537892528 = "3rd";

	VALUE ConsentSubmittedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AcctSignInMechFmt
			943488874 = "Gmail"
			101178950 = "Non-Gmail Email"
			804918759 = "Cell phone";

	VALUE UPSuffixFmt
			612166858 = "Jr."
			255907182 = "Sr."
			226924545 = "I"
			270793412 = "II"
			959021713 = "III"
			643664527 = "2nd"
			537892528 = "3rd";

	VALUE MobileVMFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE TextFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE HomeVMFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OtherVMFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PrefContactMethodFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PrevCancerFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE UPSubmittedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE VerificationStatusFmt
			875007964 = "Not yet verified"
			197316935 = "Verified"
			219863910 = "Cannot be verified"
			922622075 = "Duplicate"
			160161595 = "Outreach timed out";

	VALUE AutomatedVerificationFmt
			734437214 = "Method not used"
			426360242 = "Method used";

	VALUE ManualVerificationFmt
			734437214 = "Method not used"
			426360242 = "Method used"; 

	VALUE FirstNameMatchFmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE LastNameMatchFmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE DOBMatchFmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE PinMatch2Fmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE TokenMatchFmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE ZipcodeMatchFmt
			356674370 = "Not matched"
			219803804 = "Matched";

	VALUE SiteMatchFmt
			539025306 = "Criterium not met"
			427405444 = "Criterium met";

	VALUE AgeMatchFmt
			539025306 = "Criterium not met"
			427405444 = "Criterium met";

	VALUE CancerStatusMatchFmt
			539025306 = "Criterium not met"
			427405444 = "Criterium met";

	RUN;


*****Labels for variables and applying above formats*****;

DATA Work.Concept_ids; 
		SET Work.Concept_ids;
		LABEL   RcrtSI_RecruitType_v1r0 = "Recruitment type"
				RcrtSI_TypeTime_v1r0 = "Time recruitment type assigned"
				RcrtSI_Age_v1r0 = "Site reported age at recruitment"
				RcrtSI_Race_v1r0 = "Site reported race/ethnicity"
				RcrtSI_SHRace_v1r0 = "Sanford Health Reported Race"
				RcrtSI_HFHSRace_v1r0 = "Henry Ford Health System Reported Race"
				RcrtSI_HFHSEthnicity_v1r0 = "Henry Ford Health System Reported Ethnicity"
				RcrtSI_SHEthnicity_v1r0 = "Sanford Health Reported Ethnicity"
				RcrtSI_Sex_v1r0 = "Site reported sex"
				RcrtSI_SH_HFHS_Sex_v1r0 = "Sanford and Henry Ford reported sex"
				RcrtSI_EligibilityVer_v1r0 = "Eligibility algorithm version"
				RcrtSI_MemberStat_v1r0 = "IHCS Membership Status"
				RcrtSI_CampaignType_v1r0 = "Campaign Type"
				RcrtSI_WorkflowType_v1r0 = "Workflow Type"
				RcrtSI_OptOut_v1r0 = "Pre-consent Opt-out"
				RcrtSI_OptOut_v1r0_busy = "Too busy/stressed to join"
				RcrtSI_OptOut_v1r0_priv = "Concerned about Privacy"
				RcrtSI_OptOut_v1r0_inter = "Not interested"
				RcrtSI_OptOut_v1r0_impt = "Not interested in the study/does not think research topic is important"
				RcrtSI_OptOut_v1r0_partic = "Does not want to participate in research"
				RcrtSI_OptOut_v1r0_term = "Does not want to be in a long-term study"
				RcrtSI_OptOut_v1r0_contacts = "Too many contacts from the study"
				RcrtSI_OptOut_v1r0_able = "Not able to complete study activities online"
				RcrtSI_OptOut_v1r0_time = "Participation takes too much time, asks for too much"
				RcrtSI_OptOut_v1r0_samples = "Does not want to give biospecimen samples"
				RcrtSI_OptOut_v1r0_comp = "Compensation to participate is not high enough"
				RcrtSI_OptOut_v1r0_eligible = "Does not think they're eligible"
				RcrtSI_OptOut_v1r0_GenTest = "Opposed to genetic testing"
				RcrtSI_OptOut_v1r0_health = "Too sick/poor health to join"
				RcrtSI_OptOut_v1r0_online = "Does not like to do things online"
				RcrtSI_OptOut_v1r0_access = "Does not have reliable access to internet"
				RcrtSI_OptOut_v1r0_concern = "Worried the study might find something concerning about them"	
				RcrtSI_OptOut_v1r0_PrivacyA = "Privacy: Does not want to provide information online"
				RcrtSI_OptOut_v1r0_PrivacyB = "Privacy: Does not want to complete surveys"
				RcrtSI_OptOut_v1r0_PrivacyC = "Privacy: Does not want to provide access to EMR/medical history information or diagnoses"
				RcrtSI_OptOut_v1r0_PrivacyD = "Privacy: Does not trust the government"
				RcrtSI_OptOut_v1r0_PrivacyE = "Privacy: Does not trust research/researchers"
				RcrtSI_OptOut_v1r0_PrivacyF = "Privacy: Does not want their information shared with other researchers"
				RcrtSI_OptOut_v1r0_PrivacyG = "Privacy: Worried information won't be secure or there will be a data breach"
				RcrtSI_OptOut_v1r0_PrivacyH = "Privacy: Worried about data being given to insurance company, effects on insurance (health, life, other)"
				RcrtSI_OptOut_v1r0_PrivacyI = "Privacy: Worried about data being given to employer/potential employer"
				RcrtSI_OptOut_v1r0_PrivacyJ = "Privacy: Worried that their information could be used to discriminate against them/their family"
				RcrtSI_OptOut_v1r0_PrivacyK = "Privacy: Worried that their information will be used by others to make a profit"
				RcrtSI_OptOut_v1r0_PrivacyL = "Privacy: Other privacy concerns"
				RcrtSI_OptOut_v1r0_Covid = "Concerned about COVID-19"
				RcrtSI_OptOut_v1r0_MyChart = "Refused MyChart Invitation"
				RcrtSI_OptOut_v1r0_unable = "Person is unable to participate or deceased (family member reaches out to study)"
				RcrtSI_OptOut_v1r0_other = "Other reason(s)"
				RcrtSI_OptOut_v1r0_specify = "Please specify____"
				RcrtSI_OptOut_v1r0_none = "Reason not given"
				RcrtSI_MaxContcts_v1r0 = "Max number of contacts reached for cycle"
				RcrtSI_SignedIn_v1r0 = "Signed-in"
				RcrtSI_SignTime_v1r0 = "Time sign-in occurred"
				RcrtES_noPIN_v1r0 = "No PIN"
				RcrtES_PIN_v1r0 = "PIN entered"
				RcrtES_PINmatch_v1r0 = "PIN match"
				RcrtES_Site_v1r0 = "Site"
				RcrtES_Aware_v1r0_Phys = "Physician or other healthcare staff"
				RcrtES_Aware_v1r0_Email = "Email or text invitation"
				RcrtES_Aware_v1r0_Mail = "Letter or brochure in mail"
				RcrtES_Aware_v1r0_Phone = "Phone call invitation"
				RcrtES_Aware_v1r0_News = "News article or press release about Connect"
				RcrtES_Aware_v1r0_Staff = "Connect research staff at my health care system"
				RcrtES_Aware_v1r0_HCNews = "Health care system newsletter"
				RcrtES_Aware_v1r0_HCSite = "Health care system website"
				RcrtES_Aware_v1r0_Web = "Connect website on Cancer.gov"
				RcrtES_Aware_v1r0_Social = "Social media post (on Facebook, Twitter, Instagram, or other channels)"
				RcrtES_Aware_v1r0_TV = "Local news, television, or radio station"
				RcrtES_Aware_v1r0_Invite = "Invitation through my patient portal (such as MyChart)"
				RcrtES_Aware_v1r0_Video = "Video"
				RcrtES_Aware_v1r0_Family = "Family or friend"
				RcrtES_Aware_v1r0_Member = "Another Connect participant"
				RcrtES_Aware_v1r0_Poster = "Poster, flyer, or sign at my health care system"
				RcrtES_Aware_v1r0_Table = "Connect table at public event"
				RcrtES_Aware_v1r0_Hold = "Recorded message"
				RcrtES_Aware_v1r0_Other = "Other"
				RcrtCS_HIPAAVer_v1r0 = "HIPAA Version"
				RcrtCS_HIPAAAuth_v1r0 = "HIPAA Authorization"
				RcrtCS_HIPAAAuthDt_v1r0 = "Date/Time of HIPAA Authorization"
				RcrtCS_Version_v1r0 = "Consent Version"
				RcrtCS_Fname_v1r0 = "First Name"
				RcrtCS_Lname_v1r0 = "Last Name"
				RcrtCS_Mname_v1r0 = "Middle Name"
				RcrtCS_Suffix_v1r0 = "Suffix"
				RcrtCS_Pdate_v1r0 = "Participant Consent Date"
				RcrtCS_ConsentSumit_v1r0 = "Time consent submitted"
				RcrtCS_Consented_v1r0 = "Consent submitted"
				uid = "Account UserID"
				email = "Account Email"
				phoneNumber = "Account phone"
				displayName = "Account Name"
				RcrtPC_Acnt_SignIn_v1r0 = "Account Sign-in Mechanism"
				RcrtUP_Fname_v1r0 = "First Name"
				RcrtUP_Mname_v1r0 = "Middle Name"
				RcrtUP_Lname_v1r0 = "Last Name"
				RcrtUP_Suffix_v1r0 = "Suffix"
				RcrtUP_PrefName_v1r0 = "Preferred Name"
				RcrtUP_MOB_v1r0 = "Birth Month"
				RcrtUP_BD_v1r0 = "Birth Day"
				RcrtUP_YOB_v1r0 = "Birth Year"
				RcrtUP_DOB_v1r0 = "Date of Birth"
				RcrtUP_Age_v1r0 = "User Profile derived age"
				RcrtUP_Mobile_v1r0 = "Mobile phone"
				RcrtUP_MobileVM_V1R0 = "Mobile voicemail"
				RcrtUP_MobileTxt_V1R0 = "Text"
				RcrtUP_Home_v1r0 = "Home phone"
				RcrtUP_HomeVM_v1r0 = "Home voicemail"
				RcrtUP_OtherPhone_v1r0 = "Other phone"
				RcrtUP_OtherVM_v1r0 = "Other voicemail"
				RcrtUP_PreEmail_v1r0 = "Preferred email"
				RcrtUP_Email1_v1r0 = "Additional email 1"
				RcrtUP_Email2_v1r0 = "Additional email 2"
				RcrtUP_Email3_v1r0 = "Additional email 3"
				RcrtUP_PrefMethod_v1r0 = "Preferred contact method"
				RcrtUP_AddressLn1_v1r0 = "Address line 1"
				RcrtUP_AddressLn2_v1r0 = "Address line 2"
				RcrtUP_City_v1r0 = "City"
				RcrtUP_State_v1r0 = "State"
				RcrtUP_Zip_v1r0 = "Zip"
				RcrtUP_Cancer_v1r0 = "Previous Cancer"
				RcrtUP_CancerYr_v1r0 = "Cancer Year"
				RcrtUP_CancerType_v1r0 = "Cancer Type"
				RcrtUP_CancerComts_v1r0 = "Cancer Comments"
				RcrtUP_Submitted_v1r0 = "User Profile submitted"
				RcrtUP_SubmitTime_v1r0 = "Time User Profile submitted"
				RcrtCT_Acct_Cnst_v1r0 = "Time from account to consent"
				RcrtCT_Cnst_UP_v1r0 = "Time from consent to user profile"
				RcrtCT_Acct_SSN_v1r0 = "Time from account to social security"
				RcrtV_Verification_v1r0 = "Verification status"
				RcrtV_VerificationTm_V1R0 = "Verification status time"
				RcrtV_Automated_v1r0 = "Automated verification"
				RcrtV_Mannual_v1r0 = "Manual verification"
				RcrtV_FNameMatch_v1r0 = "First Name Match"
				RcrtV_LNameMatch_v1r0 = "Last Name Match"
				RcrtV_DOBMatch_v1r0 = "DOB Match"
				RcrtV_PINMatch_v1r0 = "PIN Match"
				RcrtV_TokenMatch_v1r0 = "Token Match"
				RcrtV_ZipMatch_v1r0 = "Zipcode Match"
				RcrtV_SiteMatch_v1r0 = "Site Match"
				RcrtV_AgeMatch_v1r0 = "Age Match"
				RcrtV_CStatusMatch_v1r0 = "Cancer Status Match" 
				SrvSS_Acct_SSN_v1r0 = "Time from account to social security";
		FORMAT RcrtSI_RecruitType_v1r0 RecruitTypeFmt. RcrtSI_Age_v1r0 RecruitAgeFmt. RcrtSI_Race_v1r0 SiteRaceEthnFmt.
		RcrtSI_SHRace_v1r0 	SHRaceFmt. RcrtSI_HFHSRace_v1r0 HFHSRaceFmt. RcrtSI_HFHSEthnicity_v1r0 HFHSEthnFmt. 
		RcrtSI_SHEthnicity_v1r0 SHEthnFmt. RcrtSI_Sex_v1r0 SiteSexFmt. RcrtSI_SH_HFHS_Sex_v1r0 SHandHFHSSexFmt.
		RcrtSI_MemberStat_v1r0 IHCSMembershipStatusFmt.	RcrtSI_CampaignType_v1r0 CampaignTypeFmt. RcrtSI_WorkflowType_v1r0 WorkflowTypeFmt.
		RcrtSI_OptOut_v1r0 PreConsentOptOutFmt. RcrtSI_OptOut_v1r0_busy OptOutBusyFmt. RcrtSI_OptOut_v1r0_impt OptOutImptFmt.
		RcrtSI_OptOut_v1r0_partic OptOutParticFmt. RcrtSI_OptOut_v1r0_inter OptOutNotInterFmt. RcrtSI_OptOut_v1r0_term OptOutLongtermFmt. RcrtSI_OptOut_v1r0_contacts OptOutContactsFmt.
		RcrtSI_OptOut_v1r0_time OptOutTimeFmt. RcrtSI_OptOut_v1r0_able OptOutAbleFmt. RcrtSI_OptOut_v1r0_samples OptOutSamplesFmt. RcrtSI_OptOut_v1r0_comp OptOutCompensationFmt.
		RcrtSI_OptOut_v1r0_eligible OptOutEligibleFmt. RcrtSI_OptOut_v1r0_priv OptOutPrivFmt. RcrtSI_OptOut_v1r0_GenTest OptOutGenTestFmt. RcrtSI_OptOut_v1r0_health OptOutHealthFmt.
		RcrtSI_OptOut_v1r0_access OptOutAccessFmt. RcrtSI_OptOut_v1r0_online OptOutOnlineFmt. RcrtSI_OptOut_v1r0_concern OptOutConcernFmt.	RcrtSI_OptOut_v1r0_PrivacyA OptOutPrivacyAFmt.
		RcrtSI_OptOut_v1r0_PrivacyB OptOutPrivacyBFmt. RcrtSI_OptOut_v1r0_PrivacyC OptOutPrivacyCFmt. RcrtSI_OptOut_v1r0_PrivacyD OptOutPrivacyDFmt.
		RcrtSI_OptOut_v1r0_PrivacyE OptOutPrivacyEFmt. RcrtSI_OptOut_v1r0_PrivacyF OptOutPrivacyFFmt. RcrtSI_OptOut_v1r0_PrivacyG OptOutPrivacyGFmt.
		RcrtSI_OptOut_v1r0_PrivacyH OptOutPrivacyHFmt. RcrtSI_OptOut_v1r0_PrivacyI OptOutPrivacyIFmt. RcrtSI_OptOut_v1r0_PrivacyJ OptOutPrivacyJFmt.
		RcrtSI_OptOut_v1r0_PrivacyK OptOutPrivacyKFmt. RcrtSI_OptOut_v1r0_PrivacyL OptOutPrivacyLFmt. RcrtSI_OptOut_v1r0_unable OptOutUnableFmt.
		RcrtSI_OptOut_v1r0_other OptOutOtherFmt. RcrtSI_OptOut_v1r0_Covid OptOutCovidFmt. RcrtSI_OptOut_v1r0_MyChart OptOutMyChartFmt. RcrtSI_OptOut_v1r0_none OptOutNoneFmt. RcrtSI_MaxContcts_v1r0 MaxContactsFmt.	
		RcrtSI_SignedIn_v1r0 SignedInFmt. RcrtES_noPIN_v1r0 NoPinFmt. RcrtES_PINmatch_v1r0 PinMatchFmt. RcrtES_Site_v1r0 SiteFmt.
		RcrtES_Aware_v1r0_Phys AwarePhysicianFmt. RcrtES_Aware_v1r0_Email AwareEmailFmt. RcrtES_Aware_v1r0_Mail AwareMailFmt.	
		RcrtES_Aware_v1r0_News AwareNewsFmt. RcrtES_Aware_v1r0_Staff AwareStaffFmt. RcrtES_Aware_v1r0_HCNews AwareHCNewsFmt. RcrtES_Aware_v1r0_HCSite AwareHCSiteFmt.
		RcrtES_Aware_v1r0_Web AwareWebFmt. RcrtES_Aware_v1r0_Social AwareSocialFmt. RcrtES_Aware_v1r0_TV AwareTVFmt.
		RcrtES_Aware_v1r0_Invite AwareInvitationFmt. RcrtES_Aware_v1r0_Phone AwarePhoneCFmt. RcrtES_Aware_v1r0_Video AwareVideoFmt. RcrtES_Aware_v1r0_Family AwareFamilyFmt. 
		RcrtES_Aware_v1r0_Member AwareMemberFmt. RcrtES_Aware_v1r0_Poster AwarePosterFmt. RcrtES_Aware_v1r0_Table AwareTableFmt. 
		RcrtES_Aware_v1r0_Hold AwareHoldFmt. RcrtCS_HIPAAAuth_v1r0 AwareHIPAAAuthFmt. RcrtES_Aware_v1r0_Other AwareOtherFmt. 
		RcrtCS_Suffix_v1r0 CSSuffixFmt. RcrtCS_Consented_v1r0 ConsentSubmittedFmt. 
		RcrtPC_Acnt_SignIn_v1r0 AcctSignInMechFmt. RcrtUP_Suffix_v1r0 UPSuffixFmt. RcrtUP_MobileVM_V1R0 MobileVMFmt. RcrtUP_MobileTxt_V1R0 TextFmt. 
		RcrtUP_HomeVM_v1r0 HomeVMFmt. RcrtUP_OtherVM_v1r0 OtherVMFmt. RcrtUP_PrefMethod_v1r0 PrefContactMethodFmt. RcrtUP_Cancer_v1r0 PrevCancerFmt. 
		RcrtUP_Submitted_v1r0 UPSubmittedFmt. RcrtV_Verification_v1r0 VerificationStatusFmt. RcrtV_Automated_v1r0 AutomatedVerificationFmt. 
		RcrtV_Mannual_v1r0 ManualVerificationFmt. RcrtV_FNameMatch_v1r0 FirstNameMatchFmt. RcrtV_LNameMatch_v1r0 LastNameMatchFmt. RcrtV_DOBMatch_v1r0 DOBMatchFmt. 
		RcrtV_PINMatch_v1r0 PinMatch2Fmt. RcrtV_TokenMatch_v1r0 TokenMatchFmt. RcrtV_ZipMatch_v1r0 ZipcodeMatchFmt. RcrtV_SiteMatch_v1r0 SiteMatchFmt. 
		RcrtV_AgeMatch_v1r0 AgeMatchFmt. RcrtV_CStatusMatch_v1r0 CancerStatusMatchFmt. ;
RUN;

*****Formats for Date and Time Variables*****;

DATA Work.Concept_ids;
SET Work.Concept_ids;
FORMAT  RcrtSI_TypeTime_v1r0 DATETIME.
		RcrtSI_SignTime_v1r0 DATETIME.
		RcrtCS_HIPAAAuthDt_v1r0 DATETIME.
		RcrtCS_Pdate_v1r0 yymmdd10.
		RcrtCS_ConsentSubmit_v1r0 DATETIME.
		RcrtUP_MOB_v1r0 MONTHw.
		RcrtUP_BD_v1r0 DAYw.
		RcrtUP_YOB_v1r0 YEARw.
		RcrtUP_DOB_v1r0 yymmdd10.
		RcrtUP_CancerYr_v1r0 YEARw.
		RcrtUP_SubmitTime_v1r0 DATETIME.
		RcrtV_VerificationTm_V1R0 DATETIME.;
RUN;

*Biospecimen Variables;

PROC FORMAT;
	VALUE CollectionSettingFmt 
			534621077 = "Research"
            664882224 = "Clinical"
		    103209024 = "Home";

	VALUE SelectVisitFmt   
			153098257 = "Baseline";

	VALUE SelectHawaiianIslandFmt  
			945449846 = "Oahu"
			704199032 = "Non-Oahu";

	VALUE AccessionIDEnteredFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE CollectionIDEnteredFmt 
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE TubeCollectedFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE AddlLabelUsedFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE RegLabReceiptFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE TubeNotCollFmt 
			234139565 = "Short draw"
            681745422 = "Participant refusal" 
			745205161 = "Participant unstable"
			181769837 = "Other"; 

	VALUE DeviationBrokenFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeNoClotFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeClotFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeSpeedHFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeSpeedLFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeTimeLFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationCentrifugeTimeSFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationGelFailFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationHemolyzedFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationTempLFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationTempHFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationInsufficientVolFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationLeakFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationLipemiaFmt
			104430631 = "No"
			353358909 = "Yes"; 

	VALUE DeviationLowVolFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationMislabeledFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationUrineHatUsedFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DeviationOtherFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE DiscardFlagFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE GoToShippingFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaselineMouthwashColFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaselineUrineColFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE CheckinComplFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE CollectionLocationFmt 
			777644826 = "UC-DCAM"
            692275326 = "Marshfield"
     		698283667 = "Lake Hallie"
     		834825425 = "HP Research Clinic"
     		736183094 = "HFHS Research Clinic (Main Campus"
            589224449 = "SF Cancer Center LL" ;

	VALUE DeviationFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE BlUSurveyFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE MWSurveyFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE ParticipantLeftFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE CheckoutComplFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE LoginSiteFmt 
			531629870 = "HealthPartners"
			548392715 = "Henry Ford Health System"
     		125001209 = "Kaiser Permanente Colorado"
     		327912200 = "Kaiser Permanente Georgia"
     		300267574 = "Kaiser Permanente Hawaii"
            452412599 = "Kaiser Permanente Northwest" 
     		303349821 = "Marshfield Clinic Health System" 
            657167265 = "Sanford Health"
            809703864 = "University of Chicago Medicine" 
            517700004 = "National Cancer Institute" 
            181769837 = "Other" ;

	VALUE LocationIDFmt 
			325115468 = "UC-DCAM" 
     		692275326 = "Marshfield" 
     		834825425 = "HP Research Clinic"
     		756784147 = "SF Cancer Center LL"
     		763273112 = "KPCO RRL"
            531313956 = "KPHI RRL" 
     		715632875 = "KPNW RRL" 
            767775934 = "KPGA RRL"
            752948709 = "Henry Ford Main Campus" 
            570271641 = "Henry Ford West Bloomfield Hospital" 
            838480167 = "Henry Ford Medical Center- Fairlane";

	VALUE TubeNotInBagFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE OrphanTubeMissingFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE OrphanTubeShippedFlagFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE TemperatureProbeFmt 
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE ShipmentCourierFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE BoxTrackEnterFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE ShipmentFlagFmt 
			104430631 = "No"
			353358909 = "Yes";
RUN;

DATA Work.Concept_ids;
		SET Work.Concept_ids;
		LABEL 	BioSpm_Setting_v1r0 = "Collection Setting"
				BioSpm_Visit_v1r0 = "Select visit"
				BioSpm_HIIsland_v1r0 = "Select Hawaiian Island"
				BioSpm_AccessionID_v1r0 = "Accession ID"
				BioSpm_AccIDEntered_v1r0 = "Accession ID Manually Entered"
				BioSpm_ColIDScan_v1r0 = "Collection ID"
				BioSpm_ColIDEntered_v1r0 = "Collection ID Manually Entered"
				BioCol_TubeCollected_v1r0 = "Tube Collected"
				BioCol_0001_v1r0 = "Serum Separator Tube 1"
				BioCol_0002_v1r0 = "Serum Separator Tube 2"
				BioCol_0011_v1r0 = "Serum Separator Tube 3"
				BioCol_0012_v1r0 = "Serum Separator Tube 4"
				BioCol_0021_v1r0 = "Serum Separator Tube 5"
				BioCol_0022_v1r0 = "Serum Separator Tube 6"
				BioCol_0031_v1r0 = "Serum Separator Tube 7"
				BioCol_0032_v1r0 = "Serum Separator Tube 8"
				BioCol_0003_v1r0 = "Heparin Tube 1"
				BioCol_0013_v1r0 = "Heparin Tube 2"
				BioCol_0004_v1r0 = "EDTA Tube 1"
				BioCol_0014_v1r0 = "EDTA Tube 2"
				BioCol_0024_v1r0 = "EDTA Tube 3"
				BioCol_0005_v1r0 = "ACD Tube 1"
				BioCol_AddLabel_v1r0 = "Additional Label Used"
				BioCol_TubeID_v1r0 = "Tube ID"
				BioCol_0008_v1r0 = "Biohazard Bag (Blood or Blood/Urine) ID"
				BioCol_ColNote1_v1r0 = "Collection notes"
				BioCol_ColTime_v1r0 = "Collection Date/Time"
				BioReg_AtReg_v1r0 = "Regional Lab Receipt"
				BioReg_ArRegTime_v1r0 = "Date/Time scanned at Regional Lab"
				BioCol_NotCol_v1r0 = "Reason Tube Not Collected"
				BioCol_Dev_v1r0_Broken = "Deviation- Broken"
				BioCol_Dev_v1r0_ClotS = "Deviation- Centrifuge- did not clot at least 30 minutes"
				BioCol_Dev_v1r0_ClotL = "Deviation- Centrifuge- clotted for longer than 2 hours"
				BioCol_Dev_v1r0_SpeedH "Deviation- Centrifuge - Improper speed/force setting used (too high)"
				BioCol_SpeedL_v1r0_SpeedL = "Deviation- Centrifuge - Improper speed/force setting used (too low)"
				BioCol_Dev_v1r0_TimeL = "Deviation- Centrifuge - improper time of spinning (too long)"
				BioCol_Dev_v1r0_TimeS = "Deviation- Centrifuge - improper time of spinning (too short)"
				BioCol_Dev_v1r0_Gel = "Deviation- Failed/broken gel layer"
				BioCol_Dev_v1r0_Hemo = "Deviation- Hemolyzed"
				BioCol_Dev_v1r0_TempL = "Deviation-Improper temperature - too low/frozen"
				BioCol_Dev_v1r0_TempH = "Deviation- Improper temperature - too high"
				BioCol_Dev_v1r0_UrVol = "Deviation- Insufficient volume"
				BioCol_Dev_v1r0_Leak = "Deviation- Leaked/spilled"
				BioCol_Dev_v1r0_Lipem = "Deviation- Lipemia"
				BioCol_Dev_v1r0_LowVol = "Deviation- Low volume - (tube/container partially filled but still usable)"
				BioCol_Dev_v1r0_Label = "Deviation- Mislabeled"
				BioCol_Dev_v1r0_Hat = "Deviation- Urine hat used"
				BioCol_Dev_v1r0_Other = "Deviation- Other"
				BioCol_Discard_v1r0 = "Discard flag"
				BioCol_NotCollNotes_v1r0 = "Not Collected Details (Optional)"
				BioCol_DeviationNotes_v1r0 = "Deviation Details"
				BioRec_NoteOpt_v1r0 = "Additional Notes (Optional)"
				BioRec_ShipFlag_v1r0 = "Go to shipping"
				BioRec_ShipTime_v1r0 = "Date/Time go to shipping"

				BioFin_BaseMouthCol_v1r0 = "Baseline Mouthwash Collected"
				BioFin_BMTime_v1r0 = "Date/time Mouthwash Collected"
				BioFin_BaseUrineCol_v1r0 = "Baseline Urin Collected"
				BioFin_BUTime_v1r0 = "Date/time Urine Collected"
				BioChk_Complete_v1r0 = "Check-In Complete"
				BioChk_Time_v1r0 = "Date/Time Check-In Complete"
				BioSpm_Location_v1r0 = "Collection Location"
				BioCol_0006_v1r0 = "Urine"
				BioCol_0007_v1r0 = "Mouthwash"
				BioCol_Deviation_v1r0 = "Deviation"
				BioCol_0009_v1r0 = "Biohazard Bag (mouthwash) ID"
				SrvBLU_BaseComplete_v1r0 = "Flag for blood/urine survey"
				SrvBlU_TmStart_v1r0 = "Date/Time Status of Start of blood/urine survey"
				SrvBlU_TmComplete_v1r0 = "Date/Time blood/urine survey completed"
				SrvMw_BaseComplete_v1r0 = "Flag for mouthwash survey"
				SrvMw_TmStart_v1r0 = "Date/Time Status of Start of blood/urine survey"
				SrvMw_TmComplete_v1r0 = "Date/Time mouthwash survey completed"
				BioFin_PartLeft_v1r0 = "Participant Left Without Providing Sample"
				BioFin_Complete_v1r0 = "Check out complete"
				BioFin_CompleteTime_v1r0 = "Time check out complete"

				BioShip_LogSite_v1r0 = "Login Site" 
				BioShip_LogFname_v1r0 = "Login first name"
				BioShip_LogLname_v1r0 = "Login last name"
				BioShip_LocalID_v1r0 = "Location ID, site specific"
				BioPack_BoxID_v1r0 = "Box ID"
				BioPack_BoxStrtTime_v1r0 = "Autogenerated date/time when first bag added to box"
				BioPack_ScanFname_v1r0 = "Scanned by First Name"
				BioPack_ScanLname_v1r0 = "Scanned by Last Name"
				BioPack_TubeNotBag_v1r0 = "Tube not in bag"
				BioPack_OMissing_v1r0 = "Orphan tube- report missing"
				BioPack_OShipFlag_v1r0 = "Orphan tube - shipped flag"
				BioPack_ModifiedTime_v1r0 = "Autogenerated date/time when box last modified (bag added or removed)"
				BioPack_TempProbe_v1r0 = "Temperature probe in box?"
				BioPack_Courier_v1r0 = "Shipment courier"
				BioPack_TrackScan1_v1r0 = "Box tracking number scan (one for each box)"
				BioPack_TrackEnter1_v1r0 = "Box tracking number manually typed (one for each box)"
				BioShip_SignFname_v1r0 = "Shipper first name signature"
				BioShip_SignLname_v1r0 = "Shipper Last name signature"
				BioShip_ShipSubmit_v1r0 = "Submit shipment flag"
				BioShip_ShipTime_v1r0 = "Autogenerated date/time stamp for submit shipment time"
				BioFB_ShipNote_v1r0 = "Outgoing shipments comments"
				BioFB_ShipFBNote_v1r0 = "Shipment feedback comments"
				BioFB_ShipStatNote_v1r0 = "Shipment status comments";

FORMAT BioSpm_Setting_v1r0 CollectionSettingFmt. BioSpm_Visit_v1r0 SelectVisitFmt. BioSpm_HIIsland_v1r0 SelectHawaiianIslandFmt.
	BioSpm_AccIDEntered_v1r0 AccessionIDEnteredFmt. BioSpm_ColIDEntered_v1r0 CollectionIDEnteredFmt. BioCol_TubeCollected_v1r0 TubeCollectedFmt.
	BioCol_AddLabel_v1r0 AddlLabelUsedFmt. BioReg_AtReg_v1r0 RegLabReceiptFmt. BioCol_NotCol_v1r0 TubeNotCollFmt. 
	BioCol_Dev_v1r0_Broken DeviationBrokenFmt. BioCol_Dev_v1r0_ClotS DeviationCentrifugeNoClotFmt. BioCol_Dev_v1r0_ClotL DeviationCentrifugeClotFmt.
	BioCol_Dev_v1r0_SpeedH DeviationCentrifugeSpeedHFmt. BioCol_SpeedL_v1r0_SpeedL DeviationCentrifugeSpeedLFmt. BioCol_Dev_v1r0_TimeL DeviationCentrifugeTimeLFmt.
	BioCol_Dev_v1r0_TimeS DeviationCentrifugeTimeSFmt. BioCol_Dev_v1r0_Gel DeviationGelFailFmt. BioCol_Dev_v1r0_Hemo DeviationHemolyzedFmt. 
	BioCol_Dev_v1r0_TempL DeviationTempLFmt. BioCol_Dev_v1r0_TempH DeviationTempHFmt. BioCol_Dev_v1r0_UrVol DeviationInsufficientVolFmt. 
	BioCol_Dev_v1r0_Leak DeviationLeakFmt. BioCol_Dev_v1r0_Lipem DeviationLipemiaFmt. BioCol_Dev_v1r0_LowVol DeviationLowVolFmt. BioCol_Dev_v1r0_Label DeviationMislabeledFmt.
	BioCol_Dev_v1r0_Hat DeviationUrineHatUsedFmt. BioCol_Dev_v1r0_Other DeviationOtherFmt. BioCol_Discard_v1r0 DiscardFlagFmt. BioRec_ShipFlag_v1r0 GoToShippingFmt. 

	BioFin_BaseMouthCol_v1r0 BaselineMouthwashColFmt. BioFin_BaseUrineCol_v1r0 BaselineUrineColFmt. BioChk_Complete_v1r0 CheckinComplFmt. BioSpm_Location_v1r0 CollectionLocationFmt. 
	BioCol_Deviation_v1r0 DeviationFmt. SrvBLU_BaseComplete_v1r0 BlUSurveyFmt. SrvMw_BaseComplete_v1r0 MWSurveyFmt. BioFin_PartLeft_v1r0 ParticipantLeftFmt. 
	BioFin_Complete_v1r0 CheckoutComplFmt.

	BioShip_LogSite_v1r0 LoginSiteFmt. BioShip_LocalID_v1r0 LocationIDFmt. BioPack_TubeNotBag_v1r0 TubeNotInBagFmt. 
	BioPack_OMissing_v1r0 OrphanTubeMissingFmt. BioPack_OShipFlag_v1r0 OrphanTubeShippedFlagFmt. BioPack_TempProbe_v1r0 TemperatureProbeFmt.
	BioPack_Courier_v1r0 ShipmentCourierFmt. BioPack_TrackEnter1_v1r0 BoxTrackEnterFmt. BioShip_ShipSubmit_v1r0 ShipmentFlagFmt. ;
RUN;

*****Formats for Date and Time Variables*****;

DATA Work.Concept_ids;
SET Work.Concept_ids;
FORMAT  RcrtUP_DOB_v1r0 yymmdd10.
		BioCol_ColTime_v1r0 DATETIME.
		BioReg_ArRegTime_v1r0 DATETIME.
		BioRec_ShipTime_v1r0 DATETIME.	
		RcrtPV_SSNTime_v1r0 DATETIME.
		RcrtPV_SSN4dTime_v1r0 DATETIME.
		QstMd1_TmComplete_v1r0 DATETIME.
		QstMd2_TmComplete_v1r0 DATETIME.
		QstMd3_TmComplete_v1r0 DATETIME.
		QstMd4_TmComplete_v1r0 DATETIME.
		BioFin_BBTime_v1r0 DATETIME.
		BioFin_BMTime_v1r0 DATETIME.
		BioFin_BUTime_v1r0 DATETIME.
		BioChk_Time_v1r0 DATETIME.
		SrvBlU_TmStart_v1r0 DATETIME.
		SrvBlu_TmComplete_v1r0 DATETIME.
		SrvMw_TmStart_v1r0 DATETIME.
		SrvMw_TmComplete_v1r0 DATETIME.
		BioRec_ShipTime_v1r0 DATETIME.
		BioFin_CompleteTime_v1r0 DATETIME.
		BioPack_BoxStrtTime_v1r0 DATETIME.
		BioPack_ModifiedTime_v1r0 DATETIME.
		BioShip_ShipTime_v1r0 DATETIME.;
RUN;	

*Study Manager/Withdrawal Variables;

PROC FORMAT;
	VALUE SSNGivenFmt 
			104430631 = "No"
			353358909 = "Yes";

	VALUE SSN4dGivenFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BOHBaseStatusFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE MREBaseStatusFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE SASBaseStatusFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE LAWBaseStatusFmt
			972455046 = "Not Started"
			615768760 = "Started"
			231311385 = "Submitted";

	VALUE BaseBloodFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PaymRoundFmt
			266600170 = "Baseline"
			496823485 = "Follow-up 1"
			650465111 = "Follow-up 2"
			303552867 = "Follow-up 3";

	VALUE PaymEligFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE NORCPaymEligFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PaymIssuedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE PaymRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE UoCPaymFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE UoCPaymRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE EMRBlPushFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaseSrvRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaseBloodRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaseUrineRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaseSalivaRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE AllSrvRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE ALLSampleRefFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE WithdrawFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE HIPAARevokeFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE HIPAARevokeCatFmt
			104053459 = "Not Revoked"
			567590935 = "Revoked but not signed"
			121454001 = "Revoked and signed";

	VALUE DestroyDataFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE DestroyDataCatFmt
			457944265 = Not Requested
			111959410 = Requested but not signed
			704529432 = Requested and signed;

	VALUE RevokeSignFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE DataDestroySignFmt
			104430631 = "No"
			353358909 = "Yes";

DATA Work.Concept_ids;
		SET Work.Concept_ids;
		LABEL 	SrvSS_SSN_v1r0 = "Social Security Number"
				SrvSS_SSN_Given_v1r0 = "Social Security Number Given"
				SrvSS_SSNTime_v1r0 = "Date/Time Full Social Security Number Submitted"
				SrvSS_SSN4d_v1r0 = "SSN last 4 digits"
				SrvSS_SSN4d_Given_v1r0 = "Partial Social Security Number Given"
				SrvSS_SSN4dTime_v1r0 = "Date/Time Partial Social Security number submitted"
				SrvBOH_BaseStatus_v1r0 = "Flag for Baseline Module Background and Overall Health"
				SrvBOH_TmComplete_v1r0 = "Date/time Status of Completion of Background and Overall Health"
				SrvBOH_TmStart_v1r0 = "Date/time Status of Start of Background and Overall Health"
				SrvBOH_DtAvail_v1r0 = "Date Available"
				SrvMRE_BaseStatus_v1r0 = "Flag for Baseline Module Medications, Reproductive Health, Exercise and Sleep"
				SrvMRE_TmComplete_v1r0 = "Date/time Status of Completion of Medications, Reproductive Health, Exercise, and Sleep"
				SrvMRE_TmStart_v1r0 = "Date/time Status of Start of Medications, Reproductive Health, Exercise, and Sleep"
				SrvSAS_BaseStatus_v1r0 = "Flag for Baseline Module Smoking, Alcohol, and Sun Exposure"
				SrvSAS_TmComplete_v1r0 = "Date/time of Completion of Smoking, Alcohol, and Sun Exposure"
				SrvSAS_TmStart_v1r0 = "Date/time Status of Start of Smoking, Alcohol, and Sun Exposure"
				SrvLAW_BaseStatus_v1r0 = "Flag for Baseline Module Where You Live and Work"
				SrvLAW_TmComplete_v1r0 = "Date/time of Completion of Where You Live and Work"
				SrvLAW_TmStart_v1r0 = "Date/time Status of Start of Where You Live and Work"
				BioFin_BaseBloodCol_v1r0 = "Baseline blood sample collected"
				SMPaym_Round_v1r0 = "Payment Round"
				SMPaym_PaymentElig_v1r0 = "Eligible for Payment"
				SMPaym_TmIncentElig_v1r0 = "Time Payment Eligible for Round"
				SMPaym_NORCPaymElig_v1r0 = "NORC Payment Eligibility"
				HDPaym_PaymIssued_v1r0 = "Payment issued"
				HDPaym_TmPayment_v1r0 = "Date/Time Payment given to participant"
				HDPaym_PaymRefused_v1r0 = "Payment refused"
				HDPaym_TmRefused_v1r0 = "Date/Time Payment refused"
				HDPaym_PaymChosen_v1r0 = "Payment Chosen"
				HDPaym_CaseNumber_v1r0 = "Case Number"
				BioFin_UoCPayment_v1r0 = "Payment issued to UoC participant"
				BioFin_TmPayment_v1r0 = "Date/Time Payment given to UoC participant"
				BioFin_UoCPaymRef_v1r0 = "Payment refused by UoC participant"
				BioFin_TmPaymRef_v1r0 = "Date/Time Payment refused by UC participant"
				EMRBl_Push_v1r0 = "Baseline EMR Push"
				EMRBl_PushDt_v1r0 = "Date/Time when Baseline EMR was pushed"
				HdRef_Basesrv_v1r0 = "Refused baseline surveys"
				HdRef_Baseblood_v1r0 = "Refused baseline blood sample"
				HdRef_Baseurine_v1r0 = "Refused baseline urine sample"
				HdRef_Basesaliva_v1r0 = "Refused baseline saliva sample"
				HdRef_Allsrv_v1r0 = "Refused all future surveys"
				HdRef_Allsample_v1r0 = "Refused all future samples"
				HdRef_DateBasesrv_v1r0 = "Date/time refused baseline surveys"
				HdRef_DateBaseblood_v1r0 = "Date/time refused baseline blood sample"
				HdRef_DateBaseurine_v1r0 = "Date/time refused baseline urine sample"
				HdRef_DateBasesaliva_v1r0 = "Date/time refused baseline saliva sample"
				HdRef_DateAllsrv_v1r0 = "Date/time refused all future surveys"
				HdRef_DateAllsample_v1r0 = "Date/time refused all future samples"
				HdWd_Activepart_v1r0 = "Withdrew from all study activities"
				HdWd_HIPAArevoked_v1r0 = "Requested to revoke HIPAA authorization"
				HdWd_HIPAARevokedCat_v1r0 = "HIPAA Revocation Categorical"
				HdWd_Destroydata_v1r0 = "Wants data destroyed"
				HdWd_DestroyDataCat_v1r0 = "Destroy Data Categorical"
				HdWd_DateActivepart_v1r0 = "Date refused all future participation"
				HdRef_DateHIPAArevoked_v1r0 = "Date requested to revoke HIPAA authorization"
				HdRef_DateDatadestroy_v1r0 = "Date requested data destroyed"
				HdWd_HIPAArevokesign_v1r0 = "Signed HIPAA revocation form"
				HdWd_DateHIPAArevsign_v1r0 = "Date HIPAA revocation signed"
				HdWd_Datadestroysign_v1r0 = "Signed data destruction request"
				HdWd_DateDatadestsign_v1r0 = "Date data destruction request signed"
				HdWd_SuspendContact_v1r0 = "Contact has been suspended";
		FORMAT  SrvSS_SSN_Given_v1r0 SSNGivenFmt. SrvSS_SSN4d_Given_v1r0 SSN4dGivenFmt. SrvBOH_BaseStatus_v1r0 BOHBaseStatusFmt.
				SrvMRE_BaseStatus_v1r0 MREBaseStatusFmt. SrvSAS_BaseStatus_v1r0 SASBaseStatusFmt. SrvLAW_BaseStatus_v1r0 LAWBaseStatusFmt.
				BioFin_BaseBloodCol_v1r0 BaseBloodFmt. SMPaym_Round_v1r0 PaymRoundFmt. SMPaym_PaymElig_v1r0 PaymEligFmt. 
				SMPaym_NORCPaymElig_v1r0 NORCPaymEligFmt. HDPaym_PaymIssued_v1r0 PaymIssuedFmt. HDPaym_PaymRefused_v1r0 PaymRefFmt.
				BioFin_UoCPayment_v1r0 UoCPaymFmt. BioFin_UoCPaymRef_v1r0 UoCPaymRefFmt. EMRBl_Push_v1r0 EMRBlPushFmt. 
				HdRef_Basesrv_v1r0 BaseSrvRefFmt. HdRef_Baseblood_v1r0 BaseBloodRefFmt. HdRef_Baseurine_v1r0 BaseUrineRefFmt. HdRef_Basesaliva_v1r0 BaseSalivaRefFmt.
				HdRef_Allsrv_v1r0 AllSrvRefFmt. HdRef_Allsample_v1r0 ALLSampleRefFmt. HdWd_Activepart_v1r0 WithdrawFmt. HdWd_HIPAArevoked_v1r0 HIPAARevokeFmt. HdWd_HIPAARevokedCat_v1r0 HIPAARevokeCatFmt.
				HdWd_Destroydata_v1r0 DestroyDataFmt. HdWd_DestroyDataCat_v1r0 DestroyDataCatFmt. HdWd_HIPAArevokesign_v1r0 RevokeSignFmt. HdWd_Datadestroysign_v1r0 DataDestroySignFmt.;
RUN;

*****Formats for Date and Time Variables*****;

DATA Work.Concept_ids;
SET Work.Concept_ids;
FORMAT  SrvSS_SSNTime_v1r0 DATETIME.
		SrvSS_SSN4dTime_v1r0 DATETIME.
		SrvBOH_TmComplete_v1r0 DATETIME.
		SrvBOH_TmStart_v1r0 DATETIME.
		SrvBOH_DtAvail_v1r0 DATETIME.
		SrvMRE_TmComplete_v1r0 DATETIME.
		SrvMRE_TmStart_v1r0 DATETIME.
		SrvSAS_TmComplete_v1r0 DATETIME.
		SrvSAS_TmStart_v1r0 DATETIME.
		SrvLAW_TmComplete_v1r0 DATETIME.
		SrvLAW_TmStart_v1r0 DATETIME.
		SMPaym_TmIncentElig_v1r0 DATETIME.
		HDPaym_TmPaym_v1r0 DATETIME.
		HDPaym_TmRefused_v1r0 DATETIME.
		BioFin_TmPayment_v1r0 DATETIME.
		BioFin_TmPaymRef_v1r0 DATETIME.
		EMRBl_PushDt_v1r0 DATETIME.
		HdRef_DateBasesrv_v1r0 DATETIME.
		HdRef_DateBaseblood_v1r0 DATETIME.
		HdRef_DateBaseurine_v1r0 DATETIME.
		HdRef_DateBasesaliva_v1r0 DATETIME.
		HdRef_DateAllsrv_v1r0 DATETIME.
		HdRef_DateAllsample_v1r0 DATETIME.
		HdWd_DateActivepart_v1r0 DATETIME.
		HdRef_DateHIPAArevoked_v1r0 DATETIME.
		HdRef_DateDatadestroy_v1r0 DATETIME.
		HdWd_DateHIPAArevsign_v1r0 DATETIME.
		HdWd_DateDatadestsign_v1r0 DATETIME.;
RUN;

*Master Dictionary (New) Variables; 

PROC FORMAT;
	VALUE PaymentIssuedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE JointRefusedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalBusyFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalNotInterFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE RefusalTimeFmt
			104430631 = "No"
			353358909 = "Yes";
			
	VALUE RefusalPaymentFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalSickFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalInternetFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalWorriedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyAFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyBFmt
			104430631 = "No"
			353358909 = "Yes";
		
	VALUE RefusalPrivacyCFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyDFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE RefusalPrivacyEFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyFFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyGFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyHFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyIFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalPrivacyJFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalUnableFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RefusalNotGivenFmt
			104430631 = "No"
			353358909 = "Yes";
		
	VALUE WDSuffixFmt
			612166858 = "Jr."
			255907182 = "Sr."
			226924545 = "I"
			270793412 = "II"
			959021713 = "III"
			643664527 = "2nd"
			537892528 = "3rd";

	VALUE MWKitSentFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BaseSrvComplFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE BLSamplesCollFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE FullyEnrolledFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE HFHSREFmt
			473807808 = "African American/Black and Hispanic or Latino"
			269950058 = "African American/Black and not Hispanic or Latino"
			998778678 = "African American/Black and Ethnicity Unavailable/Unknown"
			871169055= "Caucasian/White and Hispanic or Latino"
			211847969 = "Caucasian/White and not Hispanic or Latino"
			613506991 = "Caucasian/White and Ethnicity Unavailable/Unknown"
			646444521 = "Other (Hispanic, Asian, American Indian/Alaskan Native, Native Hawaiian or Pacific Islander) and Hispanic or Latino"
			480568177 = "Other (Hispanic, Asian, American Indian/Alaskan Native, Native Hawaiian or Pacific Islander) and not Hispanic or Latino" 
			601070694 = "Other (Hispanic, Asian, American Indian/Alaskan Native, Native Hawaiian or Pacific Islander) and Ethnicity Unavailable/Unknown" 
			724873055 = "Race Unavailable/Unknown and Ethnicity Hispanic or Latino"
			819077778 = "Race Unavailable/Unknown and Ethnicity not Hispanic or Latino"
			228278549 = "Race Unavailable/Unknown and Ethnicity Unavailable/Unknown";

	VALUE PartDeceasedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE SourceOfDecFmt
			817514412 = "Spouse/partner"
			597175457 = "Child"
			341709648 = "Other relative or proxy"
			890182396 = "IHCS Staff"
			181769837 = "Other";

	VALUE RefBLSpSrvFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE WdConsentFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE RequestedWdFmt 
			648459216 = "The participant (via the CSC directly or via a Connect site staff)"
			658808644 = "The Connect Principal Investigator (or designate)"
			745366882 = "The Chair of the Connect IRB-of-record (NIH IRB)"
			786757575 = "Site PI listed on the site-specific consent form"
			847056701 = "Chair of the Site IRB"
			807835037 = "Other |__|";
			
	VALUE SuspContactFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE WorResFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE PrivConcFmt
			104430631 = "No"
			353358909 = "Yes";
	
	VALUE DislikeOnlineFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE UnableOnlineFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE COVIDConcFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE IncarceratedFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE OthRsnFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE VOutreachFmt	
			104430631 = "No"
			353358909 = "Yes";

	VALUE DupTypeFmt
			638335430 = "Active recruit signed in as Passive"
			654558118 = "Participant already enrolled";

	VALUE UpdateRecFmt
			132080040 = "No change needed"
			854903954 = "Passive to Active"
			965707001 = "Active to Passive";

 	VALUE AnyLeftFmt
			104430631 = "No"
			353358909 = "Yes";

	VALUE EnrollStatFmt
			238916532 = "Signed-in"
			165539416 = "Consented"
			232581561 = "User Profile Complete"
			593616423 = "Verification Complete"
			289729076 = "Cannot Be Verified"
			800366201 = "Verified - mimimally enrolled"
			116215611 = "Fully Enrolled";

	VALUE PartStatFmt
			208325815 = "No Refusal"
			622008261 = "Refused some activities"
			134659217 = "Refused all future activities"
			872012139 = "Revoked HIPAA only"
			854021266 = "Withdrew consent"
			241236037 = "Destroy data"
			6 = "Deceased";

	VALUE HIPAASuffixFmt
			612166858 = "Jr."
			255907182 = "Sr."
			226924545 = "I"
			270793412 = "II"
			959021713 = "III"
			643664527 = "2nd"
			537892528 = "3rd";

	VALUE DDSuffixFmt
			612166858 = "Jr."
			255907182 = "Sr."
			226924545 = "I"
			270793412 = "II"
			959021713 = "III"
			643664527 = "2nd"
			537892528 = "3rd";

*Labeling New Master Dictionary Variables;
DATA Work.Concept_ids;
		SET Work.Concept_ids;
		LABEL 	SMPaym_JointPaymIssued_v1r0 = "Payment refused by any participant"
				SMPaym_JointTmIssued_v1r0 = "Date/time payment issued by NORC or UoC"
				SMPaym_JointRefused_v1r0 = "Payment refused by any participant"
				SMPaym_JointTmRefused_v1r0 = "Date/time payment refused by any participant"
				SrvBOH_DtAvail_v1r0 = "Date Available"
				HdRef_Busy_v1r0 = "Too busy/stressed to participate" 
				HdRef_NotInterested_v1r0 = "No longer interested in the study" 
				HdRef_TooMuchTime_v1r0 = "Participation takes too much time, asks for too much"
				HdRef_Payment_v1r0 = "Payment or benefit to participant is not great enough"
				HdRef_Sick_v1r0 = "Too sick/poor health to participate"
				HdRef_NoInternet_v1r0 = "Does not have reliable access to internet"
				HdRef_Worried_v1r0 = "Worried the study might find something concerning about them"
				HdRef_PrivacyA_v1r0 = "Privacy: Concerns about providing information online"
				HdRef_PrivacyB_v1r0 = "Privacy: Does not trust the government"
				HdRef_PrivacyC_v1r0 = "Privacy: Does not research/researchers"
				HdRef_PrivacyD_v1r0 = "Privacy: Does not want their information shared with other researchers"
				HdRef_PrivacyE_v1r0 = "Privacy: Worried information is not secure or there will be a data breach"
				HdRef_PrivacyF_v1r0 = "Privacy: Worried about data being given to insurance company, effects on insurance (health, life, other)"
				HdRef_PrivacyG_v1r0 = "Privacy: Worried about data being given to employer/potential employer"
				HdRef_PrivacyH_v1r0 = "Privacy: Worried that their information could be used to discriminate against them/their family"
				HdRef_PrivacyI_v1r0 = "Privacy: Worried that their information will be used by others to make a profit"
				HdRef_PrivacyJ_v1r0 = "Privacy: Other privacy concerns"
				HdRef_Online_v1r0 = "I am not able to complete the study activities online"
				HdRef_Unable_v1r0 = "Participant is now unable to participate or is deceased (family member reaches out to study)"
				HdRef_Other_v1r0 = "Other reasons (specify)"
				HdRef_NotGiven_v1r0 = "Reason not given"
				HdWd_Fname_v1r0 = "First Name"
				HdWd_Lname_v1r0 = "Last Name"
				HdWd_Mname_v1r0 = "Middle Name"
				HdWd_Suffix_v1r0 = "Suffix"
				BioCol_MWKitSent_v1r0 = "Mouthwash Kit Sent"
				BioCol_DtMWKitSent_v1r0 = "Autogenerated date/time stamp for Mouthwash Kit Sent"
				SMMet_BaseSrvCompl_v1r0 = "All baseline surveys completed"
				SMMet_BLSamplesColl_v1r0 = "All baseline samples collected"
				SMMet_FullyEnrolled_v1r0 = "Participant is fully enrolled"
				RcrtV_VerificationMo_v1r0 = "Verification status month"
				RcrtSI_HFHSRE_v1r0 = "Henry Ford Health System Race Ethnicity Combination"
				HdWd_Deceased_v1r0 = "Participant Deceased" 
				HdWd_DeceasedDt_v1r0 = "Date Participant Deceased"
				HdWd_DeceasedDtEntry_v1r0 = "Date Participant Deceased Date Entry"
				HdWd_SourceofReport_v1r0 = "Source of Deceased Report"
				HdRef_BlSpecSrv_v1r0 = "Refused baseline specimen surveys"
				HdWd_WdConsent_v1r0 = "Withdraw Consent"
				HdWd_WhoRequestedRefWd_v1r0 = "Who Requested the Refusal/Withdrawal"
				HdWd_RequestedRefWdOth_v1r0 = "Who Requested the Refusal/Withdrawal- Other (specify):"
				HdWd_WhoRequestSuspend_v1r0 = "Who requested the Suspended Contact"
				HdWd_RequestSuspendOth_v1r0 = "Who requested the Suspended Contact- Other (specify):"
				HdWd_WhoAllActivity_v1r0 = "Who requested refusal of all future activities"
				HdWd_ReqOtherAllActivity_v1r0 = "Who requested refusal of all future activities- Other (specify):"
				HdWd_WhoHIPAARevoke_v1r0 = "Who requested HIPAA revocation"
				HdWd_ReqHIPAArevoke_v1r0 = "Who requested HIPAA revocation- Other (specify):"
				HdWd_WhoWdrewConsent_v1r0 = "Who withdrew consent"
				HdWd_ReqWdrewConsent_v1r0 = "Who withdrew consent- Other (specify):"
				HdWd_WhoDataDestruct_v1r0 = "Who requested data destruction"
				HdWd_RequDataDestruct_v1r0 = "Who requested data destruction- Other (specify):"
				HdWd_Suspend_v1r0 = "Suspend all contact on case until DATE: MM/DD/YYYY"
				HdWd_SuspendContact_v1r0 = "Contact has been suspended"
				HdRef_WorriedResults_v1r0 = "Worried about receiving results from the study"
				HdRef_Privacy_v1r0 = "Concerned about privacy"
				HdRef_DislikeOnline_v1r0 = "Does not like to do things online"
				HdRef_COVID_v1r0 = "Concerned about COVID_19"
				HdRef_Incarcerated_v1r0 = "Participant is incarcerated"
				HdRef_OthRsn_v1r0 = "Other Reasons"
				RcrtV_Outreach_v1r0 = "Outreach required for verification"
				RcrtV_DuplicateType_v1r0 = "Duplicate type"
				RcrtV_UpdateRecType_v1r0 = "Update recruit type"
				SrvMsg_AnyLeft_v1r0 = "Baseline survey not complete"
				HdWd_WdConsentDt_v1r0 = "Date withdrew consent"
				HdRef_BlSpecSrvDt_v1r0 = "Autogenerated date/time for refused baseline specimen surveys"
				SMMet_EnrollStatus_v1r0 = "Enrollment Status"
				SMMet_PartStatus_v1r0 = "Participation status"
				RcrtSI_TimeStamp_v1r0 = "Time Stamp for when study ID is submitted by the site"
				HdWd_SuspendDt_v1r0 = "Date of the start of suspend all contact"
				HdWd_HIPAArevokedver_v1r0 = "HIPAA Revocation Version"
				HdWd_DestroyDataVer_v1r0 = "Data Destruction Form Version"
				HdWd_FnameDD_v1r0 = "First Name"
				HdWd_LnameDD_v1r0 = "Last Name"
				HdWd_MnameDD_v1r0 = "Middle Name"
				HdWd_SuffixDD_v1r0 = "Suffix"
				RcrtSI_OptOutTm_v1r0 = "Date/time for pre-consent opt-out";
			FORMAT  SMPaym_JointPaymIssued_v1r0 PaymentIssuedFmt. SMPaym_JointRefused_v1r0 JointRefusedFmt. HdRef_Busy_v1r0 RefusalBusyFmt. 
					HdRef_NotInterested_v1r0 RefusalNotInterFmt. HdRef_TooMuchTime_v1r0 RefusalTimeFmt. HdRef_Payment_v1r0 RefusalPaymentFmt. 
					HdRef_Sick_v1r0 RefusalSickFmt. HdRef_NoInternet_v1r0 RefusalInternetFmt. HdRef_Worried_v1r0 RefusalWorriedFmt.
					HdRef_PrivacyA_v1r0 RefusalPrivacyAFmt. HdRef_PrivacyB_v1r0 RefusalPrivacyBFmt. HdRef_PrivacyC_v1r0 RefusalPrivacyCFmt.
					HdRef_PrivacyD_v1r0 RefusalPrivacyDFmt. HdRef_PrivacyE_v1r0 RefusalPrivacyEFmt. HdRef_PrivacyF_v1r0 RefusalPrivacyFFmt.
					HdRef_PrivacyG_v1r0 RefusalPrivacyGFmt. HdRef_PrivacyH_v1r0 RefusalPrivacyHFmt. HdRef_PrivacyI_v1r0 RefusalPrivacyIFmt.
					HdRef_PrivacyJ_v1r0 RefusalPrivacyJFmt. HdRef_Unable_v1r0 RefusalUnableFmt. HdRef_NotGiven_v1r0 RefusalNotGivenFmt.
					HdWd_Suffix_v1r0 WDSuffixFmt. BioCol_MWKitSent_v1r0 MWKitSentFmt. SMMet_BaseSrvCompl_v1r0 BaseSrvComplFmt.
					SMMet_BLSamplesColl_v1r0 BLSamplesCollFmt. SMMet_FullyEnrolled_v1r0 FullyEnrolledFmt. RcrtSI_HFHSRE_v1r0 HFHSREFmt.
					HdWd_Deceased_v1r0 PartDeceasedFmt. HdWd_SourceofReport_v1r0 SourceOfDecFmt.
					HdRef_BlSpecSrv_v1r0 RefBLSpSrvFmt. HdWd_WdConsent_v1r0 WdConsentFmt. HdWd_WhoRequestedRefWd_v1r0 RequestedWdFmt. 
					HdWd_WhoRequestSuspend_v1r0 RequestedWdFmt. HdWd_WhoAllActivity_v1r0 RequestedWdFmt. HdWd_WhoHIPAARevoke_v1r0 RequestedWdFmt.
					HdWd_WhoWdrewConsent_v1r0 RequestedWdFmt. HdWd_WhoDataDestruct_v1r0 RequestedWdFmt.
					HdWd_SuspendContact_v1r0 SuspContactFmt. HdRef_WorriedResults_v1r0 WorResFmt. HdRef_Privacy_v1r0 PrivConcFmt.
					HdRef_Online_v1r0 UnableOnlineFmt. HdRef_DislikeOnline_v1r0 DislikeOnlineFmt. HdRef_COVID_v1r0 COVIDConcFmt. HdRef_Incarcerated_v1r0 IncarceratedFmt.
					HdRef_OthRsn_v1r0 OthRsnFmt. RcrtV_Outreach_v1r0 VOutreachFmt. RcrtV_DuplicateType_v1r0 DupTypeFmt. RcrtV_UpdateRecType_v1r0 UpdateRecFmt.
					SrvMsg_AnyLeft_v1r0 AnyLeftFmt. SMMet_EnrollStatus_v1r0 EnrollStatFmt. SMMet_PartStatus_v1r0 PartStatFmt.
					HdWd_SuffixDD_v1r0 DDSuffixFmt.;
RUN;

	*****Formats for Date and Time Variables*****;

DATA Work.Concept_ids;
SET Work.Concept_ids;
FORMAT  SMPaym_JointTmIssued_v1r0 DATETIME.
		SMPaym_JointTmRefused_v1r0 DATETIME.
		SrvBOH_DtAvail_v1r0 DATETIME.
		BioCol_DtMWKitSent_v1r0 DATETIME.
		RcrtV_VerificationMo_v1r0 MONTHw.
		HdWd_DeceasedDt_v1r0 Date9.
		HdWd_DeceasedDtEntry_v1r0 DATETIME.
		HdWd_Suspend_v1r0 Date9.
		HdWd_WdConsentDt_v1r0 DATETIME.
		HdRef_BlSpecSrvDt_v1r0 DATETIME.
		RcrtSI_TimeStamp_v1r0 DATETIME.
		HdWd_SuspendDt_v1r0 DATETIME.
		RcrtSI_OptOutTm_v1r0 DATETIME.;
RUN;

*Delete Duplicates (2 ways); 
PROC SORT Data= Work.CONCEPT_IDS out=CONCEPT_IDS nodupkey; 
by _all_;  
RUN;

PROC SQL;
CREATE TABLE NoDups as
select distinct *
From work.concept_ids;
Quit;

*See if you get the same count if I delete those that are verified duplicate/subset where verified NE duplicate;
PROC FREQ DATA= Work.Concept_ids;
TABLES RcrtSI_Age_v1r0; 
RUN; 

PROC FREQ DATA= Work.Concept_ids;
TABLES RcrtSI_Age_v1r0; 
WHERE RcrtV_Verification_v1r0 NE 922622075;
RUN; 

*Metrics For SM Dashboard Derivations; 

*Creating character variable for site (sitechar);
data concept_ids;
length sitechar $300;
set concept_ids;
IF RcrtES_Site_v1r0 = 531629870 THEN sitechar= "HealthPartners";
ELSE IF RcrtES_Site_v1r0 = 657167265 THEN sitechar = "Sanford Health";
ELSE IF RcrtES_Site_v1r0 = 303349821 THEN sitechar = "Marshfield Clinic Health System";
ELSE IF RcrtES_Site_v1r0 = 125001209 THEN sitechar = "Kaiser Permanente Colorado";
ELSE IF RcrtES_Site_v1r0 = 327912200 THEN sitechar = "Kaiser Permanente Georgia";
ELSE IF RcrtES_Site_v1r0 = 300267574 THEN sitechar = "Kaiser Permanente Hawaii";
ELSE IF RcrtES_Site_v1r0 = 452412599 THEN sitechar = "Kaiser Permanente Northwest";
ELSE IF RcrtES_Site_v1r0 = 548392715 THEN sitechar = "Henry Ford Health System";
ELSE IF RcrtES_Site_v1r0 = 809703864 THEN sitechar = "University of Chicago Medicine";
*IF RcrtES_Site_v1r0 = 517700004 THEN OUTPUT; /*National Cancer Institute*/
*IF RcrtES_Site_v1r0 = 13 THEN OUTPUT; /*National Cancer Institute*/
ELSE IF RcrtES_Site_v1r0 = 181769837 THEN sitechar = "Other";
LABEL sitechar = "Site";
RUN;

*Derive SH Race/Ethnicity Overall Variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SHRace_v1r0 = 635279662 AND RcrtSI_SHEthnicity_v1r0 = 319570637 THEN RcrtSI_SHRaceEth_v1r0 = 1;
ELSE IF RcrtSI_SHRace_v1r0 = 232334767 OR RcrtSI_SHRace_v1r0 = 211228524 OR RcrtSI_SHRace_v1r0 = 308427446
OR RcrtSI_SHRace_v1r0 = 432722256 OR RcrtSI_SHRace_v1r0 = 232663805 OR RcrtSI_SHRace_v1r0 = 785578696
OR RcrtSI_SHRace_v1r0 = 200929978 OR RcrtSI_SHRace_v1r0 = 490725843 OR RcrtSI_SHRace_v1r0 = 965998904 
OR RcrtSI_SHEthnicity_v1r0 = 628733063 THEN RcrtSI_SHRaceEth_v1r0 = 2;
ELSE IF RcrtSI_SHRace_v1r0 = 986445321 OR RcrtSI_SHRace_v1r0 = 746038746 OR RcrtSI_SHRace_v1r0 = 178420302
AND RcrtSI_SHEthnicity_v1r0 = 319570637 THEN RcrtSI_SHRaceEth_v1r0 = 3;
ELSE IF RcrtSI_SHRace_v1r0 = 986445321 OR RcrtSI_SHRace_v1r0 = 746038746 OR RcrtSI_SHRace_v1r0 = 178420302 
THEN RcrtSI_SHRaceEth_v1r0 = 3; 
ELSE IF RcrtSI_SHRace_v1r0 = RcrtSI_SHRace_v1r0 = 635279662 OR RcrtSI_SHRace_v1r0= 986445321 OR RcrtSI_SHRace_v1r0 = 746038746 OR RcrtSI_SHRace_v1r0 = 178420302 
AND RcrtSI_SHEthnicity_v1r0 = 986445321 OR RcrtSI_SHEthnicity_v1r0 = 746038746 OR RcrtSI_SHEthnicity_v1r0 = 178420302
THEN RcrtSI_SHRaceEth_v1r0 = 3;
RUN; 

PROC FORMAT;
VALUE SHRaceEthFmt
	1 = "White, Non-Hispanic"
	2 = "Other"
	3 = "Unavailable/Unknown";

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS; 
LABEL RcrtSI_SHRaceEth_v1r0 = "SH Overall Race/Ethnicity";
FORMAT RcrtSI_SHRaceEth_v1r0 SHRaceEthFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR RcrtSI_Race_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_SHEthnicity_v1r0 RcrtSI_SHRaceEth_v1r0;
RUN;*/

*Derive SH Race/Ethnicity Overall Variable Using JUST Their Race Variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SHRace_v1r0 = 635279662 THEN RcrtSI_SHRaceEth2_v1r0 = 1;
ELSE IF RcrtSI_SHRace_v1r0 = 232334767 OR RcrtSI_SHRace_v1r0 = 211228524 OR RcrtSI_SHRace_v1r0 = 308427446
OR RcrtSI_SHRace_v1r0 = 432722256 OR RcrtSI_SHRace_v1r0 = 232663805 OR RcrtSI_SHRace_v1r0 = 785578696
OR RcrtSI_SHRace_v1r0 = 200929978 OR RcrtSI_SHRace_v1r0 = 490725843 OR RcrtSI_SHRace_v1r0 = 965998904 
THEN RcrtSI_SHRaceEth2_v1r0 = 2;
ELSE IF RcrtSI_SHRace_v1r0 = 986445321 OR RcrtSI_SHRace_v1r0 = 746038746 OR RcrtSI_SHRace_v1r0 = 178420302
THEN RcrtSI_SHRaceEth2_v1r0 = 3;
RUN; 

PROC FORMAT;
VALUE SHRaceEth2Fmt
	1 = "White, Non-Hispanic"
	2 = "Other"
	3 = "Unavailable/Unknown";

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS; 
LABEL RcrtSI_SHRaceEth2_v1r0 = "SH Overall Race/Ethnicity";
FORMAT RcrtSI_SHRaceEth2_v1r0 SHRaceEth2Fmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR RcrtSI_Race_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_SHEthnicity_v1r0 RcrtSI_SHRaceEth2_v1r0;
RUN;*/

*Derive HFHS Race/Ethnicity Overall Variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_HFHSRE_v1r0 = 211847969 THEN RcrtSI_HFHSREOverall_v1r0 = 1;
ELSE IF RcrtSI_HFHSRE_v1r0 = 473807808 OR RcrtSI_HFHSRE_v1r0 = 269950058 OR RcrtSI_HFHSRE_v1r0 = 998778678 OR
RcrtSI_HFHSRE_v1r0 = 871169055 OR RcrtSI_HFHSRE_v1r0 = 646444521 OR RcrtSI_HFHSRE_v1r0 = 480568177 OR 
RcrtSI_HFHSRE_v1r0 = 601070694 OR RcrtSI_HFHSRE_v1r0 = 724873055 THEN RcrtSI_HFHSREOverall_v1r0 = 2;
ELSE IF RcrtSI_HFHSRE_v1r0 = 613506991 OR RcrtSI_HFHSRE_v1r0 = 819077778 OR RcrtSI_HFHSRE_v1r0 = 228278549
THEN RcrtSI_HFHSREOverall_v1r0 = 3;
RUN;

PROC FORMAT;
VALUE HFHSRaceEthFmt
	1 = "White, Non-Hispanic"
	2 = "Other"
	3 = "Unavailable/Unknown";

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS; 
LABEL RcrtSI_HFHSREOverall_v1r0 = "HFHS Overall Race/Ethnicity";
FORMAT RcrtSI_HFHSREOverall_v1r0 HFHSRaceEthFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR RcrtSI_Race_v1r0 RcrtSI_HFHSRE_v1r0 RcrtSI_HFHSREOverall_v1r0;
RUN;*/

*Derive HFHS Race/Ethnicity Overall Variable JUST based on HFHS race variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_HFHSRace_v1r0 = 635279662 THEN RcrtSI_HFHSREOverall2_v1r0 = 1;
ELSE IF RcrtSI_HFHSRace_v1r0 = 232334767 OR RcrtSI_HFHSRace_v1r0 = 401335456 THEN RcrtSI_HFHSREOverall2_v1r0 = 2;
ELSE IF RcrtSI_HFHSRace_v1r0 = 178420302 THEN RcrtSI_HFHSREOverall2_v1r0 = 3;
RUN;

PROC FORMAT;
VALUE HFHSRaceEthFmt
	1 = "White, Non-Hispanic"
	2 = "Other"
	3 = "Unavailable/Unknown";

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS; 
LABEL RcrtSI_HFHSREOverall2_v1r0 = "HFHS Overall Race";
FORMAT RcrtSI_HFHSREOverall2_v1r0 HFHSRaceEthFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR RcrtSI_Race_v1r0 RcrtSI_HFHSRace_v1r0 RcrtSI_HFHSRE_v1r0 RcrtSI_HFHSREOverall_v1r0 RcrtSI_HFHSREOverall2_v1r0;
RUN;*/

*Create variables for Current Status in Workflow;
*Signed in but did not consent yet;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 104430631 THEN SignInNoConsent = 1;
ELSE SignInNoConsent = 0;
RUN;

*Consented but did not submit user profile yet;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0 = 104430631 THEN ConsentNoUP = 1;
ELSE ConsentNoUP = 0;
RUN;

*Submitted user profile but verification not complete;
DATA Work.Concept_ids;
SET Work.Concept_IDS;
IF RcrtV_Verification_v1r0 = 875007964 THEN VerifCompl = 0;
ELSE IF RcrtV_Verification_v1r0= 160161595 THEN VerifCompl = 0;
ELSE IF RcrtV_Verification_v1r0 = . THEN VerifCompl = 0;
ELSE VerifCompl = 1;
RUN;

PROC FORMAT;
VALUE verifcomplfmt
	0 = "Verification Not Complete"
	1 = "Verification Complete";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL Verifcompl = "Verification Complete";
FORMAT Verifcompl verifcomplfmt.;
RUN;

	
DATA Work.CONCEPT_IDS;
SET Work.Concept_IDS;
IF RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0 = 353358909 and VerifCompl = 0 THEN SubmitUPNoVerif = 1;
ELSE SubmitUPNoVerif = 0;
RUN;

*Creating Verification Complete variable for table (diff from verifcompl bc relies signed in, consented, UP submitted);
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0 = 353358909
AND VerifCompl = 1 THEN VerificationComplete = "Yes";
ELSE VerificationComplete = "No";
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL VerificationComplete = "Verification Complete";
RUN;

*Creating Numeric Version of Verification Complete;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF VerificationComplete = "Yes" THEN VerificationCompleteNum = 1;
ELSE IF VerificationComplete = "No" THEN VerificationCompleteNum = 0;
RUN;

PROC FORMAT;
VALUE VerifComplNumFmt 
			1 = "Yes"
			2 = "No";
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL VerificationCompleteNum = "Verification Complete";
RUN;

*Create Variables for Opt Outs;
*Opt out who never signed in;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_OptOut_v1r0 = 353358909 and RcrtSI_SignedIn_v1r0 = 104430631 THEN OptOutNoSignIn = 1;
ELSE OptOutNoSignIn = 0;
RUN;

*Opt out who signed in but did not consent;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_OptOut_v1r0 = 353358909 and RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 104430631 THEN 
OptOutSignInNoCons = 1;
ELSE OptOutSignInNoCons = 0;
RUN;

*Create Variables for Completion of Baseline Activities for Verified Participants;
*Verified and Completed Baseline BOH; 
DATA Work.Concept_ids;
SET Work.Concept_ids; 
IF SrvBOH_BaseStatus_v1r0 = 231311385 AND RcrtV_Verification_v1r0 = 197316935 THEN BOHVerified = 1;
ELSE BOHVerified = 0;
RUN;

*Verified and Completed Baseline MRE; 
DATA Work.Concept_ids;
SET Work.Concept_ids; 
IF SrvMRE_BaseStatus_v1r0 = 231311385 AND RcrtV_Verification_v1r0 = 197316935 THEN MREVerified = 1;
ELSE MREVerified = 0;
RUN;

*Verified and Completed Baseline SAS; 
DATA Work.Concept_ids;
SET Work.Concept_ids; 
IF SrvSAS_BaseStatus_v1r0 = 231311385 AND RcrtV_Verification_v1r0 = 197316935 THEN SASVerified = 1;
ELSE SASVerified = 0;
RUN;

*Verified and Completed Baseline LAW;
DATA Work.Concept_ids;
SET Work.Concept_ids; 
IF SrvLAW_BaseStatus_v1r0 = 231311385 AND RcrtV_Verification_v1r0 = 197316935 THEN LAWVerified = 1;
ELSE LAWVerified = 0;
RUN;

*Verified and Completed Baseline Blood Collection;
DATA Work.CONCEPT_IDS;
SET Work.Concept_ids;
IF BioFin_BaseBloodCol_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN BloodColVerified = 1;
ELSE BloodColVerified = 0;
RUN;

*Verified and Completed Baseline Urine Collection;
DATA Work.CONCEPT_IDS;
SET Work.Concept_ids;
IF BioFin_BaseUrineCol_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN UrineColVerified = 1;
ELSE UrineColVerified = 0;
RUN;

*Verified and Completed Baseline Mouthwash Collection;
DATA Work.CONCEPT_IDS;
SET Work.Concept_ids;
IF BioFin_BaseMouthCol_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN MouthColVerified = 1;
ELSE MouthColVerified = 0;
RUN;

*Verified and Completed Baseline EMR Push;
DATA Work.CONCEPT_IDS;
SET Work.Concept_ids;
IF EMRBl_Push_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN EMRVerified = 1;
ELSE EMRVerified = 0;
RUN;

*Create Variables for Refusals and Withdrawals Among Verified Participants;
*Full Refusal of Active Participation; 
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF HdWd_Activepart_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN RefActivePartVerified = 1;
ELSE RefActivePartVerified = 0;
RUN;

*Revoked HIPAA authorization only;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF HdWd_HIPAArevoked_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN HIPAARevVer = 1;
ELSE HIPAARevVer = 0;
RUN;

*Withdrawn Consent;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF HdWd_WdConsent_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN WdConsentVer = 1;
ELSE WdConsentVer = 0;
RUN; 

*Data/Sample Destruction Requested;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF HdWd_Destroydata_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN DestroyDataVer = 1;
ELSE DestroyDataVer = 0;
RUN; 

*Creating Variable for Refusal and Withdrawals Among Verified Participants Using SMMet_PartStatus_v1r0;
*DATA Work.Concept_ids;
*SET Work.Concept_ids;
*IF SMMet_PartStatus_v1r0 = 134659217 AND RcrtV_Verification_v1r0 = 197316935 THEN PartStatus = 1;
*ELSE IF SMMet_PartStatus_v1r0 = 872012139 AND RcrtV_Verification_v1r0 = 197316935 THEN PartStatus = 2;
*ELSE IF SMMet_PartStatus_v1r0 = 854021266 AND RcrtV_Verification_v1r0 = 197316935 THEN PartStatus = 3;
*ELSE IF SMMet_PartStatus_v1r0 = 241236037 AND RcrtV_Verification_v1r0 = 197316935 THEN PartStatus = 4;
*RUN;

*PROC FORMAT;
	*VALUE PartStatusFmt
		1 = "Refused All Activities and Verified"
	 	2 = "Revoked HIPAA and Verified"
     	3 = "Withdrew Consent and Verified"
     	4 = "Data Destruction And Verified";

*DATA Work.Concept_ids;
*SET Work.Concept_ids; 
*LABEL PartStatus = "Participation Status";
*FORMAT PartStatus PartStatusFmt.;
*RUN; 

*Create Variables for Completion of SSN Among Verified Participants;
*Full SSN Given Among Verified Apartments; 
DATA Work.Concept_IDS;
SET Work.CONCEPT_IDS;
IF SrvSS_SSN_Given_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN FullSSNVerified = 1;
ELSE FullSSNVerified = 0;
RUN;

*Partial SSN Given (4 digits) Among Verified Participants; 
DATA Work.Concept_IDS;
SET Work.CONCEPT_IDS;
IF SrvSS_SSN4d_v1r0 = 353358909 AND RcrtV_Verification_v1r0 = 197316935 THEN PartSSNVerified = 1;
ELSE PartSSNVerified = 0;
RUN;

*0 Digits Given Among Verified Participants;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF SrvSS_SSN_Given_v1r0 NE 353358909 AND SrvSS_SSN4d_Given_v1r0 NE 353358909 AND RcrtV_Verification_v1r0 = 197316935 
THEN NoSSNVerified = 1;
ELSE NoSSNVerified = 0;
RUN;

*0 Digits Given (Will subset for Verified later- in pie chart); 
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF SrvSS_SSN_Given_v1r0 NE 353358909 AND SrvSS_SSN4d_Given_v1r0 NE 353358909 THEN NoSSNGiven = 1;
ELSE IF SrvSS_SSN_Given_v1r0 = 353358909 OR SrvSS_SSN4d_Given_v1r0 = 353358909 THEN NoSSNGiven = 0;
RUN;
PROC FORMAT;
VALUE NoSSNGivenFmt
	0 = "Full or Partial SSN Given"
	1 = "No SSN Given";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL NoSSNGiven = "No SSN Given";
FORMAT NoSSNGiven NoSSNGivenFmt.;
RUN;

*Completion of Initial Survey;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 1;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 2;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 4;

RUN;

PROC FORMAT;
VALUE ComplIntlSrvFmt
	1 = "None"
	2 = "BOH Only"
	3 = "2 or 3 sections"
	4 = "All";
RUN;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL ComplIntlSrv = "Completion of Initial Survey";
FORMAT ComplIntlSrv ComplIntlSrvFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR SrvBOH_BaseStatus_v1r0 SrvMRE_BaseStatus_v1r0 SrvSAS_BaseStatus_v1r0 SrvLAW_BaseStatus_v1r0 ComplIntlSrv;
RUN;*/

*Creating New Variable for ComplIntlSrv and Verified for Summary Stats Table;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LENGTH ComplIntlSrvVer $50;
IF ComplIntlSrv = 1 AND RcrtV_Verification_v1r0 = 197316935 THEN ComplIntlSrvVer = "None";
ELSE IF ComplIntlSrv = 2 AND RcrtV_Verification_v1r0 = 197316935 THEN ComplIntlSrvVer = "BOH Only";
ELSE IF ComplIntlSrv = 3 AND RcrtV_Verification_v1r0 = 197316935 THEN ComplIntlSrvVer= "2 or 3 sections";
ELSE IF ComplIntlSrv = 4 AND RcrtV_Verification_v1r0 = 197316935 THEN ComplIntlSrvVer= "All";
ELSE ComplIntlSrvVer = "Not Verified";
RUN;
DATA Work.Concept_ids;
SET Work.Concept_ids;
LENGTH ComplIntlSrvVer $50;
LABEL ComplIntlSrvVer = "Completion of Initial Survey and Verified";
RUN;
/*PROC PRINT DATA=Work.Concept_ids;
VAR ComplIntlSrv RcrtV_Verification_v1r0 ComplIntlSrvVer;
RUN;*/

*Create Variables for Breakdown of Fully Enrolled Participants by Age, Sex, Race/Ethnicity;
*Age (40-45, 46-50, 51-55, 56-60, 61-65); 
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_Age_v1r0 = 124276120 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN AgeFullyEnrolled = 1; 
ELSE IF RcrtSI_Age_v1r0 = 450985724 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN AgeFullyEnrolled = 2;
ELSE IF RcrtSI_Age_v1r0 = 363147933 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN AgeFullyEnrolled = 3;
ELSE IF RcrtSI_Age_v1r0 = 636706443 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN AgeFullyEnrolled = 4;
ELSE IF RcrtSI_Age_v1r0 = 771230670 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN AgeFullyEnrolled = 5;
RUN; 

*Race binary (white/non-hispanic, other, unknown);
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS; 
IF RcrtSI_Race_v1r0 = 768826601 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN RaceFullyEnrolled = 1;
ELSE IF RcrtSI_Race_v1r0 = 181769837 OR 438483626 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN RaceFullyEnrolled = 2;
ELSE IF RcrtSI_Race_v1r0 = 178420302 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN RaceFullyEnrolled = 3;
RUN;

*Sex (male, female, intersex/other, unknown);
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_Sex_v1r0 = 536341288 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN SexFullyEnrolled = 1;
ELSE IF RcrtSI_Sex_v1r0 = 654207589 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN SexFullyEnrolled = 2;
ELSE IF RcrtSI_Sex_v1r0 = 830573274 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN SexFullyEnrolled = 3;
ElSE IF RcrtSI_Sex_v1r0 = 178420302 AND SMMet_FullyEnrolled_v1r0 = 353358909 THEN SexFullyEnrolled = 4;
RUN; 

*Demographics of Verified Participants; 
*Age and Verified;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_Age_v1r0 = 124276120 AND RcrtV_Verification_v1r0 = 197316935 THEN AgeVerified = 1; 
ELSE IF RcrtSI_Age_v1r0 = 450985724 AND RcrtV_Verification_v1r0 = 197316935 THEN AgeVerified = 2;
ELSE IF RcrtSI_Age_v1r0 = 363147933 AND RcrtV_Verification_v1r0 = 197316935 THEN AgeVerified = 3;
ELSE IF RcrtSI_Age_v1r0 = 636706443 AND RcrtV_Verification_v1r0 = 197316935 THEN AgeVerified = 4;
ELSE IF RcrtSI_Age_v1r0 = 771230670 AND RcrtV_Verification_v1r0 = 197316935 THEN AgeVerified = 5;
ELSE AgeVerified = .;
RUN;

*Race And Verified;
*Create New Variable for Race And Verified;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_Race_v1r0 = 768826601 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerified = 1;
ELSE IF RcrtSI_Race_v1r0 = 181769837 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerified = 2;
ELSE IF RcrtSI_Race_v1r0 = 178420302 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerified = 3;
ELSE RaceVerified = .;
RUN; 

*Create New Variable for Race And Verified for SH;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_SHRaceEth2_v1r0 = 1 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedSH = 1;
ELSE IF RcrtSI_SHRaceEth2_v1r0 = 2 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedSH = 2;
ELSE IF RcrtSI_SHRaceEth2_v1r0 = 3 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedSH = 3;
ELSE RaceVerifiedSH = .;
RUN; 

*Create New Variable For Race and Verified for HFHS;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_HFHSRace_v1r0 = 635279662 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedHFHS = 1;
ELSE IF RcrtSI_HFHSRace_v1r0 = 232334767 OR RcrtSI_HFHSRace_v1r0 = 401335456 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedHFHS = 2;
ELSE IF RcrtSI_HFHSRace_v1r0 = 178420302 AND RcrtV_Verification_v1r0 = 197316935 THEN RaceVerifiedHFHS = 3;
/*ELSE RaceVerifiedHFHS = .;*/
RUN; 

PROC FORMAT;
VALUE RaceVerifiedSHFmt
			1 = "White, Non-Hispanic"
			2 = "Other"
			3 = "Unavailable/Unknown";

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL RaceVerifiedSH = "Race X Verified"
	  RaceVerifiedHFHS = "Race X Verified";
FORMAT RaceVerifiedSH RaceVerifiedSHFmt. RaceVerifiedHFHS RaceVerifiedSHFmt.;
RUN;

*Sex And Verified;
*Create New Variable for Sex And Verified;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_Sex_v1r0 = 536341288 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerified = 1;
ELSE IF RcrtSI_Sex_v1r0 = 654207589 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerified = 2;
ELSE IF RcrtSI_Sex_v1r0 = 830573274 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerified = 3;
ELSE IF RcrtSI_Sex_v1r0 = 178420302 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerified = 4;
Else SexVerified = .;
RUN; 

*Create New Variable for Sex And Verified for HFHS;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS;
IF RcrtSI_SH_HFHS_Sex_v1r0 = 536341288 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerifiedHFHS = 1;
ELSE IF RcrtSI_SH_HFHS_Sex_v1r0 = 654207589 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerifiedHFHS = 2;
ELSE IF RcrtSI_SH_HFHS_Sex_v1r0 = 178420302 AND RcrtV_Verification_v1r0 = 197316935 THEN SexVerifiedHFHS = 3;
Else SexVerifiedHFHS = .;
RUN; 

*Formatting and Labeling Above Derived Variables;
PROC FORMAT;
	VALUE SignInNoConsFmt 
			0 = "No"
            1 = "Yes";

	VALUE ConsentNoUPFmt
			0 = "No"
            1 = "Yes";

	VALUE SubUPNoVerFmt
			0 = "No"
            1 = "Yes";

	VALUE OptOutNoSignFmt
			0 = "Condition Not Met"
            1 = "Condition Met";

	VALUE OptOutSignNoConFmt
			0 = "Condition Not Met"
            1 = "Condition Met";

	VALUE BOHFmt
			0 = "No"
            1 = "Yes";

	VALUE MREFmt
			0 = "No"
            1 = "Yes";

	VALUE SASFmt
			0 = "No"
            1 = "Yes";

	VALUE LAWFmt
			0 = "No"
            1 = "Yes";

	VALUE BloodColFmt
			0 = "No"
            1 = "Yes";

	VALUE UrineColFmt
			0 = "No"
            1 = "Yes";

	VALUE MouthColFmt
			0 = "No"
            1 = "Yes";

	VALUE EMRPushFmt
			0 = "No"
            1 = "Yes";

	VALUE FullSSNVerFmt
			0 = "No"
            1 = "Yes";
	
	VALUE PartSSNVerFmt
			0 = "No"
            1 = "Yes";

	VALUE NoSSNVerFmt
			0 = "No"
            1 = "Yes";

	VALUE RefActPartVerFmt
			0 = "No"
            1 = "Yes";

	VALUE HIPAARevVerFmt
			0 = "No"
            1 = "Yes";

	VALUE WdConsentVerFmt
			0 = "No"
            1 = "Yes";

	VALUE DestroyDataVerFmt
			0 = "No"
            1 = "Yes";

	VALUE AgeFullyEnrolledFmt
			1 = "40-45 Fully Enrolled"
			2 = "46-50 Fully Enrolled"
			3 = "51-55 Fully Enrolled"
			4 = "56-60 Fully Enrolled"
			5 = "61-65 Fully Enrolled";

	VALUE RaceFullyEnrolledFmt
			1 = "WhiteNH Fully Enrolled"
			2 = "Other Fully Enrolled"
			3 = "Unknown Fully Enrolled";

	VALUE SexFullyEnrolledFmt
			1 = "Female Fully Enrolled"
			2 = "Male Fully Enrolled"
			3 = "Intersex or Other Fully Enrolled"
			4 = "Unknown Fully Enrolled";
		
	VALUE AgeVerifiedFmt
			1 = "40-45"
			2 = "46-50"
			3 = "51-55"
			4 = "56-60"
			5 = "61-65";

	VALUE RaceVerifiedFmt
			1 = "White, Non-Hispanic"
			2 = "Other"
			3 = "Unknown";

	VALUE SexVerifiedFmt
			1 = "Female"
			2 = "Male"
			3 = "Intersex or Other"
			4 = "Unknown";

	VALUE SexVerifiedHFHSFmt
			1 = "Female"
			2 = "Male"
			3 = "Unknown";

DATA Work.Concept_ids;
SET Work.Concept_ids; 
LABEL SignInNoConsent = "Signed in but did not consent yet"
      ConsentNoUP = "Consented but did not submit user profile yet"
	  SubmitUPNoVerif = "Submitted user profile but verification not complete"
	  OptOutNoSignIn = "Opt out who never signed in"
      OptOutSignInNoCons = "Opt out who signed in but did not consent"
	  BOHVerified = "Verified and Completed Baseline BOH Survey"
	  MREVerified = "Verified and Completed Baseline MRE Survey"
	  SASVerified = "Verified and Completed Baseline SAS Survey"
	  LAWVerified = "Verified and Completed Baseline LAW Survey"
	  BloodColVerified = "Verified and Completed Baseline Blood Collection"
	  UrineColVerified = "Verified and Completed Baseline Urine Collection"
	  MouthColVerified = "Verified and Completed Baseline Mouthwash Collection"
	  EMRVerified = "Verified and Completed Baseline EMR Push"
	  FullSSNVerified = "Verified and Full SSN Given"
	  PartSSNVerified = "Verified and Partial SSN Given (4 digits)"
	  NoSSNVerified = "Verified and No SSN Given"
	  RefActivePartVerified = "Verified and Full Refusal of Active Participation"
      HIPAARevVer = "Verified and Revoked HIPAA Authorization"
	  WdConsentVer = "Verified and Withdrew Consent"
	  DestroyDataVer = "Verified and Data Destruction Requested"
	  AgeFullyEnrolled = "Age Fully Enrolled"
	  RaceFullyEnrolled = "Race Fully Enrolled"
	  SexFullyEnrolled = "Sex Fully Enrolled" 
	  AgeVerified = "Age X Verified"
	  RaceVerified = "Race X Verified"
	  SexVerified = "Sex X Verified"
	  SexVerifiedHFHS = "Sex X Verified";
FORMAT SignInNoConsent SignInNoConsFmt. ConsentNoUP ConsentNoUPFmt. SubmitUPNoVerif SubUPNoVerFmt. 
OptOutNoSignIn OptOutNoSignFmt. OptOutSignInNoCons OptOutSignNoConFmt. BOHVerified BOHFmt. MREVerified MREFmt.
SASVerified SASFmt. LAWVerified LAWFmt. BloodColVerified BloodColFmt. UrineColVerified UrineColFmt.
MouthColVerified MouthColFmt. EMRVerified EMRPushFmt. FullSSNVerified FullSSNVerFmt. PartSSNVerified PartSSNVerFmt.
NoSSNVerified NoSSNVerFmt. RefActivePartVerified RefActPartVerFmt. HIPAARevVer HIPAARevVerFmt. 
WdConsentVer WdConsentVerFmt. DestroyDataVer DestroyDataVerFmt. AgeFullyEnrolled AgeFullyEnrolledFmt. 
RaceFullyEnrolled RaceFullyEnrolledFmt. SexFullyEnrolled SexFullyEnrolledFmt. AgeVerified AgeVerifiedFmt.
RaceVerified RaceVerifiedFmt. SexVerified SexVerifiedFmt. SexVerifiedHFHS SexVerifiedHFHSFmt.;
RUN;  

*Trying Macro for Summary Stats;
%include "C:\Users\natarajanm2\Desktop\summary_stat_macro.sas"; /*SAS Macro File*/
%let yourdata=Concept_IDS; /*name of your SAS data set*/
%let output_data=summarystats; /*name of output SAS data set*/
%let formatsfolder= C:\Users\natarajanm2\Desktop\Formats; /*location of your SAS formats*/
%let yourfolder=C:\Users\natarajanm2\Desktop; /*location of your SAS data set*/
%let varlist_cat = RcrtSI_Age_v1r0 AgeVerified RcrtSI_Race_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_SHEthnicity_v1r0 RaceVerifiedSH
RcrtSI_Sex_v1r0 SexVerified RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 
RcrtV_Verification_v1r0 RcrtSI_RecruitType_v1r0 SignInNoConsent ConsentNoUP SubmitUPNoVerif OptOutNoSignIn 
OptOutSignInNoCons BOHVerified MREVerified SASVerified LAWVerified BloodColVerified UrineColVerified MouthColVerified 
EMRVerified FullSSNVerified PartSSNVerified NoSSNVerified RefActivePartVerified HIPAARevVer WdConsentVer DestroyDataVer 
AgeFullyEnrolled RaceFullyEnrolled SexFullyEnrolled; /*list of categorical variables*/
%let varlist_cont = ; /*list of continuous variables*/
%let output_order = RcrtSI_Age_v1r0 RcrtSI_Race_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_SHEthnicity_v1r0 
RcrtSI_Sex_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 
RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 HIPAARevVer WdConsentVer DestroyDataVer AgeVerified RaceVerifiedSH
SexVerified SignInNoConsent ConsentNoUP SubmitUPNoVerif OptOutNoSignIn OptOutSignInNoCons BOHVerified MREVerified 
SASVerified LAWVerified BloodColVerified UrineColVerified MouthColVerified EMRVerified FullSSNVerified 
PartSSNVerified NoSSNVerified RefActivePartVerified AgeFullyEnrolled RaceFullyEnrolled SexFullyEnrolled; /*output order of all UNIQUE variables*/
%let decimal_max=1; /*desired number of decimal points*/
%let group_by= RcrtSI_RecruitType_v1r0; /*name of stratification variable*/
%let group_by_missing=; /*whether to remove observations missing
 the stratification variable.*/

%Table_summary;

*Histogram/BarChart for Current Status in WorkFlow; 
*Create New Current Status in WorkFlow Variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SignedIn_v1r0 = 104430631 THEN WorkFlow = 1;
ELSE IF SignInNoConsent = 1 THEN WorkFlow = 2;
ELSE IF ConsentNoUP = 1 THEN WorkFlow = 3;
ELSE IF SubmitUPNoVerif = 1 THEN WorkFlow = 4;
ELSE IF RcrtV_Verification_v1r0 = 197316935 OR 219863910 OR 922622075 THEN WorkFlow = 5;
RUN;

PROC FORMAT;
VALUE WorkFlowFmt
	 1 = "Never Signed In"
	 2 = "Signed in, No Consent"
     3 = "Consented, No Profile"
     4 = "Profile, Verification Incomplete"
     5 = "Verification Complete";

DATA Work.Concept_ids;
SET Work.Concept_ids; 
FORMAT WorkFlow WorkFlowFmt.;
RUN;

*Code For Bar Chart is in Project Tree on the Left;

*Code for Stacked Bar Chart for Demographics on the Left;

*Pie Chart for Verification Status;
*Create Character Var for Verification Status;
DATA Work.Concept_ids;
SET Work.Concept_ids;
LENGTH VerStatChar $20;
IF RcrtV_Verification_v1r0 = 875007964 THEN VerStatChar = "Not Yet Verified";
ELSE IF RcrtV_Verification_v1r0 = 197316935 THEN VerStatChar = "Verified";
ELSE IF RcrtV_Verification_v1r0 = 219863910 THEN VerStatChar = "Cannot Be Verified";
ELSE IF RcrtV_Verification_v1r0 = 922622075 THEN VerStatChar = "Duplicate";
ELSE IF RcrtV_Verification_v1r0 = 160161595 THEN VerStatChar = "Outreach Timed Out";
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL VerStatChar="Verification Status";
RUN;

*Multilayer Pie Chart for Completion of Baselilne Activities Among Verified Participants; 
*Create Baseline Activities Variable;
DATA Work.Concept_ids;
SET Work.Concept_ids;
LENGTH BLActsCompl $30;
IF BOHVerified = 1 THEN BLActsCompl = 1; 
ELSE IF MREVerified = 1 THEN BLActsCompl = 2;
ELSE IF SASVerified = 1 THEN BLActsCompl = 3;
ELSE IF LAWVerified = 1 THEN BLActsCompl = 4;
ELSE IF BloodColVerified = 1 THEN BLActsCompl = 5;
ELSE IF UrineColVerified = 1 THEN BLActsCompl = 6;
ELSE IF MouthColVerified = 1 THEN BLActsCompl = 7;
ELSE IF EMRVerified = 1 THEN BLActsCompl = 8;
RUN; 

PROC FORMAT;
VALUE BLActsComplFmt
	1 = "Completed BOH And Verified"
	2 = "Completed MRE And Verified"
	3 = "Completed SAS And Verified"
	4 = "Completed LAW And Verified"
	5 = "Completed Blood Col And Verified"
	6 = "Completed Urine Col And Verified"
	7 = "Completed Mouth Col And Verified"
	8 = "Completed EMR Push And Verified";
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL BLActsCompl = "Verified and Baseline Activities Completed";
FORMAT BLActsCompl BLActsComplFmt.;
RUN;

*Stacked Bar Chart for Completion of SSN Among Verified Participants;
*NEED TO SUBSET FOR VERIFICATION STATUS = VERIFIED IN PIE CHART SEPARATELY;
*Create New SSN Variable;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LENGTH SSNPieChart $30;
IF SrvSS_SSN4d_Given_v1r0 NE 353358909 AND SrvSS_SSN_Given_v1r0 NE 353358909 THEN SSNPieChart = 1; 
ELSE IF SrvSS_SSN4d_Given_v1r0 = 353358909 THEN SSNPieChart = 2; 
ELSE IF SrvSS_SSN_Given_v1r0 = 353358909 THEN SSNPieChart = 3; 
ELSE SSNPieChart = .;
RUN; 

PROC FORMAT; 
VALUE SSNPieChartFmt 
	1 = "No SSN Given"
	2 = "Partial SSN Given"
	3 = "Full SSN Given";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL SSNPieChart = "Completion of SSN Among Verified Participants";
FORMAT SSNPieChart SSNPieChartFmt.;
RUN;

*Turning SSNPieChart into a character variable;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LENGTH SSNPieChartChar $50;
IF SSNPieChart = 1 THEN SSNPieChartChar = "No SSN Given";
ELSE IF SSNPieChart = 2 THEN SSNPieChartChar = "Partial SSN Given";
ELSE IF SSNPieChart = 3 THEN SSNPieChartChar = "Full SSN Given";
ELSE SSNPieChartChar = .;
RUN;

*Creating New Variable for SSNPieChartChar and Verified for Summary Stats Table;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LENGTH SSNPieVerified $50;
IF SSNPieChartChar = "No SSN Given" AND RcrtV_Verification_v1r0 = 197316935 THEN SSNPieVerified = "No SSN Given";
ELSE IF SSNPieChartChar = "Partial SSN Given" AND RcrtV_Verification_v1r0 = 197316935 THEN SSNPieVerified = "Partial SSN Given";
ELSE IF SSNPieChartChar = "Full SSN Given" AND RcrtV_Verification_v1r0 = 197316935 THEN SSNPieVerified = "Full SSN Given";
ELSE SSNPieVerified = "Not Verified";
RUN;
DATA Work.Concept_ids;
SET Work.Concept_ids;
LENGTH SSNPieVerified $50;
LABEL SSNPieVerified = "SSN Status and Verified";
RUN;
/*PROC PRINT DATA=Work.Concept_ids;
VAR SSNPieChartChar RcrtV_Verification_v1r0 SSNPieVerified;
RUN;*/

DATA Work.Concept_IDS;
SET Work.Concept_IDs;
LABEL SSNPieChartChar = "SSN Status";
RUN;

*Stacked Bar Chart for Breakdown of Number of Fully Enrolled Participants by Age, Sex, Race/Ethnicity on the left;

*Creating Funnel Variable for Total Recruits with New Derivations;
*Creating "Active or Passive" Variable by Combining Active and Passive;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 486306141 THEN ActivePassive = 1;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 THEN ActivePassive = 1;
ELSE ActivePassive = 0;
RUN;

*Creating Verification Complete Variable;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtV_Verification_v1r0 = 197316935 THEN VerificationCompl = 1;
ELSE IF RcrtV_Verification_v1r0 = 219863910 THEN VerificationCompl = 1;
ELSE IF RcrtV_Verification_v1r0 = 922622075 THEN VerificationCompl = 1;
ELSE VerificationCompl = 0;
RUN;

*Creating Verified only variable;
DATA Work.CONCEPT_IDS;
SET Work.CONCEPT_IDS; 
IF RcrtV_Verification_v1r0 = 197316935 Then VerifiedBin = 1;
ELSE VerifiedBin = 0;
RUN;

PROC FORMAT;
VALUE VerifiedBinFmt
	0 = "No"
	1 = "Yes";
RUN;
DATA Work.Concept_ids;
SET Work.Concept_ids;
FORMAT VerifiedBin VerifiedBinFmt.;
LABEL VerifiedBin= "Verified";
RUN;

*Creating variable to filter out Verification = Duplicate and UP Not Submitted;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtV_Verification_v1r0 = 922622075 AND RcrtUP_Submitted_v1r0 = 104430631 THEN DupUpNotSubmit = 1;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
IF ActivePassive = 1 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 104430631 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN Funnel = 1;
ELSE IF ActivePassive = 1 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN Funnel = 2;
ELSE IF ActivePassive = 1 AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 353358909 AND VerificationCompl = 0 /*AND DupUpNotSubmit NE 1*/ THEN Funnel = 3;
ELSE IF ActivePassive = 1 AND VerificationCompl = 1 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerificationCompl = 1 AND VerifiedBin = 0 /*AND DupUpNotSubmit NE 1*/ THEN Funnel = 4;
ELSE IF ActivePassive = 1 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerifiedBin = 1 /*AND DupUpNotSubmit NE 1*/ THEN Funnel = 5;
ELSE Funnel = .;
RUN;

*Format Funnel Var;
PROC FORMAT; 
VALUE FunnelFmt
	1 = "Signed In"
	2 = "Consented"
	3 = "User Profile Submitted"
	4 = "Verification Complete"
	5 = "Verified";

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL Funnel= "Cumulative Recruitment Status";
FORMAT Funnel FunnelFmt.;
RUN;

DATA Work.Test;
SET Work.Concept_ids;
KEEP RcrtSI_RecruitType_v1r0 ActivePassive RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 VerificationCompl VerifiedBin Funnel;
RUN;

****FREQUENCY COUNTS FOR FUNNEL TOTAL****;
PROC FREQ DATA= Work.Test;
TABLES Funnel;
RUN;


*Creating Funnel Variable for Active Recruits;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 104430631 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN FunnelActive = 1;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN FunnelActive = 2;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 353358909 AND VerificationCompl = 0 /*AND DupUpNotSubmit NE 1*/ THEN FunnelActive = 3;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND VerificationCompl = 1 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerificationCompl = 1 AND VerifiedBin = 0 /*AND DupUpNotSubmit NE 1*/ THEN FunnelActive = 4;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerifiedBin = 1 /*AND DupUpNotSubmit NE 1*/ THEN FunnelActive = 5;
ELSE FunnelActive = .;
RUN;

*Format Funnel Var;
PROC FORMAT; 
VALUE FunnelFmt
	1 = "Signed In"
	2 = "Consented"
	3 = "User Profile Submitted"
	4 = "Verification Complete"
	5 = "Verified";

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL FunnelActive= "Cumulative Recruitment Status";
FORMAT FunnelActive FunnelFmt.;
RUN;

DATA Work.TestActive;
SET Work.Concept_ids;
KEEP RcrtSI_RecruitType_v1r0 FunnelActive RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 VerificationCompl VerifiedBin Funnel;
RUN;

****FREQUENCY COUNTS FOR FUNNEL ACTIVE****;
PROC FREQ DATA= Work.TestActive;
TABLES FunnelActive;
RUN;

*...Or I could have just done this instead of creating a whole new variable; 
PROC FREQ DATA= Work.Concept_ids;
TABLES Funnel;
WHERE RcrtSI_RecruitType_v1r0=486306141;
RUN;

*Creating Funnel Variable for Passive Recruits;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 854703046 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 104430631 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN FunnelPassive = 1;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 AND VerificationCompl = 0 AND RcrtUP_Submitted_v1r0 = 104430631 /*AND DupUpNotSubmit NE 1*/ THEN FunnelPassive = 2;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_SignedIn_v1r0 = 353358909 and RcrtCS_Consented_v1r0 = 353358909 AND VerificationCompl = 0 /*AND DupUpNotSubmit NE 1*/ THEN FunnelPassive = 3;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 AND VerificationCompl = 1 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerificationCompl = 1 AND VerifiedBin = 0 /*AND DupUpNotSubmit NE 1*/ THEN FunnelPassive = 4;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 AND RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909 AND VerifiedBin = 1 /*AND DupUpNotSubmit NE 1*/ THEN FunnelPassive = 5;
ELSE FunnelPassive = .;
RUN;

*Format Funnel Var;
PROC FORMAT; 
VALUE FunnelFmt
	1 = "Signed In"
	2 = "Consented"
	3 = "User Profile Submitted"
	4 = "Verification Complete"
	5 = "Verified";

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL FunnelPassive= "Cumulative Recruitment Status";
FORMAT FunnelPassive FunnelFmt.;
RUN;

DATA Work.TestPassive;
SET Work.Concept_ids;
KEEP RcrtSI_RecruitType_v1r0 FunnelPassive RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 VerificationCompl VerifiedBin Funnel;
RUN;

/*PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0 DupUpNotSubmit token Funnel FunnelActive FunnelPassive;
RUN;*/

****FREQUENCY COUNTS FOR FUNNEL TOTAL****;
PROC FREQ DATA= Work.TestPassive;
TABLES FunnelPassive;
RUN;

*...Or I could have just done this instead of creating a whole new variable; 
PROC FREQ DATA= Work.Concept_ids;
TABLES Funnel;
WHERE RcrtSI_RecruitType_v1r0=854703046;
RUN;

*Creating Funnel Frequency Totals to automate funnel (ALL);
proc summary data=work.concept_ids nway completetypes;
class funnel/ preloadfmt order=data missing;
FORMAT funnel funnelfmt.;
output out=funnelfreq;
run;

PROC FREQ DATA=funnelfreq order=data;
TABLES funnel / MISSING;
WEIGHT _freq_ / zeros;
FORMAT funnel funnelfmt.;
RUN;

DATA funnelfreq;
SET funnelfreq;
Funnelsum=sum(_freq_);
IF funnel=. THEN funnelsum=.;
RUN;

proc sort data=funnelfreq;
by descending funnel;
run;
 
DATA funnelfreq;
SET funnelfreq;
retain cumulativefreq;
cumfreq+funnelsum;
*cumulativefreq=ifn(_n_=1,funnelsum,sum(cumulativefreq,funnelsum));
where funnel ne .;
RUN;

*Creating Funnel Variable with Frequency Totals to automate funnel (Active);
proc summary data=work.concept_ids nway completetypes;
class funnelactive/ preloadfmt order=data missing;
FORMAT funnelactive funnelfmt.;
output out=funnelfreqact;
run;

PROC FREQ DATA=funnelfreqact order=data;
TABLES funnelactive / MISSING;
WEIGHT _freq_ / zeros;
FORMAT funnelactive funnelfmt.;
RUN;

DATA funnelfreqact;
SET funnelfreqact;
Funnelsumact=sum(_freq_);
IF funnelactive=. THEN funnelsumact=.;
RUN;

proc sort data=funnelfreqact;
by descending funnelactive;
run;
 
DATA funnelfreqact;
SET funnelfreqact;
retain cumulativefreqact;
cumfreqact+funnelsumact;
*cumulativefreq=ifn(_n_=1,funnelsum,sum(cumulativefreq,funnelsum));
where funnelactive ne .;
RUN;

*Creating Funnel Variable with Frequency Totals to automate funnel (Passive);
proc summary data=work.concept_ids nway completetypes;
class funnelpassive/ preloadfmt order=data missing;
FORMAT funnelpassive funnelfmt.;
output out=funnelfreqpas;
run;

PROC FREQ DATA=funnelfreqpas order=data;
TABLES funnelpassive / MISSING;
WEIGHT _freq_ / zeros;
FORMAT funnelpassive funnelfmt.;
RUN;

DATA funnelfreqpas;
SET funnelfreqpas;
Funnelsumpas=sum(_freq_);
IF funnelpassive=. THEN funnelsumpas=.;
RUN;

proc sort data=funnelfreqpas;
by descending funnelpassive;
run;
 
DATA funnelfreqpas;
SET funnelfreqpas;
retain cumulativefreqpas;
cumfreqpas+funnelsumpas;
*cumulativefreq=ifn(_n_=1,funnelsum,sum(cumulativefreq,funnelsum));
where funnelpassive ne .;
RUN;

*Merging Funnel All/Active/Passive Datasets;
DATA FunnelAllCombined;
SET FunnelFreq;
SET FunnelFreqAct;
SET FunnelFreqPas;
RUN;

*CALCULATING FUNNEL PERCENTAGES;
*Percentage for all; 
data new;                                                                                                                               
 set funnelallcombined end=eof;                                                                                                              
 if eof then call symputx('val',cumfreq);                                                                                              
run;                                                                                                                                    
                                                                                                                                 
 
data new2;                                                                                                                              
 set new;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two ;                                                                                                                               
  set new2 end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2 (rename= (cumfreq=newvar)) point=pt;   
end;                                                                                             
run;                                                                                                                                    
                                                                                                                                        
data new2;                                                                                                                              
 set new;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two ;                                                                                                                               
  set new2 end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2 (rename= (cumfreq=newvar)) point=pt;   
cumf=cumfreq/newvar;
format cumf percent7.2;
percentage=strip(cumfreq)||'/'||strip(newvar)||'('||strip(put(cumf,percent7.2))||')';
  end;                                                                                                                                  
run;   
 data three;
 set two;
 cumf=cumfreq/newvar;
 format cumf percent7.3;
 percentage=strip(cumfreq)||'/'||strip(newvar)||'('||strip(put(cumf,percent7.3))||')';
 run;    


*Percentage for active;
data new_act;                                                                                                                               
 set funnelallcombined end=eof;                                                                                                              
  if eof then call symputx('val',cumfreqact);                                                                                              
run;                                                                                                                                    
 
data new2_act;                                                                                                                              
 set new_act;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two_act ;                                                                                                                               
  set new2_act end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2_act (rename= (cumfreqact=newvar)) point=pt;   
end;                                                                                              
run;                                                                                                                                    
                                                                                                                                        
data new2_act;                                                                                                                              
 set new_act;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two_act ;                                                                                                                               
  set new2_act end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2_act (rename= (cumfreqact=newvar)) point=pt;   
cumfact=cumfreqact/newvar;
format cumfact percent7.2;
percentage=strip(cumfreq)||'/'||strip(newvar)||'('||strip(put(cumfact,percent7.2))||')';
  end;                                                                                                                                  
run;   

 data three_act;
 set two_act;
 cumfact=cumfreqact/newvar;
 format cumfact percent7.3;
 percentage=strip(cumfreqact)||'/'||strip(newvar)||'('||strip(put(cumfact,percent7.3))||')';
 run;  

*Percentage for passive;
data new_pas;                                                                                                                               
 set funnelallcombined end=eof;                                                                                                              
  if eof then call symputx('val',cumfreqpas);                                                                                              
run;                                                                                                                                    
 
data new2_pas;                                                                                                                              
 set new_pas;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two_pas ;                                                                                                                               
  set new2_pas end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2_pas (rename= (cumfreqpas=newvar)) point=pt;   
end;                                                                                              
run;                                                                                                                                    
                                                                                                                                        
data new2_pas;                                                                                                                              
 set new_pas;                                                                                                                               
  if demon=. then demon=&val;                                                                                                           
run;                                                                                                                                    
                                                                                                                                        
data two_pas ;                                                                                                                               
  set new2_pas end=finished;                                                                                                                
  if not finished then do;                                                                                                              
  pt = _N_ + 1;                                                                                                                         
  set new2_pas (rename= (cumfreqpas=newvar)) point=pt;   
cumfpas=cumfreqpas/newvar;
format cumfpas percent7.2;
percentage=strip(cumfreqpas)||'/'||strip(newvar)||'('||strip(put(cumfpas,percent7.2))||')';
  end;                                                                                                                                  
run; 

data three_pas;
 set two_pas;
 cumfpas=cumfreqpas/newvar;
 format cumfpas percent7.3;
 percentage=strip(cumfreqpas)||'/'||strip(newvar)||'('||strip(put(cumfpas,percent7.3))||')';
 run;  

*Merging all funnel percent data;
*First isolating cumfreqs for all, active, passive;
Data percentall;
SET three;
KEEP cumf;
RUN;

Data percentact;
SET three_act;
KEEP cumfact;
RUN;

Data percentpas;
SET three_pas;
KEEP cumfpas;
RUN;

*Now merging with funnelallcombined;
DATA FunnelAllWithPercent;
MERGE funnelallcombined percentall percentact percentpas;
RUN;

/*Proc print data=funnelallwithpercent;
var cumf cumfact cumfpas;
run;*/



*Report for SM Dashboard Derivations;

*Verification Mode of Those Successfully Verified;
*Creating ManualOutreach Variable (Outreach is only used for manual verification);
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtV_Outreach_v1r0 = 353358909 AND RcrtV_Mannual_v1r0 = 426360242 AND RcrtV_Verification_v1r0 = 197316935
THEN ManualOutreach = 1;
ELSE ManualOutreach = 0;
RUN;

PROC FORMAT;
VALUE ManualOutreachFmt
	0 = "No"
	1 = "Yes";
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL ManualOutreach = "Manual Verification and Outreach";
FORMAT ManualOutreach ManualOutreachFmt.;
RUN;

*Automated;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtV_Automated_v1r0 = 426360242 AND RcrtV_Verification_v1r0 = 197316935 THEN Automated = 1;
ELSE Automated = 0;
RUN;

PROC FORMAT;
VALUE AutomatedFmt
	0 = "No"
	1 = "Yes";
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL Automated = "Automated Verification Mode";
FORMAT Automated AutomatedFmt.;
RUN;

*Manual;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtV_Mannual_v1r0 = 426360242 AND RcrtV_Verification_v1r0 = 197316935 THEN Manual = 1;
ELSE Manual = 0;
RUN;

PROC FORMAT;
VALUE ManualFmt
	0 = "No"
	1 = "Yes";
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LABEL Manual = "Manual Verification Mode";
FORMAT Manual ManualFmt.;
RUN;

*Macro for Verification Mode of Those Successfully Verified In "1 PAGE FOR ALL REPORT DERIVATIONS" tab on left;

*Proc Freq Table for # Verified to go under "Mode of Those Successfully Verified" Table;
PROC FREQ DATA=Work.Concept_ids;
TABLE RcrtV_Verification_v1r0 /out=VerifiedTotal;
WHERE RcrtV_Verification_v1r0 = 197316935;
RUN;

*Proc Freq Table for # Verified to go under "Mode of Those Successfully Verified" Table- Limiting to Only
Active and Passive;
PROC FREQ DATA=Work.Concept_ids;
TABLE RcrtV_Verification_v1r0 /out=VerifiedTotal2;
WHERE RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

*Reason: Cannot be Verified (Table Formatted Into Monthly Report Based on this Proc Freq;
PROC FREQ DATA= Work.Concept_ids;
TABLES RcrtV_Verification_v1r0 /out=cannotbeverified;
WHERE RcrtV_Verification_v1r0 = 219863910;
BY RcrtSI_RecruitType_v1r0;
Title 'Cannot Be Verified';
RUN;

*Self Reported Cancer History (Table Formatted Into Monthly Report Based on this Proc Freq);
PROC FREQ DATA=Work.Concept_ids;
TABLES RcrtUP_Cancer_v1r0 /out=cancerhistory;
WHERE RcrtUP_Cancer_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
Title 'Self-Reported Cancer History';
RUN;

*Opt-Out Totals (Yes/No)- Frequency Table;
PROC FREQ DATA=Work.Concept_ids;
TABLE RcrtSI_OptOut_v1r0 /out=OptOutFreqTable;
RUN;

*Reasons for Pre-Consent Opt-Out;
PROC FREQ DATA=Work.CONCEPT_IDS;
TABLES RcrtSI_OptOut_v1r0_inter RcrtSI_OptOut_v1r0_busy RcrtSI_OptOut_v1r0_priv RcrtSI_OptOut_v1r0_contacts
RcrtSI_OptOut_v1r0_able RcrtSI_OptOut_v1r0_other RcrtSI_OptOut_v1r0_impt
RcrtSI_OptOut_v1r0_partic RcrtSI_OptOut_v1r0_term RcrtSI_OptOut_v1r0_time RcrtSI_OptOut_v1r0_samples
RcrtSI_OptOut_v1r0_comp RcrtSI_OptOut_v1r0_eligible RcrtSI_OptOut_v1r0_GenTest RcrtSI_OptOut_v1r0_health
RcrtSI_OptOut_v1r0_access RcrtSI_OptOut_v1r0_online RcrtSI_OptOut_v1r0_concern RcrtSI_OptOut_v1r0_PrivacyA
RcrtSI_OptOut_v1r0_PrivacyB RcrtSI_OptOut_v1r0_PrivacyC RcrtSI_OptOut_v1r0_PrivacyD RcrtSI_OptOut_v1r0_PrivacyE
RcrtSI_OptOut_v1r0_PrivacyF RcrtSI_OptOut_v1r0_PrivacyG RcrtSI_OptOut_v1r0_PrivacyH RcrtSI_OptOut_v1r0_PrivacyI
RcrtSI_OptOut_v1r0_PrivacyJ RcrtSI_OptOut_v1r0_PrivacyK RcrtSI_OptOut_v1r0_PrivacyL RcrtSI_OptOut_v1r0_Covid
RcrtSI_OptOut_v1r0_MyChart RcrtSI_OptOut_v1r0_unable RcrtSI_OptOut_v1r0_none;
WHERE RcrtSI_RecruitType_v1r0= 486306141;
RUN;

*Macro for Pre-Consent Opt-Out reasons on left (puts it in a combined table), as well as
Table for Reasons for Pre-Consent Opt-Out AMONG Those Opted Out;
*Code for Pre-Consent Opt Out Reasons only for those that have opted out;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtSI_OptOut_v1r0_inter = 353358909 THEN OptOutReason = 1;
ELSE IF RcrtSI_OptOut_v1r0_busy = 353358909 THEN OptOutReason = 2;
ELSE IF RcrtSI_OptOut_v1r0_priv = 353358909 THEN OptOutReason = 3;
ELSE IF RcrtSI_OptOut_v1r0_contacts = 353358909 THEN OptOutReason = 4;
ELSE IF RcrtSI_OptOut_v1r0_able = 353358909 THEN OptOutReason = 5;
ELSE IF RcrtSI_OptOut_v1r0_other = 353358909 THEN OptOutReason = 6;
ELSE IF RcrtSI_OptOut_v1r0_impt = 353358909 THEN OptOutReason = 7;
ELSE IF RcrtSI_OptOut_v1r0_partic = 353358909 THEN OptOutReason = 8;
ELSE IF RcrtSI_OptOut_v1r0_term = 353358909 THEN OptOutReason = 9;
ELSE IF RcrtSI_OptOut_v1r0_time = 353358909 THEN OptOutReason = 10;
ELSE IF RcrtSI_OptOut_v1r0_samples = 353358909 THEN OptOutReason = 11;
ELSE IF RcrtSI_OptOut_v1r0_comp = 353358909 THEN OptOutReason = 12;
ELSE IF RcrtSI_OptOut_v1r0_eligible = 353358909 THEN OptOutReason = 13;
ELSE IF RcrtSI_OptOut_v1r0_GenTest = 353358909 THEN OptOutReason = 14;
ELSE IF RcrtSI_OptOut_v1r0_health = 353358909 THEN OptOutReason = 15;
ELSE IF RcrtSI_OptOut_v1r0_access = 353358909 THEN OptOutReason = 16;
ELSE IF RcrtSI_OptOut_v1r0_online = 353358909 THEN OptOutReason = 17;
ELSE IF RcrtSI_OptOut_v1r0_concern = 353358909 THEN OptOutReason = 18;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyA = 353358909 THEN OptOutReason = 19;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyB = 353358909 THEN OptOutReason = 20;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyC = 353358909 THEN OptOutReason = 21;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyD = 353358909 THEN OptOutReason = 22;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyE = 353358909 THEN OptOutReason = 23;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyF = 353358909 THEN OptOutReason = 24;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyG = 353358909 THEN OptOutReason = 25;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyH = 353358909 THEN OptOutReason = 26;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyI = 353358909 THEN OptOutReason = 27;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyJ = 353358909 THEN OptOutReason = 28;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyK = 353358909 THEN OptOutReason = 29;
ELSE IF RcrtSI_OptOut_v1r0_PrivacyL = 353358909 THEN OptOutReason = 30;
ELSE IF RcrtSI_OptOut_v1r0_Covid = 353358909 THEN OptOutReason = 31;
ELSE IF RcrtSI_OptOut_v1r0_MyChart = 353358909 THEN OptOutReason = 32;
ELSE IF RcrtSI_OptOut_v1r0_unable = 353358909 THEN OptOutReason = 33;
ELSE IF RcrtSI_OptOut_v1r0_none = 353358909 THEN OptOutReason = 34;
RUN;

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF OptOutReason=. THEN OptOutReason = 0;

PROC FORMAT;
VALUE OptOutReasonFmt
	0 = "No reason sent"
	1 = "I am not interested"
	2 = "I am too busy to join"
	3 = "I am concerned about my privacy"
	4 = "I have received too many contacts from the study"
	5 = "I am not able to complete the study activities online"
	6 = "I do not want to join the study for other reasons"
	7 = "I do not think the research topic is important/I am not interested in the topic"
	8 = "I do not want to participate in research"
	9 = "I do not want to be in a long-term study"
	10 = "I think the study takes too much time/asks for too much"
	11 = "I do not want to give biological samples"
	12 = "I think the payment or benefit to participate is not great enough"
	13 = "I do not think I am eligible"
	14 = "I am opposed to genetic testing"
	15 = "I am too sick/my health is too poor to join"
	16 = "I do not have reliable access to the internet/a device"
	17 = "I do not like to do things online"
	18 = "I am worried the study might find out something concerning about me"
	19 = "I do not want to provide information online"
	20 = "I do not want to complete surveys"
	21 = "I do not want to provide access to medical history information or diagnoses"
	22 = "I do not trust the government"
	23 = "I do not trust research/researchers"
	24 = "I do not want my informtion shared with other researchers"
	25 = "I am worried my information will not be secure or there will be a data breach"
	26 = "I am worried about data being given to my insurance company/effects on insurance (health, life, other)"
	27 = "I am worried about data being given to my employer/potential employer"
	28 = "I am worried that my information could be used to discriminate against me/my family"
	29 = "I am worried that my information will be used by others to make a profit"
	30 = "I have other privacy concerns"
	31 = "I am concerned about COVID-19"
	32 = "Refused MyChart Invitation"
	33 = "Person is unable to participate or deceased"
	34 = "Reason not given";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL OptOutReason= "Opt-Out Reason"; *"Reason for Pre-Consent Opt-Out Among Those that Opted Out";
FORMAT OptOutReason OptOutReasonFmt.;
RUN;

PROC FREQ DATA= Work.CONCEPT_IDS;
TABLE OptOutReason /out=OptOutReason;
WHERE RcrtSI_OptOut_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 = 486306141;
RUN;

PROC FREQ DATA=Work.CONCEPT_IDS;
TABLE RcrtSI_OptOut_v1r0 /out=optouttotal;
RUN;

*Recruitment Success by Campaign;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 926338735 THEN ActVerCamp = 0;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 348281054 THEN ActVerCamp = 1;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 324692899 THEN ActVerCamp = 2;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 351257378 THEN ActVerCamp = 3;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 647148178 THEN ActVerCamp = 4;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 834544960 THEN ActVerCamp = 5;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 682916147 THEN ActVerCamp = 6;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 153365143 THEN ActVerCamp = 7;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 663706936 THEN ActVerCamp = 8;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 181769837 THEN ActVerCamp = 9;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 438483626 THEN ActVerCamp = 9;
ELSE IF RcrtV_Verification_v1r0 = 197316935 AND RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 398561594 THEN ActVerCamp = 10;
RUN;
PROC FORMAT;
	VALUE ActVerCampFmt
			0 = "Random"
			1 = "Screening appointment"
			2 = "Non-screening appointment"
			3 = "Demographic Group"
			4 = "Aging out of study"
			5 = "Geographic group"
			6 = "Post-screening appointment"
			7 = "Technology adapters"
			8 = "Low-income/health professional shortage areas"
			9 = "Other"
			10 = "None of the above";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL ActVerCamp = "Active, Verified, Campaign Type";
FORMAT ActVerCamp ActVerCampFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR ActVerCamp RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0 RcrtSI_CampaignType_v1r0;
RUN;*/

proc summary data=work.concept_ids nway completetypes;
class ActVerCamp / preloadfmt order=data missing;
FORMAT ActVerCamp ActVerCampFmt.;
output out=CampaignSuccess;
run;

PROC FREQ DATA=CampaignSuccess order=data;
TABLES ActVerCamp / MISSING;
WEIGHT _freq_ / zeros;
FORMAT ActVerCamp ActVerCampFmt.;
RUN;

*Creating distinct freq var;
DATA CampaignSuccess;
SET CampaignSuccess;
FreqNumerator = _FREQ_;
RUN;

*Creating Denominator for Campaign Success;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 926338735 THEN CampDenom = 0;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 348281054 THEN CampDenom = 1;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 324692899 THEN CampDenom = 2;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 351257378 THEN CampDenom = 3;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 647148178 THEN CampDenom = 4;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 834544960 THEN CampDenom = 5;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 682916147 THEN CampDenom = 6;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 153365143 THEN CampDenom = 7;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 663706936 THEN CampDenom = 8;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 181769837 THEN CampDenom = 9;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 438483626 THEN CampDenom = 9;
ELSE IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_CampaignType_v1r0 = 398561594 THEN CampDenom = 10;
RUN;
PROC FORMAT;
	VALUE CampDenomFmt
			0 = "Random"
			1 = "Screening appointment"
			2 = "Non-screening appointment"
			3 = "Demographic Group"
			4 = "Aging out of study"
			5 = "Geographic group"
			6 = "Post-screening appointment"
			7 = "Technology adapters"
			8 = "Low-income/health professional shortage areas"
			9 = "Other"
			10 = "None of the above";
DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL CampDenom = "Campaign Success Denominator For Calculation";
FORMAT CampDenom CampDenomFmt.;
RUN;

/*PROC PRINT DATA= Work.Concept_ids;
VAR CampDenom RcrtSI_RecruitType_v1r0 RcrtSI_CampaignType_v1r0;
RUN;*/

proc summary data=work.concept_ids nway completetypes;
class CampDenom / preloadfmt order=data missing;
FORMAT CampDenom CampDenomFmt.;
output out=CampaignDenominator;
run;

PROC FREQ DATA=CampaignDenominator order=data;
TABLES CampDenom / MISSING;
WEIGHT _freq_ / zeros;
FORMAT CampDenom CampDenomFmt.;
RUN;

*Creating distinct freq var;
DATA CampaignDenominator;
SET CampaignDenominator;
FreqDenominator = _FREQ_;
RUN;

*Merging Campaign Success Datasets for Calculation;
DATA CampaignCalculation;
SET CampaignSuccess;
SET CampaignDenominator;
RUN;

DATA CampaignCalculation;
SET CampaignCalculation;
DROP _FREQ_;
Percent = FreqNumerator/FreqDenominator;
RUN;

*Outputting Campaign Calculation Results;
*ods pdf file= 'C:\Users\natarajanm2\Desktop\CampaignCalc.pdf' startpage=never;
/*PROC PRINT DATA= CampaignCalculation label;
VAR ActVerCamp FreqNumerator CampDenom FreqDenominator Percent;
RUN;*/
*ods pdf close;




*Time to Completion of Enrollment;
*Time from active recruitment began to sign in;
DATA Work.Concept_ids;
SET Work.Concept_ids; 
TmFrmActRecToSignIn = RcrtSI_SignTime_v1r0 - RcrtSI_TypeTime_v1r0;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 NE 486306141 THEN TmFrmActRecToSignIn = .;
RUN;

*Time from sign in to consent; 
	*variable for this is created (RcrtCT_Acct_Cnst_v1r0) but is not derived in the dictionary;

*Time from consent to user profile submission; 
	*variable for this is created (RcrtCT_Cnst_UP_v1r0) but is not derived in the dictionary;

*Time from user profile submission to verification; 
DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerif = RcrtV_VerificationTm_V1R0 - RcrtUP_SubmitTime_v1r0;
RUN;

*Total enrollment time (sum of the above times) Calculated Below at the end;

*Time from Active Recruitment Began to Sign In (limit to those who signed in);
/*PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_SignTime_v1r0 RcrtSI_TypeTime_v1r0 TmFrmActRecToSignIn RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0;
WHERE RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids; 
ActRecToSignInDays = TmFrmActRecToSignIn/86400;
RUN;

*Format for days and hours;
proc format;
picture mytime (default=50)
other='%n days and %H hours' (datatype=time);
run;
*Format for days, hours, minutes, and seconds;
proc format;
picture mytimemin (default=50)
other='%n days and %H hours and %M minutes and %S seconds' (datatype=time);
run;


PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInD;
VAR ActRecToSignInDays;
LABEL ActRecToSignInDays = "Time from Active Recruitment Began to Sign In (Days)";
TABLE ActRecToSignInDays*(Q1 Median Q3);
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInDH;
VAR TmFrmActRecToSignIn;
LABEL TmFrmActRecToSignIn = "Time from Active Recruitment Began to Sign In (Days and Hours)";
TABLE TmFrmActRecToSignIn*(Q1 Median Q3);
FORMAT TmFrmActRecToSignIn mytime.;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

/*PROC PRINT DATA=RecruitmentToSignInDH;
VAR TmFrmActRecToSignIn_Q1 TmFrmActRecToSignIn_Median TmFrmActRecToSignIn_Q3;
FORMAT TmFrmActRecToSignIn_Q1 mytime. TmFrmActRecToSignIn_Median mytime. TmFrmActRecToSignIn_Q3 mytime.;
RUN;*/

PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInMin;
VAR TmFrmActRecToSignIn;
LABEL TmFrmActRecToSignIn = "Time from Active Recruitment Began to Sign In (Formatted)";
TABLE TmFrmActRecToSignIn*(Q1 Median Q3);
FORMAT TmFrmActRecToSignIn mytimemin.;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

/*PROC PRINT DATA=Work.CONCEPT_IDS;
VAR ActRecToSignInDays TmFrmActRecToSignIn;
FORMAT TmFrmActRecToSignIn mytime.;
RUN;*/


*Time from sign in to consent (limit to those who consented);
DATA Work.Concept_ids;
SET Work.Concept_ids;
SignInToConsent = RcrtCS_ConsentSumit_v1r0 - RcrtSI_SignTime_v1r0;
RUN;

/*PROC PRINT DATA=Work.Concept_ids; 
VAR RcrtCS_ConsentSumit_v1r0 RcrtSI_SignTime_v1r0 SignInToConsent RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;*/

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
SignInToConsentDays = SignInToConsent/86400;
RUN;

/*PROC PRINT DATA= Work.CONCEPT_IDS;
VAR SignInToConsent SignInToConsentDays;
RUN;*/

PROC TABULATE DATA=Work.concept_ids out=SignInToConsentD;
VAR SignInToConsentDays;
LABEL SignInToConsentDays = "Time from Sign-In To Consent (Days)";
TABLE SignInToConsentDays*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

PROC TABULATE DATA=WOrk.CONCEPT_IDS out=SignInToConsentDH;
VAR SignInToConsent;
LABEL SignInToConsent = "Time From Sign-In To Consent (Days and Hours)";
FORMAT SignInToConsent mytime.;
TABLE SignInToConsent*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

/*PROC PRINT DATA=SignInToConsentDH;
VAR RcrtSI_RecruitType_v1r0 SignInToConsent_Q1 SignInToConsent_Median SignInToConsent_Q3;
FORMAT SignInToConsent_Q1 mytime. SignInToConsent_Median mytime. SignInToConsent_Q3 mytime.;
RUN;*/

PROC TABULATE DATA=Work.CONCEPT_IDS out=SignInToConsentMin;
VAR SignInToConsent;
LABEL SignInToConsent = "Time From Sign-In To Consent (Formatted)";
FORMAT SignInToConsent mytimemin.;
TABLE SignInToConsent*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

/*PROC PRINT DATA=SignInToConsentMin;
VAR RcrtSI_RecruitType_v1r0 SignInToConsent_Q1 SignInToConsent_Median SignInToConsent_Q3;
FORMAT SignInToConsent_Q1 mytimemin. SignInToConsent_Median mytimemin. SignInToConsent_Q3 mytimemin.;
RUN;*/


*Time from consent to user profile submission (limit to those who completed UP);
DATA Work.Concept_ids;
SET Work.Concept_ids;
ConsentToUP = RcrtUP_SubmitTime_v1r0 - RcrtCS_ConsentSumit_v1r0;
RUN;

/*PROC PRINT DATA=Work.Concept_ids; 
VAR ConsentToUP RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids;
ConsentToUpDays = ConsentToUp/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPD;
VAR ConsentToUpDays;
LABEL RcrtCT_Cnst_UP_v1r0 = "Time from Consent to UP Submission (Days)";
TABLE ConsentToUpDays*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPDH;
VAR ConsentToUp;
LABEL ConsentToUp = "Time from Consent to UP Submission (Days and Hours)";
FORMAT ConsentToUP mytime.;
TABLE ConsentToUp*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPMin;
VAR ConsentToUp;
LABEL ConsentToUp = "Time from Consent to UP Submission (Formatted)";
FORMAT ConsentToUP mytimemin.;
TABLE ConsentToUp*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

/*PROC PRINT DATA=ConsentTOUPD;
VAR ConsentToUPDays_Q1 ConsentToUPDays_MEDIAN ConsentToUPDays_Q3;
RUN;*/

/*PROC PRINT DATA=ConsentTOUPDH;
VAR ConsentTOUP_Q1 ConsentToUP_MEDIAN ConsentToUP_Q3;
FORMAT ConsentTOUP_Q1 mytime. ConsentToUP_MEDIAN mytime. ConsentToUP_Q3 mytime.;
RUN; */

/*PROC PRINT DATA=ConsentTOUPMin;
VAR ConsentTOUP_Q1 ConsentToUP_MEDIAN ConsentToUP_Q3;
FORMAT ConsentTOUP_Q1 mytimemin. ConsentToUP_MEDIAN mytimemin. ConsentToUP_Q3 mytimemin.;
RUN;*/

*Time from user profile submission to verification (limit to those with verification complete, 
regardless of outcome);
DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerif = RcrtV_VerificationTm_V1R0 - RcrtUP_SubmitTime_v1r0;
RUN;

/*PROC PRINT DATA=Work.Concept_ids; 
VAR UPToVerif RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 verifcompl;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933 AND verifcompl=1;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerifDays = UPToVerif/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifD;
VAR UPToVerifDays;
LABEL UPToVerifDays = "Time from UP to Verification (Days)";
TABLE UPToVerifDays*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifDH;
VAR UPToVerif;
LABEL UPToVerif = "Time from UP To Verification (Days and Hours)";
FORMAT UPToVerif mytime.;
TABLE UPToVerif*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifMin;
VAR UPToVerif;
LABEL UPToVerif = "Time from UP To Verification (Formatted)";
FORMAT UPToVerif mytimemin.;
TABLE UPToVerif*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

/*PROC PRINT DATA=UPToVerifD;
VAR UPToVerifDays_Q1 UPToVerifDays_MEDIAN UPToVerifDays_Q3;
RUN;*/

/*PROC PRINT DATA=UPToVerifDH;
VAR UpToVerif_Q1 UpToVerif_MEDIAN UpToVerif_Q3;
FORMAT UpToVerif_Q1 mytime. UpToVerif_MEDIAN mytime. UpToVerif_Q3 mytime.;
RUN;*/

/*PROC PRINT DATA=UpToVerifMin;
VAR UpToVerif_Q1 UpToVerif_MEDIAN UpToVerif_Q3;
FORMAT UpToVerif_Q1 mytimemin. UpToVerif_MEDIAN mytimemin. UpToVerif_Q3 mytimemin.;
RUN;*/ 


*Total Enrollment Time (Sum of the above times);
DATA Work.Concept_ids;
SET Work.Concept_ids;
TotalEnrollmentTime = SUM(TmFrmActRecToSignIn, SignInToConsent, ConsentToUP, UPToVerif);
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL TmFrmActRecToSignIn = "Time from Active recruitment began to sign in"
	  SignInToConsent = "Time from User Profile submission to Verification"
	  ConsentToUP = "Time from Consented to Submission of UP"
	  UPToVerif = "Time from Submission of UP to Verification"
	  TotalEnrollmentTime = "Total Enrollment Time";
RUN;

/*PROC PRINT DATA=Work.Concept_ids;
VAR TotalEnrollmentTime TmFrmActRecToSignIn SignInToConsent ConsentToUP UPToVerif;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933 AND verifcompl=1;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids;
TotalEnrollmentDays = TotalEnrollmentTime/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentD;
VAR TotalEnrollmentDays;
LABEL TotalEnrollmentDays = "Total Enrollment Time (Days)";
TABLE TotalEnrollmentDays*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentDH;
VAR TotalEnrollmentTime;
LABEL TotalEnrollmentTime = "Total Enrollment Time (Days and Hours)";
FORMAT TotalEnrollmentTime mytime.;
TABLE TotalEnrollmentTime*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentMin;
VAR TotalEnrollmentTime;
LABEL TotalEnrollmentTime = "Total Enrollment Time (Formatted)";
FORMAT TotalEnrollmentTime mytimemin.;
TABLE TotalEnrollmentTime*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

/*PROC PRINT DATA=TotalEnrollmentD;
VAR TotalEnrollmentDays_Q1 TotalEnrollmentDays_MEDIAN TotalEnrollmentDays_Q3;
RUN;*/

/*PROC PRINT DATA=TotalEnrollmentDH;
VAR TotalEnrollmentTime_Q1 TotalEnrollmentTime_MEDIAN TotalEnrollmentTime_Q3;
FORMAT TotalEnrollmentTime_Q1 mytime. TotalEnrollmentTime_MEDIAN mytime. TotalEnrollmentTime_Q3 mytime.;
RUN;*/ 

/*PROC PRINT DATA=TotalEnrollmentMin;
VAR TotalEnrollmentTime_Q1 TotalEnrollmentTime_MEDIAN TotalEnrollmentTime_Q3;
FORMAT TotalEnrollmentTime_Q1 mytimemin. TotalEnrollmentTime_MEDIAN mytimemin. TotalEnrollmentTime_Q3 mytimemin.;
RUN;*/


*Sign In Mechanism Used for First Log On; 
*ods pdf file= 'C:\Users\natarajanm2\Desktop\SignInMech.pdf' startpage=never;
PROC FREQ DATA= Work.Concept_ids;
TABLES RcrtPC_Acnt_SignIn_v1r0 /out=AcntSignIn;
WHERE RcrtSI_RecruitType_v1r0 = 486306141 OR RcrtSI_RecruitType_v1r0 = 854703046; 
RUN;
*ods pdf close;

*How Participant Heard About the Study;
PROC FREQ DATA= Work.Concept_ids;
TABLES RcrtES_Aware_v1r0_Email RcrtES_Aware_v1r0_Mail  RcrtES_Aware_v1r0_Invite RcrtES_Aware_v1r0_Phone 
RcrtES_Aware_v1r0_Phys RcrtES_Aware_v1r0_Staff RcrtES_Aware_v1r0_News RcrtES_Aware_v1r0_HCNews
RcrtES_Aware_v1r0_HCSite RcrtES_Aware_v1r0_Web RcrtES_Aware_v1r0_Social RcrtES_Aware_v1r0_TV RcrtES_Aware_v1r0_Video 
RcrtES_Aware_v1r0_Family RcrtES_Aware_v1r0_Member RcrtES_Aware_v1r0_Poster RcrtES_Aware_v1r0_Table
RcrtES_Aware_v1r0_Hold RcrtES_Aware_v1r0_Other;
RUN; 

*Create new variable (similar to pre-consent opt out reasons) to get counts in descending order
for How Participant Heard About Study;
********THIS DOES NOT ALLOW FOR SELECTING MULTIPLE REASONS AT A TIME********;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
LENGTH HearAbtStudy $100;
IF RcrtES_Aware_v1r0_Email = 353358909 THEN HearAbtStudy = "Email or text invitation";
ELSE IF RcrtES_Aware_v1r0_Mail = 353358909 THEN HearAbtStudy = "Letter or brochure in mail";
ELSE IF RcrtES_Aware_v1r0_Invite = 353358909 THEN HearAbtStudy= "Invitation through my patient portal (such as MyChart)";
ELSE IF RcrtES_Aware_v1r0_Phone = 353358909 THEN HearAbtStudy = "Phone call invitation";
ELSE IF RcrtES_Aware_v1r0_Phys = 353358909 THEN HearAbtStudy = "Physician or other health care staff";
ELSE IF RcrtES_Aware_v1r0_Staff = 353358909 THEN HearAbtStudy = "Connect research staff at my health care system";
ELSE IF RcrtES_Aware_v1r0_News = 353358909 THEN HearAbtStudy = "News article or press release about Connect";
ELSE IF RcrtES_Aware_v1r0_HCNews = 353358909 THEN HearAbtStudy = "Health care system newsletter";
ELSE IF RcrtES_Aware_v1r0_HCSite = 353358909 THEN HearAbtStudy = "Health care system website";
ELSE IF RcrtES_Aware_v1r0_Web = 353358909 THEN HearAbtStudy = "Connect website on Cancer.gov";
ELSE IF RcrtES_Aware_v1r0_Social = 353358909 THEN HearAbtStudy = "Social media post (on Facebook, Twitter, Instagram, or other channels";
ELSE IF RcrtES_Aware_v1r0_TV = 353358909 THEN HearAbtStudy = "Local news, television, or radio station";
ELSE IF RcrtES_Aware_v1r0_Video = 353358909 THEN HearAbtStudy = "Video";
ELSE IF RcrtES_Aware_v1r0_Family = 353358909 THEN HearAbtStudy = "Family or Friend";
ELSE IF RcrtES_Aware_v1r0_Member = 353358909 THEN HearAbtStudy = "Another Connect participant";
ELSE IF RcrtES_Aware_v1r0_Poster = 353358909 THEN HearAbtStudy = "Poster, flyer, or sign at my health care system";
ELSE IF RcrtES_Aware_v1r0_Table = 353358909 THEN HearAbtStudy = "Connect table at public event";
ELSE IF RcrtES_Aware_v1r0_Hold = 353358909 THEN HearAbtStudy = "Recoded message";
ELSE IF RcrtES_Aware_v1r0_Other = 353358909 THEN HearAbtStudy = "Other";
ELSE HearAbtStudy = "No response sent";
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL HearAbtStudy = "How Participant Heard About Study";
RUN;

PROC FREQ DATA= Work.CONCEPT_IDS;
TABLE HearAbtStudy /out=HearAbtStudyTable;
RUN;

*Macro for How Participant Heard About Study on left (puts it in a combined table);

/*Proc prints for Nicole
PROC PRINT DATA=WORK.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 SrvSS_SSN_Given_v1r0 SrvSS_SSN4d_Given_v1r0 RcrtV_Verification_v1r0 SSNPieChart;
RUN;

PROC PRINT DATA= Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0 ComplIntlSrv SrvBOH_BaseStatus_v1r0 SrvMRE_BaseStatus_v1r0 SrvSAS_BaseStatus_v1r0 SrvLAW_BaseStatus_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 DupUpNotSubmit token Funnel FunnelActive FunnelPassive;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR ComplIntlSrv RcrtV_Verification_v1r0 ComplIntlSrvVer;
RUN;*/

*Creating Active+Duplicate and Passive+Duplicate for calculations;
DATA Work.Concept_ids; 
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtV_Verification_v1r0 = 922622075 THEN ActiveDuplicate = 1;
IF RcrtSI_RecruitType_v1r0 = 854703046 AND RcrtV_Verification_v1r0 = 922622075 THEN PassiveDuplicate = 1;
RUN; 

PROC FREQ DATA=Work.CONCEPT_IDS;
TABLE RcrtSI_RecruitType_v1r0 /out=ActivePassiveDup;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

DATA ActivePassiveDup;
SET ActivePassiveDup;
RecruitCount=Count;
RUN; 

PROC FREQ DATA=Work.CONCEPT_IDS;
TABLE ActiveDuplicate/out=ActiveDup;
RUN;

DATA ActiveDup;
SET ActiveDup;
ActiveDup=Count;
RUN;

PROC FREQ DATA=Work.CONCEPT_IDS;
TABLE PassiveDuplicate /out=PassiveDup;
RUN;

DATA PassiveDup;
SET PassiveDup;
PassiveDup=Count;
RUN;

*Merging Active/Passive/Duplicate;
proc sql;
create table ActivePassiveDupComb as
select * from ActivePassiveDup,ActiveDup,PassiveDup;
quit;

DATA ActivePassiveDupComb;
SET ActivePassiveDupComb; 
IF RcrtSI_RecruitType_v1r0 = 486306141 Then RecruitType = 1;
ELSE IF RcrtSI_RecruitType_v1r0 = 854703046 Then RecruitType = 2;
RUN; 

DATA TrueActive;
SET ActivePassiveDupComb;
IF ActiveDuplicate = . THEN TrueActive=RecruitCount;
WHERE RecruitType = 1; 
RUN; 
DATA TrueActive;
SET TrueActive;
TrueActive = RecruitCount-ActiveDup;
WHERE RecruitType = 1 AND ActiveDuplicate = 1;
RUN; 

DATA TrueActive;
SET TrueActive;
LABEL RcrtSI_RecruitType_v1r0 = "Recruit Type"
	  RecruitCount= "Recruit Count"
	  ActiveDup = "Active+Duplicate"
	  TrueActive= "True Active Recruit";
RUN;

DATA TruePassive;
SET ActivePassiveDupComb;
IF PassiveDuplicate = . THEN TruePassive=RecruitCount;
WHERE RecruitType = 2; 
RUN; 
DATA TruePassive;
SET TruePassive;
TruePassive = RecruitCount-PassiveDup;
WHERE RecruitType = 2 AND PassiveDuplicate = 1; 
RUN; 
DATA TruePassive;
SET TruePassive;
LABEL RcrtSI_RecruitType_v1r0 = "Recruit Type"
	  RecruitCount= "Recruit Count"
	  PassiveDup = "Passive+Duplicate"
	  TruePassive= "True Passive Recruit";
RUN;

*Tables for Active/Passive + Duplicate Calculations to add to Metrics;
/*PROC PRINT DATA=TrueActive; 
VAR RcrtSI_RecruitType_v1r0 RecruitCount ActiveDup TrueActive;
RUN;*/

/*PROC PRINT DATA=TruePassive; 
VAR RcrtSI_RecruitType_v1r0 RecruitCount PassiveDup TruePassive;
RUN;*/
*Because there are no PassiveDup data as of now for HP; 
/*PROC PRINT DATA=ActivePassiveDupComb; 
VAR RcrtSI_RecruitType_v1r0 RecruitCount PassiveDuplicate;
WHERE RecruitType = 2 AND ActiveDuplicate = .;
RUN;*/ 

*Creating Type of Refusal/Withdrawal Variable;
PROC FORMAT;
VALUE $TypeRefWdFmt
      '1' = "Refused Baseline Surveys"
      '2' = "Refused Baseline Blood Sample"
      '3' = "Refused Baseline Urine Sample"
      '4' = "Refused Baseline Saliva Sample"
      '5' = "Refused All Future Surveys"
      '6' = "Refused All Future Samples"
      '7' = "Refused Baseline Specimen Surveys"
      '8' = "Wants Data Destroyed"
      '9' = "Revoke HIPAA"
	  '10' = "Withdrew Consent"
	  '11' = "Refused All Future Activities"
	  '12' = "Deceased";
run;
 
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF HdRef_Basesrv_v1r0 = 353358909 THEN do;
type1='1';
date1=put(HdRef_DateBasesrv_v1r0,DATETIME.);
/*date1=HdRef_DateBasesrv_v1r0;*/
end;
IF HdRef_Baseblood_v1r0 = 353358909 THEN do;
type2='2'; 
 date2=put(HdRef_DateBaseblood_v1r0,DATETIME.);
 /*date2=HdRef_DateBaseblood_v1r0;*/
end;
IF HdRef_Baseurine_v1r0 = 353358909 THEN do;
type3='3'; 
 date3=put(HdRef_DateBaseurine_v1r0,DATETIME.);
end;
IF HdRef_Basesaliva_v1r0 = 353358909 THEN do;
type4='4'; 
 date4=put(HdRef_DateBasesaliva_v1r0,DATETIME.);
end;
IF HdRef_Allsrv_v1r0 = 353358909 THEN do;
type5='5'; 
 date5=put(HdRef_DateAllsrv_v1r0,DATETIME.);
end;
IF HdRef_Allsample_v1r0 = 353358909 THEN do;
type6='6'; 
 date6=put(HdRef_DateAllsample_v1r0,DATETIME.);
/*date6=HdRef_DateAllsample_v1r0;*/
end;
IF HdRef_BlSpecSrv_v1r0 = 353358909 THEN do;
type7='7'; 
 date7=put(hdref_blspecsrvdt_v1r0,DATETIME.);
end;
IF HdWd_Destroydata_v1r0 = 353358909 THEN do;
type8='8'; 
 date8=put(hdref_datedatadestroy_v1r0,DATETIME.);
end;
IF HdWd_HIPAArevoked_v1r0 = 353358909 THEN do;
type9='9'; 
 date9=put(hdref_datehipaarevoked_v1r0,DATETIME.);
end;
IF HdWd_WdConsent_v1r0 = 353358909 THEN do;
type10='10'; 
 date10=put(HdWd_WdConsentDt_v1r0,DATETIME.);
end;
IF HdWd_Activepart_v1r0 = 353358909 THEN do;
type11='11'; 
date11=put(HdWd_DateActivepart_v1r0,DATETIME.);
end;
IF HdWd_Deceased_v1r0 = 353358909 THEN do;
type12='12'; 
 date12=put(HdWd_DeceasedDtEntry_v1r0, DATETIME.);
/*date12=HdWd_DeceasedDt_v1r0;*/
end;
type=catx(',',put(type1,$typerefwdfmt.),put(type2,$typerefwdfmt.),put(type3,$typerefwdfmt.),
put(type4,$typerefwdfmt.),put(type5,$typerefwdfmt.),put(type6,$typerefwdfmt.),
put(type7,$typerefwdfmt.),put(type8,$typerefwdfmt.),put(type9,$typerefwdfmt.),put(type10,$typerefwdfmt.),
put(type11,$typerefwdfmt.),put(type12,$typerefwdfmt.));
date=catx(',',of date1-date12);
/*date=catx(',',of date1-date12, put(date1-date12,date9.));*/
RUN;

/*proc print;
run;*/

DATA Work.Concept_ids;
SET Work.concept_ids;
LABEL type1= "Refused Baseline Survey"
	  type2= "Refused Baseline Blood Sample"
	  type3= "Refused Baseline Urine Sample"
	  type4= "Refused Baseline Saliva Sample"
	  type5= "Refused All Future Surveys"
	  type6= "Refused All Future Samples"
	  type7= "Refused Baseline Specimen Surveys"
	  type8= "Wants Data Destroyed"
	  type9= "Revoke HIPAA"
	  type10= "Withdrew Consent"
	  type11= "Refused All Future Activities"
	  type12= "Deceased"
	  type= "Type of Refusal/Withdrawal"
	  date= "Date of Refusal/Withdrawal";
RUN;

*Refusal/Withdrawal Table for Michelle/Mia/Amelia;
proc sql;
title 'Refusal and Withdrawal Variables';
   create table RefWithdrawal as
select 
date,
Connect_ID, 
RcrtES_Site_v1r0,
type,
HdWd_SuspendContact_v1r0,
HdWd_Suspend_v1r0,
HdWd_WhoRequestedRefWd_v1r0,	
/*HdWd_RequestedRefWdOth_v1r0,*/
HdWd_HIPAArevokesign_v1r0,
HdWd_DateHIPAArevsign_v1r0,
HdWd_Datadestroysign_v1r0,
HdWd_DateDatadestsign_v1r0
from Work.Concept_ids;
select * from RefWithdrawal;	
/*HdRef_Basesrv_v1r0,	
HdRef_DateBasesrv_v1r0,	
HdRef_Baseblood_v1r0,	
HdRef_DateBaseblood_v1r0,	
HdRef_Baseurine_v1r0,	
HdRef_DateBaseurine_v1r0,	
HdRef_Basesaliva_v1r0,	
HdRef_DateBasesaliva_v1r0,	
HdRef_Allsrv_v1r0,
HdRef_DateAllsrv_v1r0,
HdRef_Allsample_v1r0,
HdRef_DateAllsample_v1r0,
HdRef_BlSpecSrv_v1r0,
HdRef_BlSpecSrvDt_v1r0,
HdWd_Activepart_v1r0,	
HdWd_DateActivepart_v1r0,
HdWd_SuspendContact_v1r0,
HdWd_SuspendDt_v1r0,			
HdWd_HIPAARevokedCat_v1r0,	
HdWd_HIPAArevokedver_v1r0,
HdWd_Fname_v1r0,
HdWd_Lname_v1r0,
HdWd_Mname_v1r0,	
HdWd_Suffix_v1r0,
HdRef_DateHIPAArevoked_v1r0,	
HdWd_DestroyDataCat_v1r0,
HdWd_DestroyDataVer_v1r0,
HdWd_FnameDD_v1r0,
HdWd_LnameDD_v1r0,	
HdWd_MnameDD_v1r0,	
HdWd_SuffixDD_v1r0,
HdRef_DateDatadestroy_v1r0,	
HdWd_WdConsentDt_v1r0,	
HdRef_Busy_v1r0,	
HdRef_NotInterested_v1r0,	
HdRef_TooMuchTime_v1r0,	
HdRef_Payment_v1r0,
HdRef_Sick_v1r0,	
HdRef_NoInternet_v1r0,	
HdRef_WorriedResults_v1r0,	
HdRef_Worried_v1r0,	
HdRef_Privacy_v1r0,	
HdRef_PrivacyA_v1r0,	
HdRef_PrivacyB_v1r0,	
HdRef_PrivacyC_v1r0,	
HdRef_PrivacyD_v1r0,	
HdRef_PrivacyE_v1r0,	
HdRef_PrivacyF_v1r0,	
HdRef_PrivacyG_v1r0,	
HdRef_PrivacyH_v1r0,	
HdRef_PrivacyI_v1r0,	
HdRef_PrivacyJ_v1r0,	
HdRef_Online_v1r0,	
HdRef_DislikeOnline_v1r0,
HdRef_COVID_v1r0,	
HdRef_Unable_v1r0,	
HdRef_Incarcerated_v1r0,	
HdRef_OthRsn_v1r0,	
HdRef_Other_v1r0,	
HdRef_NotGiven_v1r0,	
HdWd_Deceased_v1r0,
HdWd_DeceasedDt_v1r0,	
HdWd_SourceofReport_v1r0*/

/*PROC EXPORT 
DATA=Work.RefWithdrawal
OUTFILE="C:\Users\natarajanm2\Desktop\RefusalWithdrawal.csv"
DBMS=csv
LABEL;
RUN;*/

*Adding recruitment variable to dashboard metrics for active/passive/not active;
PROC FREQ DATA=Work.Concept_ids;
TABLE RcrtSI_RecruitType_v1r0 /out=recruittypetotal;
RUN;

*Verification Table Variables;
/*PROC PRINT DATA=Work.Concept_ids;
VAR token 
	Connect_ID 
	RcrtSI_RecruitType_v1r0
	RcrtV_Verification_v1r0
	RcrtUP_Submitted_v1r0
	/*Verification Table Variables start here:*/
	/*RcrtV_DuplicateType_v1r0
	RcrtV_UpdateRecType_v1r0
	RcrtV_FNameMatch_v1r0
	RcrtV_LNameMatch_v1r0
	RcrtV_DOBMatch_v1r0
	RcrtV_PINMatch_v1r0
	RcrtV_TokenMatch_v1r0
	RcrtV_ZipMatch_v1r0
	RcrtV_SiteMatch_v1r0
	RcrtV_AgeMatch_v1r0
	RcrtV_CStatusMatch_v1r0;
RUN;*/

*Figuring out reasons cannot be verified;
DATA ReasonCannotBeVer;
SET Work.Concept_ids;
RUN;
/*PROC PRINT DATA=ReasonCannotBeVer;
VAR RcrtV_Verification_v1r0 RcrtV_FNameMatch_v1r0 RcrtV_LNameMatch_v1r0 RcrtV_DOBMatch_v1r0 RcrtV_PINMatch_v1r0 RcrtV_TokenMatch_v1r0 
RcrtV_ZipMatch_v1r0 RcrtV_SiteMatch_v1r0 RcrtV_AgeMatch_v1r0 RcrtV_CStatusMatch_v1r0;
WHERE RcrtV_Verification_v1r0 = 219863910;
RUN;*/

*Checking Time to Completion of Enrollment variables;
*PROC PRINT DATA=Work.CONCEPT_IDS;
*VAR RcrtSI_RecruitType_v1r0 TmFrmActRecToSignIn;
*RUN;

*PROC PRINT DATA=Work.Concept_ids;
*VAR TmFrmActRecToSignIn SignInToConsent ConsentToUP UPToVerif TotalEnrollmentTime;
*RUN;

*PROC PRINT DATA= RecruitmentToSignInMin;
*RUN;

*PROC PRINT DATA= SignInToConsentMin;
*RUN;

*PROC PRINT DATA= ConsentToUPMin;
*RUN;

*PROC PRINT DATA= UPToVerifMin;
*RUN;

*PROC PRINT DATA= TotalEnrollmentMin;
*RUN;

*Checking phone rule (phone required if consent submitted = yes and email not given);
*PROC PRINT DATA=Work.Concept_ids;
*VAR RcrtCS_Consented_v1r0 email phoneNumber token;
*RUN;

/*Checking if dates for refusal/withdrawal activities are populated;
PROC PRINT DATA=Work.Concept_ids;
VAR HdRef_DateBasesrv_v1r0
HdRef_DateBaseblood_v1r0
HdRef_DateBaseurine_v1r0
HdRef_DateBasesaliva_v1r0
HdRef_DateAllsrv_v1r0
HdRef_DateAllsample_v1r0
hdref_blspecsrvdt_v1r0
hdref_datedatadestroy_v1r0
hdref_datehipaarevoked_v1r0
HdWd_WdConsentDt_v1r0
HdWd_DateActivepart_v1r0
HdWd_DeceasedDt_v1r0;
RUN;*/

*Checking HIPAA Revoked/Date HIPAA Revoked/HIPAA Revoke Signed;
*PROC PRINT DATA=Work.Concept_ids;
*VAR HdWd_HIPAArevoked_v1r0 hdref_datehipaarevoked_v1r0 HdWd_HIPAArevokesign_v1r0 HdWd_DATEHIPAArevsign_v1r0;
*RUN;

/*Checking which verified participants from SH are missing demographic info;
PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtSI_Age_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_Sex_v1r0 Connect_ID token;
WHERE RcrtV_Verification_v1r0 = 197316935;
RUN;*/

/*Checking which verified participants from HP are missing race;
Proc Print DATA=Work.Concept_ids;
VAR RcrtSI_Race_v1r0 token Connect_ID;
WHERE RcrtV_Verification_v1r0 = 197316935;
RUN;*/

/*Checking Duplicates with UP Not Submitted;
PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 DupUpNotSubmit;
RUN;*/

/*PROC PRINT DATA=Work.Concept_ids;
VAR RcrtV_Verification_v1r0 VerifCompl VerificationComplete;
RUN;*/

/*Checking Which verified SH participants are missing demographic info*/
/*PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_RecruitType_v1r0 RcrtSI_Age_v1r0 RcrtSI_SHRace_v1r0 RcrtSI_Sex_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 Connect_ID token;
WHERE RcrtV_Verification_v1r0 = 197316935;
RUN;*/

/*PROC PRINT label DATA=Work.Concept_ids;
VAR RcrtUP_Cancer_v1r0 RcrtUP_CancerYr_v1r0 /*RcrtUP_CancerType_v1r0 RcrtUP_CancerComts_v1r0*/;
*RUN;

/*PROC PRINT DATA=Work.CONCEPT_IDS;
VAR RcrtV_Verification_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR RcrtV_Verification_v1r0 RcrtV_Automated_v1r0 RcrtV_Outreach_v1r0 RcrtV_Mannual_v1r0;
WHERE RcrtV_Verification_v1r0 = 197316935;
RUN;

PROC PRINT DATA=Work.CONCEPT_IDS;
VAR RcrtSI_OptOut_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR RcrtES_Aware_v1r0_Email
RcrtES_Aware_v1r0_Mail
RcrtES_Aware_v1r0_Invite
RcrtES_Aware_v1r0_Phone
RcrtES_Aware_v1r0_Phys
RcrtES_Aware_v1r0_Staff
RcrtES_Aware_v1r0_News
RcrtES_Aware_v1r0_HCNews
RcrtES_Aware_v1r0_HCSite
RcrtES_Aware_v1r0_Web
RcrtES_Aware_v1r0_Social
RcrtES_Aware_v1r0_TV
RcrtES_Aware_v1r0_Video
RcrtES_Aware_v1r0_Family
RcrtES_Aware_v1r0_Member
RcrtES_Aware_v1r0_Poster
RcrtES_Aware_v1r0_Table
RcrtES_Aware_v1r0_Hold
RcrtES_Aware_v1r0_Other;
RUN;*/

*Checking Ref/Wd Dates;
/*PROC PRINT DATA=Work.Concept_ids;
VAR 
Connect_ID
HdRef_Basesrv_v1r0
HdRef_DateBasesrv_v1r0
HdRef_Baseblood_v1r0 
HdRef_DateBaseblood_v1r0
HdRef_Baseurine_v1r0 
HdRef_DateBaseurine_v1r0
HdRef_Basesaliva_v1r0
HdRef_DateBasesaliva_v1r0
HdRef_Allsrv_v1r0
HdRef_DateAllsrv_v1r0
HdRef_Allsample_v1r0 
HdRef_DateAllsample_v1r0
HdRef_BlSpecSrv_v1r0 
hdref_blspecsrvdt_v1r0
HdWd_Destroydata_v1r0 
hdref_datedatadestroy_v1r0
HdWd_HIPAArevoked_v1r0 
hdref_datehipaarevoked_v1r0
HdWd_WdConsent_v1r0 
HdWd_WdConsentDt_v1r0
HdWd_Activepart_v1r0 
HdWd_DateActivepart_v1r0
HdWd_Deceased_v1r0
HdWd_DeceasedDt_v1r0
HdWd_DeceasedDtEntry_v1r0
HdWd_SuspendContact_v1r0
HdWd_Suspend_v1r0
HdWd_WhoRequestedRefWd_v1r0	
/*HdWd_RequestedRefWdOth_v1r0*/
*HdWd_HIPAArevokesign_v1r0
HdWd_DateHIPAArevsign_v1r0
HdWd_Datadestroysign_v1r0
HdWd_DateDatadestsign_v1r0;
*RUN;

/*PROC PRINT DATA=Work.Concept_ids;
VAR Connect_ID HdWd_HIPAArevoked_v1r0 HdRef_DateHIPAArevoked_v1r0 HdWd_WdConsent_v1r0 HdWd_WdConsentDt_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR HdWd_SuspendContact_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids;
VAR RcrtV_Verification_v1r0 RcrtUP_Cancer_v1r0;
RUN;*/

/*Verification Table Variables;
PROC PRINT DATA=Work.Concept_ids;
VAR token 
	Connect_ID 
	RcrtSI_RecruitType_v1r0
	RcrtV_Verification_v1r0
	RcrtUP_Submitted_v1r0
	/*Verification Table Variables start here:*/
	*RcrtV_DuplicateType_v1r0
	RcrtV_UpdateRecType_v1r0
	RcrtV_FNameMatch_v1r0
	RcrtV_LNameMatch_v1r0
	RcrtV_DOBMatch_v1r0
	RcrtV_PINMatch_v1r0
	RcrtV_TokenMatch_v1r0
	RcrtV_ZipMatch_v1r0
	RcrtV_SiteMatch_v1r0
	RcrtV_AgeMatch_v1r0
	RcrtV_CStatusMatch_v1r0;
*RUN;

/*Checking duplicate for Marshfield;
PROC PRINT DATA=DataWithAllDups;
VAR studyid RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0;
/*WHERE RcrtV_Verification_v1r0 = 922622075;*/
/*WHERE studyid = "MC000002A77132";
RUN;*/

*Checking duplicate for HP;
/*PROC PRINT DATA=DataWithAllDups;
VAR studyid RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0;
WHERE RcrtV_Verification_v1r0 = 922622075;
RUN;

PROC PRINT DATA=DataWithAllDups;
VAR studyid RcrtSI_RecruitType_v1r0 RcrtV_Verification_v1r0;
WHERE studyid = "HP20210610000202" OR studyid = "HP20210610000597" or studyid = "HP20210610000615"
or studyid = "HP20210610000622" or studyid = "HP20210610002109" or studyid = "HP20210610002181"
or studyid = "HP20210610002435" or studyid = "HP20210610002593" or studyid = "HP20210610003821";
RUN;*/

PROC FREQ DATA=DataWithAllDups;
TABLES studyid /out=DupFreqs;
RUN;

/*PROC PRINT DATA=DupFreqs;
WHERE count > 1;
RUN;*/

/*Checking Verification table variables for KPCO*/
/*PROC PRINT DATA=Work.Concept_ids;
VAR Connect_ID RcrtUP_Submitted_v1r0 RcrtV_Verification_v1r0 RcrtV_AgeMatch_v1r0 RcrtV_CStatusMatch_v1r0 RcrtV_DOBMatch_v1r0
RcrtV_FNameMatch_v1r0 RcrtV_LNameMatch_v1r0 RcrtV_Automated_v1r0 RcrtV_Mannual_v1r0;
RUN;

/*Checking HFHS Specific Demographics*/
/*PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_Age_v1r0 RcrtSI_Race_v1r0 RcrtSI_HFHSRace_v1r0 RcrtSI_HFHSEthnicity_v1r0 RcrtSI_Sex_v1r0 RcrtSI_SH_HFHS_Sex_v1r0;
RUN;*/

*Adding Code from the Beginning of the Dashboard Metrics Macros for each site to run for the CCC Reports;

*Creating New Variable to Remove Non Verified Participants from Verified Only Tables (instead of creating new dataset);
DATA Work.Concept_ids;
SET Work.Concept_ids;
LENGTH VerifRecruitType $30;
SET Work.Concept_ids;
IF RcrtV_Verification_v1r0 = 197316935 and RcrtSI_RecruitType_v1r0 = 486306141 THEN VerifRecruitType = "ACTIVE";
ELSE IF RcrtV_Verification_v1r0 = 197316935 and RcrtSI_RecruitType_v1r0 = 854703046 THEN VerifRecruitType = "PASSIVE";
RUN;

*Subsetting Refusals/Withdrawals to only those verified;
DATA RefWdSubset;
SET Work.Concept_ids;
IF RcrtV_Verification_v1r0 NE 197316935 THEN DELETE;
RUN;

*Consolidating RcrtSI_SHRaceEth2_v1r0 and RcrtSI_HFHSREOverall2_v1r0 to RcrtSI_Race_v1r0;
DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_SHRaceEth2_v1r0 = 1 OR RcrtSI_HFHSREOverall2_v1r0 = 1 THEN RcrtSI_Race_v1r0 = 768826601;
ELSE IF RcrtSI_SHRaceEth2_v1r0 = 2 OR RcrtSI_HFHSREOverall2_v1r0 = 2 THEN RcrtSI_Race_v1r0 = 181769837;
ELSE IF RcrtSI_SHRaceEth2_v1r0 = 3 OR RcrtSI_HFHSREOverall2_v1r0 = 3 THEN RcrtSI_Race_v1r0 = 178420302;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RaceVerifiedSH = 1 OR RaceVerifiedHFHS = 1 THEN RaceVerified = 1;
ELSE IF RaceVerifiedSH = 2 OR RaceVerifiedHFHS = 2 THEN RaceVerified = 2;
ELSE IF RaceVerifiedSH = 3 OR RaceVerifiedHFHS = 3 THEN RaceVerified = 3;
RUN;

*Consolidating HFHS Sex and HFHS Sex Verified to Overall Site Sex Variable and SexVerified;
DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
IF RcrtSI_SH_HFHS_Sex_v1r0 = 536341288 THEN RcrtSI_Sex_v1r0 = 536341288;
ELSE IF RcrtSI_SH_HFHS_Sex_v1r0 = 654207589 THEN RcrtSI_Sex_v1r0 = 654207589;
ELSE IF RcrtSI_SH_HFHS_Sex_v1r0 = 178420302 THEN RcrtSI_Sex_v1r0 = 178420302;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
IF SexVerifiedHFHS = 1 THEN SexVerified = 1;
ELSE IF SexVerifiedHFHS = 2 THEN SexVerified = 2;
ELSE IF SexVerifiedHFHS = 3 THEN SexVerified = 4;
RUN;

*Checking Passive Recruits w/o site info (running code w/o selecting a site);
PROC PRINT DATA=Work.Concept_ids;
VAR Connect_ID studyid token RcrtSI_RecruitType_v1r0 RcrtES_Site_v1r0;
WHERE RcrtES_Site_v1r0 = .;
RUN;

*Checking reasons for opt-out for other-specify;
PROC FREQ DATA=Work.Concept_ids;
TABLES RcrtES_Site_v1r0*RcrtSI_OptOut_v1r0_specify /out=Specify;
WHERE RcrtSI_OptOut_v1r0_specify NE " ";
RUN;

/*TIME TO COMPLETION OF ENROLLMENT FOR CCC WEEKLY REPORT (ALL SITES)*/
*Time from active recruitment began to sign in;
DATA Work.Concept_ids;
SET Work.Concept_ids; 
TmFrmActRecToSignIn2 = RcrtSI_SignTime_v1r0 - RcrtSI_TypeTime_v1r0;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
IF RcrtSI_RecruitType_v1r0 NE 486306141 THEN TmFrmActRecToSignIn2 = .;
RUN;

*Time from sign in to consent; 
	*variable for this is created (RcrtCT_Acct_Cnst_v1r0) but is not derived in the dictionary;

*Time from consent to user profile submission; 
	*variable for this is created (RcrtCT_Cnst_UP_v1r0) but is not derived in the dictionary;

*Time from user profile submission to verification; 
DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerif2 = RcrtV_VerificationTm_V1R0 - RcrtUP_SubmitTime_v1r0;
RUN;

*Total enrollment time (sum of the above times) Calculated Below at the end;

*Time from Active Recruitment Began to Sign In (limit to those who signed in);
PROC PRINT DATA=Work.Concept_ids;
VAR RcrtSI_SignTime_v1r0 RcrtSI_TypeTime_v1r0 TmFrmActRecToSignIn2 RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0;
WHERE RcrtSI_RecruitType_v1r0 = 486306141 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids; 
ActRecToSignInDays2 = TmFrmActRecToSignIn2/86400;
RUN;

*Format for days and hours;
proc format;
picture mytime (default=50)
other='%n days and %H hours' (datatype=time);
run;
*Format for days, hours, minutes, and seconds;
proc format;
picture mytimemin (default=50)
other='%n days and %H hours and %M minutes and %S seconds' (datatype=time);
run;


PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInD2;
VAR ActRecToSignInDays2;
LABEL ActRecToSignInDays2 = "Time from Active Recruitment Began to Sign In (Days)";
TABLE ActRecToSignInDays2*(Q1 Median Q3);
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInDH2;
VAR TmFrmActRecToSignIn2;
LABEL TmFrmActRecToSignIn2 = "Time from Active Recruitment Began to Sign In (Days and Hours)";
TABLE TmFrmActRecToSignIn2*(Q1 Median Q3);
FORMAT TmFrmActRecToSignIn2 mytime.;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

PROC PRINT DATA=RecruitmentToSignInDH2;
VAR TmFrmActRecToSignIn2_Q1 TmFrmActRecToSignIn2_Median TmFrmActRecToSignIn2_Q3;
FORMAT TmFrmActRecToSignIn2_Q1 mytime. TmFrmActRecToSignIn2_Median mytime. TmFrmActRecToSignIn2_Q3 mytime.;
RUN;

PROC TABULATE DATA=Work.concept_ids out=RecruitmentToSignInMin2;
CLASS sitechar;
VAR TmFrmActRecToSignIn2;
LABEL TmFrmActRecToSignIn2 = "Time from Active Recruitment Began to Sign In (Formatted)";
TABLE sitechar*TmFrmActRecToSignIn2*(Q1 Median Q3);
TABLE TmFrmActRecToSignIn2*(Q1 Median Q3);
FORMAT TmFrmActRecToSignIn2 mytimemin.;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933 AND RcrtSI_SignedIn_v1r0 = 353358909;
RUN;

data RecruitmentToSignInMin2;
set RecruitmentToSignInMin2;
if sitechar=' ' then sitechar='Total';
run;

PROC PRINT DATA=RecruitmentToSignInMin2;
RUN;

*Using labels and format for Days, Hours, Minutes, and Seconds (put in CCC Weekly Report);
/*PROC PRINT noobs DATA=RecruitmentToSignInMin2 label style(table)={width=9in};
LABEL TmFrmActRecToSignIn2_Q1 = "Active Recruit to Sign In Q1 Formatted"
	  TmFrmActRecToSignIn2_Median = "Active Recruit to Sign In Median Formatted"
      TmFrmActRecToSignIn2_Q3 = "Active Recruit to Sign In Q3 Formatted";
FORMAT TmFrmActRecToSignIn2_Q1 mytimemin. TmFrmActRecToSignIn2_Median mytimemin. TmFrmActRecToSignIn2_Q3 mytimemin.;
VAR RcrtSI_RecruitType_v1r0 sitechar TmFrmActRecToSignIn2_Q1 TmFrmActRecToSignIn2_Median TmFrmActRecToSignIn2_Q3;
Title1 'Time to Completion of Enrollment';
Title2 ' ';
Title3 ' ';
Title4 'Time from Active Recruitment to Sign In';
WHERE RcrtSI_RecruitType_v1r0 = 486306141;
RUN;*/

*Time from sign in to consent (limit to those who consented);
DATA Work.Concept_ids;
SET Work.Concept_ids;
SignInToConsent2 = RcrtCS_ConsentSumit_v1r0 - RcrtSI_SignTime_v1r0;
RUN;

/*PROC PRINT DATA=Work.Concept_ids; 
VAR RcrtCS_ConsentSumit_v1r0 RcrtSI_SignTime_v1r0 SignInToConsent2 RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;*/

DATA Work.Concept_ids;
SET Work.CONCEPT_IDS;
SignInToConsentDays2 = SignInToConsent2/86400;
RUN;

/*PROC PRINT DATA= Work.CONCEPT_IDS;
VAR SignInToConsent2 SignInToConsentDays2;
RUN;*/

PROC TABULATE DATA=Work.concept_ids out=SignInToConsentD2;
VAR SignInToConsentDays2;
LABEL SignInToConsentDays2 = "Time from Sign-In To Consent (Days)";
TABLE SignInToConsentDays2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

PROC TABULATE DATA=WOrk.CONCEPT_IDS out=SignInToConsentDH2;
VAR SignInToConsent2;
LABEL SignInToConsent2 = "Time From Sign-In To Consent (Days and Hours)";
FORMAT SignInToConsent2 mytime.;
TABLE SignInToConsent2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

/*PROC PRINT DATA=SignInToConsentDH2;
VAR RcrtSI_RecruitType_v1r0 SignInToConsent2_Q1 SignInToConsent2_Median SignInToConsent2_Q3;
FORMAT SignInToConsent2_Q1 mytime. SignInToConsent2_Median mytime. SignInToConsent2_Q3 mytime.;
RUN;*/

PROC TABULATE DATA=Work.CONCEPT_IDS out=SignInToConsentMin2;
CLASS sitechar;
VAR SignInToConsent2;
LABEL SignInToConsent2 = "Time From Sign-In To Consent (Formatted)";
FORMAT SignInToConsent2 mytimemin.;
TABLE sitechar*SignInToConsent2*(Q1 Median Q3);
TABLE SignInToConsent2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
BY RcrtSI_RecruitType_v1r0;
RUN;

data SignInToConsentMin2;
set SignInToConsentMin2;
if sitechar=' ' then sitechar='Total';
run;

/*PROC PRINT DATA=SignInToConsentMin2;
VAR RcrtSI_RecruitType_v1r0 SignInToConsent2_Q1 SignInToConsent2_Median SignInToConsent2_Q3;
FORMAT SignInToConsent2_Q1 mytimemin. SignInToConsent2_Median mytimemin. SignInToConsent2_Q3 mytimemin.;
RUN;

PROC PRINT DATA=SignInToConsentMin2 label style(table)={width=9in};
*style(header obs obsheader)={color=bigb};
LABEL SignInToConsent2_Q1 = "Sign In to Consent Q1 Formatted"
	  SignInToConsent2_Median = "Sign In to Consent Median Formatted"
	  SignInToConsent2_Q3 = "Sign In to Consent Q3 Formatted";
FORMAT SignInToConsent2_Q1 mytimemin. SignInToConsent2_Median mytimemin. SignInToConsent2_Q3 mytimemin.;
Title 'Time from Sign In to Consent (Formatted)';
VAR RcrtSI_RecruitType_v1r0 sitechar SignInToConsent2_Q1 SignInToConsent2_Median SignInToConsent2_Q3;
RUN;*/

*Time from consent to user profile submission (limit to those who completed UP);
DATA Work.Concept_ids;
SET Work.Concept_ids;
ConsentToUP2 = RcrtUP_SubmitTime_v1r0 - RcrtCS_ConsentSumit_v1r0;
RUN;

/*PROC PRINT DATA=Work.Concept_ids; 
VAR ConsentToUP2 RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids;
ConsentToUpDays2 = ConsentToUp2/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPD2;
VAR ConsentToUpDays2;
LABEL RcrtCT_Cnst_UP_v1r0 = "Time from Consent to UP Submission (Days)";
TABLE ConsentToUpDays2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPDH2;
VAR ConsentToUp2;
LABEL ConsentToUp2 = "Time from Consent to UP Submission (Days and Hours)";
FORMAT ConsentToUP2 mytime.;
TABLE ConsentToUp2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=ConsentTOUPMin2;
CLASS sitechar;
VAR ConsentToUp2;
LABEL ConsentToUp2 = "Time from Consent to UP Submission (Formatted)";
FORMAT ConsentToUP2 mytimemin.;
TABLE sitechar*ConsentToUp2*(Q1 Median Q3);
TABLE ConsentToUp2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND RcrtUP_Submitted_v1r0 = 353358909;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

data ConsentTOUPMin2;
set ConsentTOUPMin2;
if sitechar=' ' then sitechar='Total';
run;

/*PROC PRINT DATA=ConsentTOUPD2;
VAR ConsentToUPDays2_Q1 ConsentToUPDays2_MEDIAN ConsentToUPDays2_Q3;
RUN;

PROC PRINT DATA=ConsentTOUPDH2;
VAR ConsentTOUP2_Q1 ConsentToUP2_MEDIAN ConsentToUP2_Q3;
FORMAT ConsentTOUP2_Q1 mytime. ConsentToUP2_MEDIAN mytime. ConsentToUP2_Q3 mytime.;
RUN; 

PROC PRINT DATA=ConsentTOUPMin2;
VAR ConsentTOUP2_Q1 ConsentToUP2_MEDIAN ConsentToUP2_Q3;
FORMAT ConsentTOUP2_Q1 mytimemin. ConsentToUP2_MEDIAN mytimemin. ConsentToUP2_Q3 mytimemin.;
RUN; 

PROC PRINT DATA=ConsentTOUPMin2 label style(table)={width=9in};
LABEL ConsentToUP2_Q1 = "Consented to UP Submitted Q1 Formatted"
	  ConsentToUp2_Median = "Consented to UP Submitted Median Formatted"
	  ConsentToUp2_Q3 = "Consented to UP Submitted Q3 Formatted";
FORMAT ConsentToUP2_Q1 mytimemin. ConsentToUP2_Median mytimemin. ConsentToUP2_Q3 mytimemin.;
Title 'Time from Consented to UP Submitted (Formatted)';
VAR RcrtSI_RecruitType_v1r0 sitechar ConsentToUp2_Q1 ConsentToUp2_Median ConsentToUp2_Q3;
RUN;*/

*Time from user profile submission to verification (limit to those with verification complete, 
regardless of outcome);
DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerif2 = RcrtV_VerificationTm_V1R0 - RcrtUP_SubmitTime_v1r0;
RUN;

PROC PRINT DATA=Work.Concept_ids; 
VAR UPToVerif2 RcrtSI_RecruitType_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 verifcompl;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933 AND verifcompl=1;
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
UPToVerifDays2 = UPToVerif2/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifD2;
VAR UPToVerifDays2;
LABEL UPToVerifDays2 = "Time from UP to Verification (Days)";
TABLE UPToVerifDays2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifDH2;
VAR UPToVerif2;
LABEL UPToVerif2 = "Time from UP To Verification (Days and Hours)";
FORMAT UPToVerif2 mytime.;
TABLE UPToVerif2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=UPToVerifMin2;
CLASS sitechar;
VAR UPToVerif2;
LABEL UPToVerif2 = "Time from UP To Verification (Formatted)";
FORMAT UPToVerif2 mytimemin.;
TABLE sitechar*UPToVerif2*(Q1 Median Q3);
TABLE UPToVerif2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

data UPToVerifMin2;
set UPToVerifMin2;
if sitechar=' ' then sitechar='Total';
run;

/*PROC PRINT DATA=UPToVerifD2;
VAR UPToVerifDays2_Q1 UPToVerifDays2_MEDIAN UPToVerifDays2_Q3;
RUN;

PROC PRINT DATA=UPToVerifDH2;
VAR UpToVerif2_Q1 UpToVerif2_MEDIAN UpToVerif2_Q3;
FORMAT UpToVerif2_Q1 mytime. UpToVerif2_MEDIAN mytime. UpToVerif2_Q3 mytime.;
RUN; 

PROC PRINT DATA=UpToVerifMin2;
VAR UpToVerif2_Q1 UpToVerif2_MEDIAN UpToVerif2_Q3;
FORMAT UpToVerif2_Q1 mytimemin. UpToVerif2_MEDIAN mytimemin. UpToVerif2_Q3 mytimemin.;
RUN; 

PROC PRINT noobs DATA=UPTOVerifMin2 label style(table)={width=10in};
*style(header obs obsheader)={color=bigb};
LABEL UPToVerif2_Q1 = "UP Submitted to Verification Complete Q1"
	  UPToVerif2_Median = "UP Submitted to Verification Complete"
	  UPToVerif2_Q3 = "UP Submitted to Verification Complete Q3";
FORMAT UPToVerif2_Q1 mytimemin. UPToVerif2_Median mytimemin. UPToVerif2_Q3 mytimemin.;
VAR RcrtSI_RecruitType_v1r0 /style=[cellwidth=1.4in];
VAR sitechar UPToVerif2_Q1 UPToVerif2_Median UPToVerif2_Q3;
Title 'Time from UP Submitted to Verification Complete';
RUN;*/

*Total Enrollment Time (Sum of the above times);
DATA Work.Concept_ids;
SET Work.Concept_ids;
TotalEnrollmentTime2 = SUM(TmFrmActRecToSignIn2, SignInToConsent2, ConsentToUP2, UPToVerif2);
RUN;

DATA Work.Concept_ids;
SET Work.Concept_ids;
LABEL TmFrmActRecToSignIn2 = "Time from Active recruitment began to sign in"
	  SignInToConsent2 = "Time from User Profile submission to Verification"
	  ConsentToUP2 = "Time from Consented to Submission of UP"
	  UPToVerif2 = "Time from Submission of UP to Verification"
	  TotalEnrollmentTime2 = "Total Enrollment Time";
RUN;

/*PROC PRINT DATA=Work.Concept_ids;
VAR TotalEnrollmentTime2 TmFrmActRecToSignIn2 SignInToConsent2 ConsentToUP2 UPToVerif2;
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 
AND RcrtUP_Submitted_v1r0 = 353358909 AND RcrtSI_RecruitType_v1r0 NE 180583933 AND verifcompl=1;
RUN;*/

DATA Work.Concept_ids;
SET Work.Concept_ids;
TotalEnrollmentDays2 = TotalEnrollmentTime2/86400;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentD2;
VAR TotalEnrollmentDays2;
LABEL TotalEnrollmentDays2 = "Total Enrollment Time (Days)";
TABLE TotalEnrollmentDays2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentDH2;
VAR TotalEnrollmentTime2;
LABEL TotalEnrollmentTime2 = "Total Enrollment Time (Days and Hours)";
FORMAT TotalEnrollmentTime2 mytime.;
TABLE TotalEnrollmentTime2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

PROC TABULATE DATA=Work.concept_ids out=TotalEnrollmentMin2;
CLASS sitechar;
VAR TotalEnrollmentTime2;
LABEL TotalEnrollmentTime2 = "Total Enrollment Time (Formatted)";
FORMAT TotalEnrollmentTime2 mytimemin.;
TABLE sitechar*TotalEnrollmentTime2*(Q1 Median Q3);
TABLE TotalEnrollmentTime2*(Q1 Median Q3);
WHERE RcrtSI_SignedIn_v1r0 = 353358909 AND RcrtCS_Consented_v1r0 = 353358909 AND 
RcrtUP_Submitted_v1r0 = 353358909 AND VerifCompl = 1;
BY RcrtSI_RecruitType_v1r0;
WHERE RcrtSI_RecruitType_v1r0 NE 180583933;
RUN;

data TotalEnrollmentMin2;
set TotalEnrollmentMin2;
if sitechar=' ' then sitechar='Total';
run;

/*PROC PRINT DATA=TotalEnrollmentD2;
VAR TotalEnrollmentDays2_Q1 TotalEnrollmentDays2_MEDIAN TotalEnrollmentDays2_Q3;
RUN;

PROC PRINT DATA=TotalEnrollmentDH2;
VAR TotalEnrollmentTime2_Q1 TotalEnrollmentTime2_MEDIAN TotalEnrollmentTime2_Q3;
FORMAT TotalEnrollmentTime2_Q1 mytime. TotalEnrollmentTime2_MEDIAN mytime. TotalEnrollmentTime2_Q3 mytime.;
RUN; 

PROC PRINT DATA=TotalEnrollmentMin2;
VAR TotalEnrollmentTime2_Q1 TotalEnrollmentTime2_MEDIAN TotalEnrollmentTime2_Q3;
FORMAT TotalEnrollmentTime2_Q1 mytimemin. TotalEnrollmentTime2_MEDIAN mytimemin. TotalEnrollmentTime2_Q3 mytimemin.;
RUN; 

PROC PRINT noobs DATA=TotalEnrollmentMin2 label style(table)={width=9in};
LABEL TotalEnrollmentTime2_Q1 = "Total Enrollment Time Q1"
	  TotalEnrollmentTime2_Median = "Total Enrollment Time Median"
	  TotalEnrollmentTime2_Q3 = "Total Enrollment Time Q3";
FORMAT TotalEnrollmentTime2_Q1 mytimemin. TotalEnrollmentTime2_MEDIAN mytimemin. TotalEnrollmentTime2_Q3 mytimemin.;
VAR sitechar RcrtSI_RecruitType_v1r0 TotalEnrollmentTime2_Q1 TotalEnrollmentTime2_MEDIAN TotalEnrollmentTime2_Q3;
Title 'Total Enrollment Time';
RUN;*/

/*Checking sign-in mechanism;
PROC PRINT DATA=Work.Concept_ids;
VAR Connect_ID RcrtSI_SignedIn_v1r0 RcrtPC_Acnt_SignIn_v1r0;
WHERE RcrtSI_SignedIn_v1r0 = 353358909;
RUN;*/

/*JING'S CODE FOR THE GRAPHS FOR THE CCC METRICS*/
/*JING'S CODE START'S HERE*/

***Madhuri: please add the data management to this part;

PROC FORMAT;
VALUE WorkFlowFmtJW
	 0 = "Never Signed In"
	 1 = "Signed in"
     2 = "Consented"
     3 = "Profile Done"
     4 = "Verification Complete"
	 5 = "Verified"
	 9 = "Total";
Value WorkFlow1FmtJW
	0 = "No Sign In"
	1 = "Sign";
VALUE SSNPieChartFmtJW 
	1 = "0 Digits "
	2 = "Partial Digits "
	3 = "Full Digits";
Value NoSSNGivenFmtJW
	353358909 = "Full or Partial SSN Given"
	104430631 = "No SSN Given";
VALUE SiteRaceEthnFmtJW
	768826601 = "White, Non-Hispanic"
	181769837 = "Other"
	178420302 = "Unavailable/Unknown";
VALUE verifcomplfmtJW
	104430631 = "Verification Not Complete"
	353358909 = "Verification Complete";
VALUE ComplIntlSrvFmtJW
	1 = "None"
	2 = "BOH Only"
	3 = "2 or 3 sections"
	4 = "All";
VALUE verifiedFmtJW
	104430631 = "Not Verified"
	353358909 = "Verified";
VALUE SiteFmtJW
		531629870 = "HealthPartners"
		548392715 = "Henry Ford Health System"
		125001209 = "Kaiser Permanente Colorado"
		327912200 = "Kaiser Permanente Georgia"
		300267574 = "Kaiser Permanente Hawaii"
		452412599 = "Kaiser Permanente Northwest"
		303349821 = "Marshfield Clinic Health System"
		657167265 = "Sanford Health"
		809703864 = "Unviersity of Chicago Medicine"
		517700004 = "National Cancer Institute"
		13 = "National Cancer Institute"
		181769837 = "Other";
VALUE SiteSexFmtJW
			536341288 = "Female"
			654207589 = "Male"
			830573274 = "Intersex or other"
			178420302 = "Unavailable/Unknown"; 
VALUE SHandHFHSSexFmtJW
			536341288 = "Female"
			654207589 = "Male"
			178420302 = "Unavailable/Unknown";  

data concept_ids_noact;
set concept_ids;
if RcrtSI_RecruitType_v1r0=486306141 and  RcrtV_Verification_v1r0= 922622075 then delete; /*remove all the active duplicates*/
run;

data recruit_proces; length RcrtSI_SHRaceEth_v1r0 8.;
set concept_ids_noact;
***workflow***;
if RcrtV_Verification_v1r0 = 875007964 then Rcrt_completion_v1r0=104430631;
else if RcrtV_Verification_v1r0 = 197316935 or RcrtV_Verification_v1r0 = 219863910 or RcrtV_Verification_v1r0 = 922622075 then Rcrt_completion_v1r0=353358909;
if RcrtSI_SignedIn_v1r0= 104430631 then recrt_steps_v1r0=0;
if RcrtSI_SignedIn_v1r0= 353358909 then do;
	if RcrtCS_Consented_v1r0 = 104430631 then recrt_steps_v1r0=1; 
	if RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0= 104430631 then recrt_steps_v1r0=2;
	if RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0= 353358909 and RcrtV_Verification_v1r0 = 875007964 then recrt_steps_v1r0=3;
	if RcrtCS_Consented_v1r0 = 353358909 and RcrtUP_Submitted_v1r0= 353358909 and Rcrt_completion_v1r0=353358909 then recrt_steps_v1r0=4;
end;
if 	RcrtV_Verification_v1r0 = 197316935 then Rcrt_Verified_v1r0=353358909;
else Rcrt_Verified_v1r0=104430631;
***to simply the race/ethnicity defind only by RcrtSI_SHRace_v1r0;

IF RcrtSI_SHRace_v1r0 = 635279662 /*"Caucasian/White"*/  THEN RcrtSI_SHRaceEth_v1r0 = 768826601;/*white any caucasian white*/
ELSE IF RcrtSI_SHRace_v1r0 = 232334767 /*"Hispanic/Latino/Declined"*/ OR RcrtSI_SHRace_v1r0 = 211228524 /*"American Indian or Alaskan Native"*/
OR RcrtSI_SHRace_v1r0 = 308427446 /*Asian"*/OR RcrtSI_SHRace_v1r0 = 432722256 /*"Hispanic/Latino/Black"*/OR RcrtSI_SHRace_v1r0 = 232663805 /*"African American/Black"*/
OR RcrtSI_SHRace_v1r0 = 785578696 /*"Hispanic/Latino/White"*/ OR RcrtSI_SHRace_v1r0 = 200929978 /*"Native Hawaiian"*/ OR RcrtSI_SHRace_v1r0 = 490725843 /*"Native Hawaiian/Pacific Islander"*/
OR RcrtSI_SHRace_v1r0 = 965998904 /*"Pacific Islander"*/  THEN RcrtSI_SHRaceEth_v1r0 = 181769837; /*Other*/
ELSE IF RcrtSI_SHRace_v1r0 = 986445321 /*"Blank"*/ OR RcrtSI_SHRace_v1r0 = 746038746 /*"Declined"*/ OR RcrtSI_SHRace_v1r0 = 178420302 /*"Unavailable/Unknown"*/
THEN RcrtSI_SHRaceEth_v1r0 = 178420302;/*"Unavailable/Unknown"*/
ELSE IF RcrtSI_SHRace_v1r0= "NA" and RcrtES_Site_v1r0=657167265 THEN RcrtSI_SHRaceEth_v1r0 = 178420302;/*"Unavailable/Unknown"*/

***for overall race;
IF RcrtSI_SHRaceEth_v1r0 = 768826601 or RcrtSI_HFHSRace_v1r0=635279662 or  RcrtSI_Race_v1r0=768826601 then RcrtAll_Race_v1r0=768826601;
IF RcrtSI_SHRaceEth_v1r0 = 178420302 or RcrtSI_Race_v1r0=178420302 or RcrtSI_HFHSRace_v1r0 =178420302 then RcrtAll_Race_v1r0=178420302;
IF RcrtSI_SHRaceEth_v1r0 = 181769837 or RcrtSI_Race_v1r0= 181769837 or RcrtSI_HFHSRace_v1r0 in (401335456,232334767) then RcrtAll_Race_v1r0=181769837;
attrib RcrtAll_Race_v1r0 label= "Race reported" format = SiteRaceEthnFmtJW.;
***for the overall sex:RcrtSI_sex_v1r0 RcrtSI_SH_HFHS_Sex_v1r0
***VALUE SiteSexFmtJW
			"536341288" = "Female"
			"654207589" = "Male"
			"830573274" = "Intersex or other"
			"178420302" = "Unavailable/Unknown"; 

***VALUE SHandHFHSSexFmtJW
			"536341288" = "Female"
			"654207589" = "Male"
			"178420302" = "Unavailable/Unknown"; 

IF RcrtSI_sex_v1r0 = 536341288 or RcrtSI_SH_HFHS_Sex_v1r0=536341288 then RcrtAll_sex_v1r0 = 536341288;
IF RcrtSI_sex_v1r0 = 654207589 or RcrtSI_SH_HFHS_Sex_v1r0=654207589 then RcrtAll_sex_v1r0 = 654207589;
IF RcrtSI_sex_v1r0 = 178420302 or RcrtSI_SH_HFHS_Sex_v1r0=178420302 then RcrtAll_sex_v1r0 = 178420302;
IF RcrtSI_sex_v1r0 = 830573274 then RcrtAll_sex_v1r0 =830573274;
attrib RcrtAll_sex_v1r0 label = "Sex Reported" format = SiteSexFmtJW.;
****to verify the pariticpants without SSN release;
*914639140	Autogenerated flag indicating whether partial Social Security Number was given (i.e.  Whether SrvSS_SSN4d_v1r0 was populated)	
	Partial Social Security Number Given	SrvSS_SSN4d_Given_v1r0		104430631	0 = No
																		353358909	1 = Yes
*311580100	Autogenerated flag indicating whether full Social Security Number was given (i.e.  Whether SrvSS_SSN_v1r0 was populated)
	Full Social Security Number Given	SrvSS_SSN_Given_v1r0		104430631
																	353358909
*********;
IF SrvSS_SSN4d_Given_v1r0 NE 353358909 AND SrvSS_SSN_Given_v1r0 NE 353358909 THEN SSNPieChart = 1; 
ELSE IF SrvSS_SSN4d_Given_v1r0 = 353358909 THEN SSNPieChart = 2; 
ELSE IF SrvSS_SSN_Given_v1r0 = 353358909 THEN SSNPieChart = 3; 
ELSE SSNPieChart = .;
IF SrvSS_SSN4d_Given_v1r0 = 353358909 or SrvSS_SSN_Given_v1r0 = 353358909 THEN SrvSS_anySSN_Given_v1r0 = 353358909; 
IF SrvSS_SSN4d_Given_v1r0 = 104430631 AND SrvSS_SSN_Given_v1r0 = 104430631 THEN SrvSS_anySSN_Given_v1r0 = 104430631; 

*Completion of Initial Survey;
*949302066	Baseline Survey Status - Module Background and Overall Health	Flag for Baseline Module Background and Overall Health
SrvBOH_BaseStatus_v1r0
							972455046	0=Not Started
							615768760	1 = Started
							231311385	2=Submitted
*536735468	Baseline Survey Status- Module Medications, Reproductive Health, Exercise, and Sleep	Flag for Baseline Module Medications, Reproductive Health, Exercise and Sleep
SrvMRE_BaseStatus_v1r0
							972455046	0=Not Started
							615768760	1=Started
							231311385	2=Submitted
*663265240	Baseline Survey Status- Module Where You Live and Work	Flag for Baseline Module Where You Live and Work
SrvLAW_BaseStatus_v1r0		972455046	0=Not Started
							615768760	1=Started
							231311385	2=Submitted
**********;
IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 1;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 2;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND 
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 NE 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 NE 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 NE 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 NE 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 3;

ELSE IF SrvBOH_BaseStatus_v1r0 = 231311385 AND SrvMRE_BaseStatus_v1r0 = 231311385 AND
SrvSAS_BaseStatus_v1r0 = 231311385 AND SrvLAW_BaseStatus_v1r0 = 231311385 THEN ComplIntlSrv = 4;

attrib Rcrt_completion_v1r0 LABEL  = "Verification Complete" format=verifcomplfmtJW. ;
attrib 	recrt_steps_v1r0 label="Work Flow" format=WorkFlowFmtJW. ;
attrib RcrtSI_SHRaceEth_v1r0 label="Sanford Health Reported Race" format = SiteRaceEthnFmtJW.;
attrib ComplIntlSrv  label = "Completion of Initial Survey" FORMAT = ComplIntlSrvFmtJW.;
attrib SSNPieChart LABEL = "Completion of SSN Among Verified Participants" format = SSNPieChartFmtJW.;
attrib SrvSS_anySSN_Given_v1r0 LABEL ="No SSN Given" format = NoSSNGivenFmtJW.;
attrib Rcrt_Verified_v1r0 label="Verified" format=verifiedFmtJW. ;
run;

data recr_process_long;set recruit_proces;
array procs {5} RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0  Rcrt_completion_v1r0 Rcrt_Verified_v1r0;
do stage =1 to 5;
recr_Process_v1r0=procs{stage};
output;
end;
keep connect_id studyid pin token stage RcrtSI_RecruitType_v1r0 RcrtES_Site_v1r0 RcrtSI_SignedIn_v1r0 RcrtCS_Consented_v1r0 RcrtUP_Submitted_v1r0 
Rcrt_completion_v1r0 RcrtV_Verification_v1r0 recr_Process_v1r0 recrt_steps_v1r0;
format recr_Process_v1r0 verifcomplfmtJW. stage WorkFlowFmtJW.;
run;

proc freq data=recr_process_long;
table RcrtES_Site_v1r0*stage*recr_Process_v1r0/list missing noprint out=recru_count; run;
data recru_count1; set recru_count; if stage>1 and recr_Process_v1r0 = 104430631 then delete; 
if stage=1 and recr_Process_v1r0 = 104430631 then stage = 0; 
format stage WorkFlowFmtJW.; 
label stage= "workflow";run;

proc template;
   source styles.statistical / file='C:\Users\natarajanm2\Desktop\style.tmp';
run;

data colors;
   length element Color $ 20;
   infile 'C:\Users\natarajanm2\Desktop\style.tmp';
   input;
   if index(_infile_, 'data') then do;
      element = scan(_infile_, 1, ' ');
      Color = scan(_infile_, 3, ' ;');
      Type = ifc(index(element, 'gc'), 'Line', 'Fill') || ' Colors';
      i = input(compress(element, 'gcdat'';'), ?? 2.);
      if i then output;
   end;
run;

proc sort data=colors; by i type; run;

proc transpose data=colors out=color1 ;
by i;
id type;
var color;
run;
proc contents data=color1; run;
%let VarName = RcrtES_Site_v1r0; /* specify name of grouping variable */

data Attrs;
length Value $32 MarkerColor $20;
ID = "&varname";
Value = putn( 531629870,"SiteFmt."); linecolor = "CXF0F8FF"; Fillcolor = "CXF0F8FF"; output;
Value = putn( 548392715,"SiteFmt."); linecolor = "CXFFE4C4"; Fillcolor = "CXFFE4C4"; output;
Value = putn( 125001209,"SiteFmt."); linecolor = "CX7FFDD4"; Fillcolor = "CX7FFDD4"; output;
Value = putn( 327912200,"SiteFmt."); linecolor = "CXDA70D6"; Fillcolor = "CXDA70D6"; output;
Value = putn( 300267574,"SiteFmt."); linecolor = "CX00FFFF"; Fillcolor = "CX00FFFF"; output;
Value = putn( 452412599,"SiteFmt."); linecolor = "CXE9967A"; Fillcolor = "CXE9967A"; output;
Value = putn( 303349821,"SiteFmt."); linecolor = "CX6495ED"; Fillcolor = "CX6495ED"; output;
Value = putn( 657167265,"SiteFmt."); linecolor = "CXFFD700"; Fillcolor = "CXFFD700"; output;
/*Value = putc( "809703864","$SiteFmt."); linecolor = cxD17800; Fillcolor = cxCF974B; output;*/
run;
data DAttrs;
set Attrs(keep=Value);
set color1(keep= 'Line Colors'n );
rename fill_colors=FillColor;
rename line_colors=LineColor;
ID = "&VarName"; SHOW = "ATTRMAP";
format value $31./* or "ID_&VarName" */;
run;

/*proc print; run;*/

ods graphics ;
proc sgplot data=recru_count1 DATTRMAP=DAttrs;
title "Cumulative Status of Recruitment (Active and Passive)";
/*styleattrs datacolors=(lightblue red green orange blue purple brown pink yellow aquamarine chartreuse khaki teal rose);*/
vbar stage/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold) ; 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
where recr_Process_v1r0=353358909;
format stage WorkFlowFmtJW. RcrtES_Site_v1r0 SiteFmtJW. value $SiteFmt31.;
where RcrtES_Site_v1r0 NE . and stage>0;
run;
ods graphics ;
proc sgplot data=recru_count1 DATTRMAP=DAttrs;
title "Cumulative Status of Recruitment (Active and Passive)";
/*styleattrs datacolors=(lightblue red green orange blue purple brown pink yellow aquamarine chartreuse khaki teal rose);*/
vbar stage/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold) ; 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
where recr_Process_v1r0=353358909;
format stage WorkFlowFmtJW. RcrtES_Site_v1r0 SiteFmtJW. ;
where RcrtES_Site_v1r0 NE . and stage>0;
run;

proc freq data=recruit_proces; table rcrtSI_RecruitType_v1r0*RcrtV_Verification_v1r0/list missing; where RcrtUP_Submitted_v1r0=353358909;run;

proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*Rcrt_Verified_v1r0*RcrtV_Verification_v1r0/list missing TOTPCT OUTPCT noprint out=UP_type_verif;
where RcrtUP_Submitted_v1r0=353358909 ;
run;
 
****875007964	0 = Not yet verified
197316935	1 = Verified
219863910	2 = Cannot be verified
922622075	3 = Duplicate
160161595	4 = Outreach timed out
**************;
data up_type_verif; set up_type_verif; Participants =count;
label participants = "# Participants";
run;



***            486306141 = "Active"
****		    854703046 = "Passive" ;
proc sgplot data=UP_type_verif dattrmap=DAttrs;
title "Passive Recruits Verification Status among those with Profile Completed";
vbar RcrtV_Verification_v1r0/response=participants group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum  groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
xaxis display = all values=(160161595 197316935 219863910 875007964 922622075);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
where RcrtSI_RecruitType_v1r0=854703046;
informat RcrtES_Site_v1r0 SiteFmtJW. ;
run;

proc sgplot data=UP_type_verif DATTRMAP=DAttrs ;
title "Active Recruits Verification Status among those with Profile Completed";
vbar RcrtV_Verification_v1r0/response=participants group=RcrtES_Site_v1r0 ATTRID=ID stat=sum  groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
xaxis display = all values=(160161595 197316935 219863910 875007964 922622075);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
where RcrtSI_RecruitType_v1r0^=854703046;
run;


proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*Rcrt_Verified_v1r0/list missing TOTPCT OUTPCT noprint out=UP_type_verified;
where RcrtUP_Submitted_v1r0=353358909;
run;

**stack;
proc freq data=recruit_proces; tables RcrtES_Site_v1r0 *RcrtSI_Age_v1r0/list missing TOTPCT OUTPCT noprint out=Age_verified;
where Rcrt_Verified_v1r0=353358909;
run;
proc sgplot data=Age_verified DATTRMAP=DAttrs;
title "Age of Verified Participants";
vbar RcrtSI_Age_v1r0/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum  groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
xaxis display = all  values=("124276120" "450985724" "363147933" "636706443" "771230670");
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
run;

***for sex;

proc freq data=recruit_proces; tables RcrtES_Site_v1r0 *RcrtAll_Sex_v1r0/list missing TOTPCT OUTPCT noprint out=Sex_Site_verified;
where Rcrt_Verified_v1r0=353358909;
run;

proc sgplot data=Sex_site_verified DATTRMAP=DAttrs;
title "Sex of Verified Participants";
vbar RcrtAll_Sex_v1r0/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
run;


/*PROC SGRENDER DATA =recruit_proces
TEMPLATE = pie;
format RcrtES_Site_v1r0 SiteFmtJW. RcrtAll_Race_v1r0 SiteRaceEthnFmtJW.;
where Rcrt_Verified_v1r0=353358909;
RUN;
*/
***for race;
proc freq data=recruit_proces; tables RcrtES_Site_v1r0 *RcrtAll_Race_v1r0/list missing TOTPCT OUTPCT noprint out=Race_verified;
where Rcrt_Verified_v1r0=353358909;
run;
***stack plot;
proc sgplot data=Race_verified DATTRMAP=DAttrs;
title "Race/Ethnicity of Verified Participants";
vbar RcrtAll_Race_v1r0/response=count group=RcrtES_Site_v1r0  ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
run;


***stack for complete survey, and SSN;
proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*ComplIntlSrv/list missing TOTPCT OUTPCT noprint out=IntlSrv_type_verified;
where Rcrt_Verified_v1r0=353358909;
run;

proc sgplot data=IntlSrv_type_verified DATTRMAP=DAttrs;
title "Completion of Initial Survey among Verified Participants";
vbar ComplIntlSrv/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum  groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
run;

/*proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*SrvSS_anySSN_Given_v1r0/list missing TOTPCT OUTPCT noprint out=SrvSSN_type_verified;
where Rcrt_Verified_v1r0=353358909;
run;

proc sgplot data=SrvSSN_type_verified DATTRMAP=DAttrs;
title "Completion SSN among Verified Participants";
vbar SrvSS_anySSN_Given_v1r0/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum  groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold); 
*xaxis display = (nolabel);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmtJW.;*/
/*run;*/

proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*SrvSS_anySSN_Given_v1r0/list missing TOTPCT OUTPCT noprint out=SrvSSN_type_verified;
where Rcrt_Verified_v1r0=353358909;
run;



/*proc sgplot data=SrvSSN_type_verified DATTRMAP=DAttrs;
title "Completion SSN among Verified Participants as of 05172022";
vbar SrvSS_anySSN_Given_v1r0/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold);
*xaxis display = (nolabel);
yaxis grid label="# Participants";
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmt.;
run;*/

/*proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*SSNPieChart/list missing TOTPCT OUTPCT noprint out=SrvSSN_type3_verified;
where Rcrt_Verified_v1r0=353358909;
/*format SSNPieChart SSNPieChartFmt.;*/
*run;
/*proc sgplot data=SrvSSN_type3_verified DATTRMAP=DAttrs;
title "Completion of SSN among Verified Participants as of 05172022";
vbar SSNPieChart/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold);
*xaxis display = (nolabel);
yaxis grid label="# Participants";*/
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmt.;
run;*/
proc freq data=recruit_proces; tables RcrtES_Site_v1r0 * RcrtSI_RecruitType_v1r0*SSNPieChart/list missing TOTPCT OUTPCT noprint out=SrvSSN_type3_verified;
where Rcrt_Verified_v1r0=353358909;
/*format SSNPieChart SSNPieChartFmt.;*/
run;
proc sgplot data=SrvSSN_type3_verified DATTRMAP=DAttrs;
title "Completion of SSN among Verified Participants as of 05172022";
vbar SSNPieChart/response=count group=RcrtES_Site_v1r0 ATTRID=RcrtES_Site_v1r0 stat=sum groupdisplay=stack seglabel
datalabel datalabelattrs=(weight=bold);
*xaxis display = (nolabel);
yaxis grid label="# Participants";*/
/*where recr_Process_v1r0=353358909 or stage=0;
format stage WorkFlowFmt.;
run;

ods graphics off;
ods pdf close;

/*CODE FOR INCENTIVE TABLES FOR WEEKLY REPORT- MN*/
*Time from Incentive Eligible to Incentive Issued for Chicago;
DATA IncentivesChicago;
SET Work.Concept_Ids;
IncentiveTimeChi = BL_HDPaym_TmPaym_v1r0 - BL_SMPaym_TmPaymElig_v1r0;
RUN;

*Format for days, hours, minutes, and seconds;
proc format;
picture mytimemin (default=50)
other='%n days and %H hours and %M minutes and %S seconds' (datatype=time);
run;

PROC TABULATE DATA=IncentivesChicago out=IncentTimeChi;
VAR IncentiveTimeChi;
LABEL IncentiveTimeChi = "Time from incentive eligible to incentive issued for Chicago";
TABLE IncentiveTimeChi*(Min Q1 Median Mean Q3 Max);
FORMAT IncentiveTimeChi mytimemin.;
WHERE RcrtES_Site_v1r0 = 809703864 AND RcrtV_Verification_v1r0 = 197316935;
RUN;

/*PROC PRINT DATA=IncentivesChicago;
VAR IncentiveTimeChi;
FORMAT IncentiveTimeChi mytime.;
RUN;*/

*Time from Incentive Eligible to Incentive Issued for All Other Sites;
DATA IncentivesAllOthSites;
SET Work.Concept_Ids;
IncentiveTimeAll = BL_HDPaym_TmPaym_v1r0 - BL_SMPaym_TmPaymElig_v1r0;
RUN;

*Format for days, hours, minutes, and seconds;
proc format;
picture mytimemin (default=50)
other='%n days and %H hours and %M minutes and %S seconds' (datatype=time);
run;

PROC TABULATE DATA=IncentivesAllOthSites out=IncentTimeAllOth;
VAR IncentiveTimeAll;
LABEL IncentiveTimeAll = "Time from incentive eligible to incentive issued for NORC-issued incentives";
TABLE IncentiveTimeAll*(Min Q1 Median Mean Q3 Max);
FORMAT IncentiveTimeAll mytimemin.;
WHERE RcrtES_Site_v1r0 NE 809703864 AND RcrtV_Verification_v1r0 = 197316935;
RUN;

/*PROC PRINT DATA=IncentivesAllOthSites;
VAR IncentiveTimeAll;
FORMAT IncentiveTimeAll mytime.;
RUN;*/
